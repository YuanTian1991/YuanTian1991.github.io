<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.7 'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}ul{margin-left:1.7rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.7rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;font-size:0.85rem;line-height:1.7rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;font-size:1rem;line-height:1.7rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}blockquote{margin-left:1.7rem;margin-right:1.7rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.7rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.7rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.7rem;margin-bottom:calc(1.7rem / 2);margin-top:calc(1.7rem / 2);}li > ul{margin-left:1.7rem;margin-bottom:calc(1.7rem / 2);margin-top:calc(1.7rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.7rem / 2);}code{font-size:0.85rem;line-height:1.7rem;}kbd{font-size:0.85rem;line-height:1.7rem;}samp{font-size:0.85rem;line-height:1.7rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.13333rem;padding-right:1.13333rem;padding-top:0.85rem;padding-bottom:calc(0.85rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}</style><style data-href="/styles.0921856cc7a8e6f9c088.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}html{background-color:#fff}::selection{background:rgba(254,217,10,.7)}pre[class*=language-]{font-size:.8em;margin:2em 0;background-color:#1f2937;border-radius:3px}code[class*=language-],pre[class*=language-]{color:#f5f5f5;text-shadow:none;font-family:Menlo,Monaco,Andale Mono,Ubuntu Mono,SFMono-Regular,monospace}:not(pre)>code[class*=language-]{border-radius:.3em;font-size:.8em;padding:3px 5px;color:#212121;white-space:normal;font-weight:700;font-family:Menlo,Monaco,Andale Mono,Ubuntu Mono,SFMono-Regular,monospace}.token.number{color:#81c2ff}.token.keyword{color:#7ec9a1}.token.punctuation{color:#fff}.token.string{color:#7ec9a1}.token.boolean{color:#e07a5f}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#f4e781;background:hsla(0,0%,100%,0)}blockquote{margin-top:5px;padding:20px;background-color:#eee;border-radius:3px}a{text-decoration:none;color:#81c2ff;font-weight:700}</style><meta name="generator" content="Gatsby 2.23.10"/><style id="jss-server-side">.jss12{margin-top:8px;margin-bottom:8px}.MuiTypography-root{margin:0}.MuiTypography-body2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.43;letter-spacing:.01071em}.MuiTypography-body1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.5;letter-spacing:.00938em}.MuiTypography-caption{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.66;letter-spacing:.03333em}.MuiTypography-button{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;letter-spacing:.02857em;text-transform:uppercase}.MuiTypography-h1{font-size:6rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.167;letter-spacing:-.01562em}.MuiTypography-h2{font-size:3.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.2;letter-spacing:-.00833em}.MuiTypography-h3{font-size:3rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.167;letter-spacing:0}.MuiTypography-h4{font-size:2.125rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.235;letter-spacing:.00735em}.MuiTypography-h5{font-size:1.5rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.334;letter-spacing:0}.MuiTypography-h6{font-size:1.25rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.6;letter-spacing:.0075em}.MuiTypography-subtitle1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.75;letter-spacing:.00938em}.MuiTypography-subtitle2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.57;letter-spacing:.00714em}.MuiTypography-overline{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:2.66;letter-spacing:.08333em;text-transform:uppercase}.MuiTypography-srOnly{width:1px;height:1px;overflow:hidden;position:absolute}.MuiTypography-alignLeft{text-align:left}.MuiTypography-alignCenter{text-align:center}.MuiTypography-alignRight{text-align:right}.MuiTypography-alignJustify{text-align:justify}.MuiTypography-noWrap{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.MuiTypography-gutterBottom{margin-bottom:.35em}.MuiTypography-paragraph{margin-bottom:16px}.MuiTypography-colorInherit{color:inherit}.MuiTypography-colorPrimary{color:#3f51b5}.MuiTypography-colorSecondary{color:#f50057}.MuiTypography-colorTextPrimary{color:rgba(0,0,0,.87)}.MuiTypography-colorTextSecondary{color:rgba(0,0,0,.54)}.MuiTypography-colorError{color:#f44336}.MuiTypography-displayInline{display:inline}.MuiTypography-displayBlock{display:block}.MuiChip-root{color:rgba(0,0,0,.87);border:none;cursor:default;height:32px;display:inline-flex;outline:0;padding:0;font-size:.8125rem;box-sizing:border-box;transition:background-color .3s cubic-bezier(.4,0,.2,1) 0s,box-shadow .3s cubic-bezier(.4,0,.2,1) 0s;align-items:center;font-family:Roboto,Helvetica,Arial,sans-serif;white-space:nowrap;border-radius:16px;vertical-align:middle;justify-content:center;text-decoration:none;background-color:#e0e0e0}.MuiChip-root.Mui-disabled{opacity:.5;pointer-events:none}.MuiChip-root .MuiChip-avatar{color:#616161;width:24px;height:24px;font-size:.75rem;margin-left:5px;margin-right:-6px}.MuiChip-root .MuiChip-avatarColorPrimary{color:#fff;background-color:#303f9f}.MuiChip-root .MuiChip-avatarColorSecondary{color:#fff;background-color:#c51162}.MuiChip-root .MuiChip-avatarSmall{width:18px;height:18px;font-size:.625rem;margin-left:4px;margin-right:-4px}.MuiChip-sizeSmall{height:24px}.MuiChip-colorPrimary{color:#fff;background-color:#3f51b5}.MuiChip-colorSecondary{color:#fff;background-color:#f50057}.MuiChip-clickable{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.MuiChip-clickable:focus,.MuiChip-clickable:hover{background-color:#cecece}.MuiChip-clickable:active{box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12)}.MuiChip-clickableColorPrimary:focus,.MuiChip-clickableColorPrimary:hover{background-color:#4e5eba}.MuiChip-clickableColorSecondary:focus,.MuiChip-clickableColorSecondary:hover{background-color:#f51464}.MuiChip-deletable:focus{background-color:#cecece}.MuiChip-deletableColorPrimary:focus{background-color:#6573c3}.MuiChip-deletableColorSecondary:focus{background-color:#f73378}.MuiChip-outlined{border:1px solid rgba(0,0,0,.23);background-color:transparent}.MuiChip-clickable.MuiChip-outlined:focus,.MuiChip-clickable.MuiChip-outlined:hover,.MuiChip-deletable.MuiChip-outlined:focus{background-color:rgba(0,0,0,.04)}.MuiChip-outlined .MuiChip-avatar{margin-left:4px}.MuiChip-outlined .MuiChip-avatarSmall{margin-left:2px}.MuiChip-outlined .MuiChip-icon{margin-left:4px}.MuiChip-outlined .MuiChip-iconSmall{margin-left:2px}.MuiChip-outlined .MuiChip-deleteIcon{margin-right:5px}.MuiChip-outlined .MuiChip-deleteIconSmall{margin-right:3px}.MuiChip-outlinedPrimary{color:#3f51b5;border:1px solid #3f51b5}.MuiChip-clickable.MuiChip-outlinedPrimary:focus,.MuiChip-clickable.MuiChip-outlinedPrimary:hover,.MuiChip-deletable.MuiChip-outlinedPrimary:focus{background-color:rgba(63,81,181,.04)}.MuiChip-outlinedSecondary{color:#f50057;border:1px solid #f50057}.MuiChip-clickable.MuiChip-outlinedSecondary:focus,.MuiChip-clickable.MuiChip-outlinedSecondary:hover,.MuiChip-deletable.MuiChip-outlinedSecondary:focus{background-color:rgba(245,0,87,.04)}.MuiChip-icon{color:#616161;margin-left:5px;margin-right:-6px}.MuiChip-iconSmall{width:18px;height:18px;margin-left:4px;margin-right:-4px}.MuiChip-iconColorPrimary{color:inherit}.MuiChip-iconColorSecondary{color:inherit}.MuiChip-label{overflow:hidden;white-space:nowrap;padding-left:12px;padding-right:12px;text-overflow:ellipsis}.MuiChip-labelSmall{padding-left:8px;padding-right:8px}.MuiChip-deleteIcon{color:rgba(0,0,0,.26);width:22px;cursor:pointer;height:22px;margin:0 5px 0 -6px;-webkit-tap-highlight-color:transparent}.MuiChip-deleteIcon:hover{color:rgba(0,0,0,.4)}.MuiChip-deleteIconSmall{width:16px;height:16px;margin-left:-4px;margin-right:4px}.MuiChip-deleteIconColorPrimary{color:rgba(255,255,255,.7)}.MuiChip-deleteIconColorPrimary:active,.MuiChip-deleteIconColorPrimary:hover{color:#fff}.MuiChip-deleteIconColorSecondary{color:rgba(255,255,255,.7)}.MuiChip-deleteIconColorSecondary:active,.MuiChip-deleteIconColorSecondary:hover{color:#fff}.MuiChip-deleteIconOutlinedColorPrimary{color:rgba(63,81,181,.7)}.MuiChip-deleteIconOutlinedColorPrimary:active,.MuiChip-deleteIconOutlinedColorPrimary:hover{color:#3f51b5}.MuiChip-deleteIconOutlinedColorSecondary{color:rgba(245,0,87,.7)}.MuiChip-deleteIconOutlinedColorSecondary:active,.MuiChip-deleteIconOutlinedColorSecondary:hover{color:#f50057}.MuiContainer-root{width:100%;display:block;box-sizing:border-box;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiContainer-root{padding-left:24px;padding-right:24px}}.MuiContainer-disableGutters{padding-left:0;padding-right:0}@media (min-width:600px){.MuiContainer-fixed{max-width:600px}}@media (min-width:960px){.MuiContainer-fixed{max-width:960px}}@media (min-width:1280px){.MuiContainer-fixed{max-width:1280px}}@media (min-width:1920px){.MuiContainer-fixed{max-width:1920px}}@media (min-width:0px){.MuiContainer-maxWidthXs{max-width:444px}}@media (min-width:600px){.MuiContainer-maxWidthSm{max-width:600px}}@media (min-width:960px){.MuiContainer-maxWidthMd{max-width:960px}}@media (min-width:1280px){.MuiContainer-maxWidthLg{max-width:1280px}}@media (min-width:1920px){.MuiContainer-maxWidthXl{max-width:1920px}}.MuiGrid-container{width:100%;display:flex;flex-wrap:wrap;box-sizing:border-box}.MuiGrid-item{margin:0;box-sizing:border-box}.MuiGrid-zeroMinWidth{min-width:0}.MuiGrid-direction-xs-column{flex-direction:column}.MuiGrid-direction-xs-column-reverse{flex-direction:column-reverse}.MuiGrid-direction-xs-row-reverse{flex-direction:row-reverse}.MuiGrid-wrap-xs-nowrap{flex-wrap:nowrap}.MuiGrid-wrap-xs-wrap-reverse{flex-wrap:wrap-reverse}.MuiGrid-align-items-xs-center{align-items:center}.MuiGrid-align-items-xs-flex-start{align-items:flex-start}.MuiGrid-align-items-xs-flex-end{align-items:flex-end}.MuiGrid-align-items-xs-baseline{align-items:baseline}.MuiGrid-align-content-xs-center{align-content:center}.MuiGrid-align-content-xs-flex-start{align-content:flex-start}.MuiGrid-align-content-xs-flex-end{align-content:flex-end}.MuiGrid-align-content-xs-space-between{align-content:space-between}.MuiGrid-align-content-xs-space-around{align-content:space-around}.MuiGrid-justify-xs-center{justify-content:center}.MuiGrid-justify-xs-flex-end{justify-content:flex-end}.MuiGrid-justify-xs-space-between{justify-content:space-between}.MuiGrid-justify-xs-space-around{justify-content:space-around}.MuiGrid-justify-xs-space-evenly{justify-content:space-evenly}.MuiGrid-spacing-xs-1{width:calc(100% + 8px);margin:-4px}.MuiGrid-spacing-xs-1>.MuiGrid-item{padding:4px}.MuiGrid-spacing-xs-2{width:calc(100% + 16px);margin:-8px}.MuiGrid-spacing-xs-2>.MuiGrid-item{padding:8px}.MuiGrid-spacing-xs-3{width:calc(100% + 24px);margin:-12px}.MuiGrid-spacing-xs-3>.MuiGrid-item{padding:12px}.MuiGrid-spacing-xs-4{width:calc(100% + 32px);margin:-16px}.MuiGrid-spacing-xs-4>.MuiGrid-item{padding:16px}.MuiGrid-spacing-xs-5{width:calc(100% + 40px);margin:-20px}.MuiGrid-spacing-xs-5>.MuiGrid-item{padding:20px}.MuiGrid-spacing-xs-6{width:calc(100% + 48px);margin:-24px}.MuiGrid-spacing-xs-6>.MuiGrid-item{padding:24px}.MuiGrid-spacing-xs-7{width:calc(100% + 56px);margin:-28px}.MuiGrid-spacing-xs-7>.MuiGrid-item{padding:28px}.MuiGrid-spacing-xs-8{width:calc(100% + 64px);margin:-32px}.MuiGrid-spacing-xs-8>.MuiGrid-item{padding:32px}.MuiGrid-spacing-xs-9{width:calc(100% + 72px);margin:-36px}.MuiGrid-spacing-xs-9>.MuiGrid-item{padding:36px}.MuiGrid-spacing-xs-10{width:calc(100% + 80px);margin:-40px}.MuiGrid-spacing-xs-10>.MuiGrid-item{padding:40px}.MuiGrid-grid-xs-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-xs-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-xs-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-xs-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-xs-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-xs-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-xs-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-xs-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-xs-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-xs-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-xs-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-xs-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-xs-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-xs-12{flex-grow:0;max-width:100%;flex-basis:100%}@media (min-width:600px){.MuiGrid-grid-sm-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-sm-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-sm-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-sm-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-sm-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-sm-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-sm-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-sm-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-sm-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-sm-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-sm-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-sm-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-sm-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-sm-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:960px){.MuiGrid-grid-md-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-md-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-md-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-md-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-md-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-md-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-md-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-md-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-md-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-md-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-md-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-md-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-md-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-md-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:1280px){.MuiGrid-grid-lg-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-lg-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-lg-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-lg-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-lg-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-lg-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-lg-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-lg-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-lg-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-lg-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-lg-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-lg-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-lg-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-lg-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:1920px){.MuiGrid-grid-xl-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-xl-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-xl-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-xl-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-xl-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-xl-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-xl-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-xl-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-xl-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-xl-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-xl-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-xl-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-xl-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-xl-12{flex-grow:0;max-width:100%;flex-basis:100%}}.MuiToolbar-root{display:flex;position:relative;align-items:center}.MuiToolbar-gutters{padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiToolbar-gutters{padding-left:24px;padding-right:24px}}.MuiToolbar-regular{min-height:56px}@media (min-width:0px) and (orientation:landscape){.MuiToolbar-regular{min-height:48px}}@media (min-width:600px){.MuiToolbar-regular{min-height:64px}}.MuiToolbar-dense{min-height:48px}.jss3{margin-left:auto}.jss4{color:#000;font-weight:700;text-decoration:none}.jss4:hover{color:#000;text-decoration:none}.jss5{color:#000;cursor:pointer;font-weight:900}.jss6{display:flex}.jss6>*{margin:8px}.jss7{cursor:pointer;padding-right:24px}.jss8{width:50px;height:50px;margin-top:1em;border-radius:25px}.jss9{width:60px;height:60px;border-radius:30px}.jss10{right:2em;width:5em;bottom:-2em;height:5em;padding:.2em;position:absolute}.jss11{height:0;display:flex;align-items:center;justify-content:center;background-color:rgba(245,245,245,0)}.jss1{color:#757575;font-size:1em;font-family:Menlo,Monaco,'Andale Mono','Ubuntu Mono',SFMono-Regular,monospace;font-weight:100;background-color:rgb(255,255,255,0)}</style><title data-react-helmet="true"></title><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/webpack-runtime-052813ee9429edf61d8e.js"/><link as="script" rel="preload" href="/framework-93d3a746c3cf42acdafc.js"/><link as="script" rel="preload" href="/styles-f7a64dad1c13bebc31fd.js"/><link as="script" rel="preload" href="/app-e05f21335a16b4e957d2.js"/><link as="script" rel="preload" href="/commons-ee0fabfaa2cc0e7ca8a7.js"/><link as="script" rel="preload" href="/a0a122dce25329eef6729a0f7c3ee55af4d9135e-a9f2e945a21dbbbbeae0.js"/><link as="script" rel="preload" href="/component---src-templates-note-template-js-fc45086a467872a9898c.js"/><link as="fetch" rel="preload" href="/page-data/notes/MAnorm2-package-for-hMeDIP-seq-2:-Normalisation-&amp;-Analysis/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="blog-post-container"><div class="MuiContainer-root MuiContainer-maxWidthLg"><div class="MuiBox-root jss12"><div class="MuiToolbar-root MuiToolbar-regular jss2 MuiToolbar-gutters"><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-1 MuiGrid-align-items-xs-center"><div class="MuiGrid-root MuiGrid-item">              <a class="jss4" href="/">Tian</a></div></div><div class="jss3"></div></div></div><div class="MuiContainer-root MuiContainer-maxWidthLg"><main><div class="MuiContainer-root MuiContainer-maxWidthMd"><span style="margin-top:1em;margin-bottom:0px">August 05, 2021</span><h1 style="font-size:2.5em;font-weight:700;margin-top:0.2em;margin-bottom:0.2em">MAnorm2 package for hMeDIP-seq 2: Normalisation &amp; Analysis</h1><div class="MuiChip-root MuiChip-outlined MuiChip-sizeSmall" style="margin:5px;margin-bottom:1em;font-size:14px;background-color:white"><span class="MuiChip-label MuiChip-labelSmall"><code class="jss1"> <!-- -->MAnorm2</code></span></div><div class="MuiChip-root MuiChip-outlined MuiChip-sizeSmall" style="margin:5px;margin-bottom:1em;font-size:14px;background-color:white"><span class="MuiChip-label MuiChip-labelSmall"><code class="jss1"> <!-- -->MeDIP-seq</code></span></div><div class="blog-post-content"><p>After <a href="https://yuantian1991.github.io/notes/MAnorm2-package-for-hMeDIP-seq-data">preparation work with MAnorm2_utils</a>, now I can load the data into MAnorm2 for analysis. The vignette I found is by open it locally on my computer as:</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">browseVignettes<span class="token punctuation">(</span><span class="token string">"MAnorm2"</span><span class="token punctuation">)</span></code></pre></div>
<h2>1. Normalisation</h2>
<p>To load the data into MAnorm2, I just need to read the prepared file (prepared<em>profile</em>bins.csv) into R. However, I don't know why the loading function is not working, thus I have to re-save it into csv, then use read.csv(). Not a big deal.</p>
<blockquote>
<p>Note that the author told me <strong>the xls file is actually a text document</strong>, that can be read by read.table() or read.csv() directly.</p>
</blockquote>
<p>The code for loading is this one</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">library<span class="token punctuation">(</span><span class="token string">"MAnorm2"</span>
<span class="token comment"># The excel file can't be read by readxl, so I re-saved it into csv.</span>
pb <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"./prepared_profile_bins.csv"</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">)</span></code></pre></div>
<h3>1.1 One-step normalisation</h3>
<p>So as far as I know, I can do <strong>one-step normalisation</strong>, or <strong>two-step normalisation</strong>. One-step normalisation means it will take one sample (or calcualte average across all samples) as "baseline", then remove the overall M-A trend associated with their common peak regions between each sample against the baseline. I personally think it's easy to implement, <strong>but did not consider group condition</strong>. But anyway, the code is below:</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token comment"># One-step normalisation</span>
one_step_norm <span class="token operator">&lt;-</span> normalize<span class="token punctuation">(</span>pb<span class="token punctuation">,</span> count <span class="token operator">=</span> grep<span class="token punctuation">(</span><span class="token string">'cnt'</span><span class="token punctuation">,</span>colnames<span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> occupancy <span class="token operator">=</span> grep<span class="token punctuation">(</span><span class="token string">'occupancy'</span><span class="token punctuation">,</span>colnames<span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> baseline<span class="token operator">=</span><span class="token string">"pseudo-reference"</span><span class="token punctuation">)</span>

<span class="token comment"># Seems only one-step normalisation can plot below</span>
plot<span class="token punctuation">(</span>attr<span class="token punctuation">(</span>one_step_norm<span class="token punctuation">,</span> <span class="token string">"MA.cor"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> symbreaks <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> margins <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cexRow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> cexCol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></code></pre></div>
<p>After normalisation, samples are comparable between each other. And the MA.cor plot (I don't know the more professional name...) blow indicates the effect of normalisation. According to the vigentte, the lighter color the better. <strong>This is not a correlation plot</strong>, just indicates the variance (difference) should be normalised between samples.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 746px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a9a9f702aa7278d072d6b49209215a65/62de4/figure1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 126.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAAsSAAALEgHS3X78AAAFpklEQVQ4y12VXWwc1RmGV+Ie7hCX3HDDBRUXEIoIgoum3FRCCJkCQgKiIvWGRiUFpRJF/ESKBWpKEhRIQpPYcZsSFOLQJKa2gp2QEDtuneC1vT/2/s54Z9e7Ozuzs7Pz//Q7a1ykjnQ0M+d8857v+973vJNCLt+PePDBPnfemfDoozFDQzG7d8ccOBAzPh6zsBDTdSTQ6RIv3CIeHyc+eJB4927ioSHibduI77mHOJUipQCDIOLJJ33uvReeeiph50545x04ehQmJiCdTuhYCYnVIUmnNyfVogpSwTt2wP33w113/QT4yCM+d98NTzwBL74Ie/bA4cNw4QL88ANYtgTalrwsbk6qRRWkgh9/nEE2d9zxI6Af8swzLg89FPL8cz67XvcZ3uczctJnaipkKR3QMUMi0ySQDMPJSYKREcLhYcJduwik7HD7dsL77hPAREpRm7sJVjei3Y8x/YS+zJn9ELPjIK90/ACr7+GHqp+uJGtLZSGuZdGTjcJeD9+2SSmwJJ8HtyVPArOyJE2TspakV8VVmYul3gbx4gJUJC6yN2NjibWaREEgm4SEUaQiJUNB5ovTXPxLlpFPLPwjx6XhRwjHTmOMTfHZpzETH92muneEawf+zdlDGn/7YI0TH7fJXlzD2mii6Tq6puM4DqmoVieqNznzNex/1yIZGSU5cJDk6DFan51h/94eV4/naJ84R2Eiw/kTLf55qs2RP9uUrmiYG3UymSy5XI5Op0PKsSKyix7ViiRcycGrL8PPH4bt2+BXO3BKDfzDn8MLQ/Dm6/hXZ/FPn8W8sQJXp6UbdfT1dYxaTYrtkYqzOYJsgf7tDMHYF3iLWczJm9TmKixN13n22YSjks3SpRLnTtn8/nchX57o8tYfQr6dgVrNYHl5mbzwUC6XpYfFNaKqjp8tElz4BtNWjENG+Ji4DA/8DPbtS5i7ETP8ETz2GLwten766YS/SuKtlomua9TrdUxhWwALRPk1vFyZ+Pr3QqKQ1DKI5DhmbvXlKCYc+zSksGDyj6/gF78UPf8Rfv08nDmLABmsrGQGGa5L6Sk6bey1BkbFp9d0KazGGFpAqZiglwPeeBNmRst0zl3m+3GDN16z2fdunz/t8bky3sFqC8vCsGEYP2Yo6imVoJALcNY7nD+fcO26gEh/FFGBMo/R0/DKS3DsEMF3NzD/NUtjVnpycRxjbY2cjLywrMpO4Tq0dJdqvk+30ubmzWRgBrOzsHhbxGqLzZTz6CcnmTzncOhDl12/6bJ/2CMz0xDZbEiptUGG3W5XToqk6TQc9FyXdtFEJEWlknBbDGE1H+MXNWlUDd2Aa3ObhOz8Lby3FxauezSMGiuZjGgxQ7PZFGHL2axW4dacT3beFv+Tkq/BpUtyCpcTPC/BrW5gN+SodRv8/VTEyfdLfP1lHyPdxG41KJUrA0IsOdepvpiCVgzIpz30dJvjxxOmp2FaemisOdhND+c/WVytiX/5KqUVl43DZyjMlAmnrmBqVfLSw9XVVZFQi1SnFUpDYxYXfG59Zw80NzqaMDYmWc8H1AsO5koNs2rTMyzm5xOqyxZLM3Wcr6awjHUqwrIu53mQIT1bslAM2yRz88zPJtJD0NbBq4vK9TLK/zvyGKUz4mPSzLQ0uNUUR1oUQvXNDEWH7XabVCge5jk9ei0LNytpN/vYXU+GLwIQjxP2PGm25/v4jQ3cekM2qtPvWANJqfmuYHTFaXx5TrXFIdThrmoa6wMJaEJSRWRQoyyprsvHmloX5mryXFb3RmOw1pD3OFYu+NOVUlRrAlYsFtEkuCKBJVG66omaU3c1p4YCLRQK/1tT2ovEWNWVKOeXkVKNVKA1sZ+G7KzAtwCVe6iPlCTUurqr9a04xarKcAtsAOh5Hv1+X/4PwaCpCkjNKfdV/ua67mComP8fKm7r+63xXxdb379WjeLzAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="MA_cor_heatmap"
        title="MA_cor_heatmap"
        src="/static/a9a9f702aa7278d072d6b49209215a65/62de4/figure1.png"
        srcset="/static/a9a9f702aa7278d072d6b49209215a65/63868/figure1.png 250w,
/static/a9a9f702aa7278d072d6b49209215a65/0b533/figure1.png 500w,
/static/a9a9f702aa7278d072d6b49209215a65/62de4/figure1.png 746w"
        sizes="(max-width: 746px) 100vw, 746px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Then I manually calcualted the correlation heatmap below. It looks reasonable to me, I already know that LT51 and LT49 are two contaiminated samples. Suprisingly, I found NC49, which was identified as a sample not clustering with most NC samples because of preprocessing batch and quality issue, are now clearly groups with NC groups, this is a shocking result to me, because both DiffBind and QSEA can't give me this. The first side is the raw count's clustering heatmap, honestly much worse than the second one.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/5beacf4e86ae8a7e04b202d5da8762d4/d6a46/figure2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 92.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAEYklEQVQ4y02UW29UVRiG+2v8C3rnDzDeEBO90GhMuEGvaIzGeKExFSEhgIYUjAUkIShCKiRFpRFa6IF2emLaaTuH7pl9nD37fJg95/L4zTQVV7L3OmStd33r/d73G3v58iXD1u0f0u0dkrU6pGlGFKVUKgrVqoqqatRqKs1mm06nR78/oNvpcnh4yH/tCIax4a8pB0Jjj9ir0EocAbPwXRm3PAHw6Q/axElAFFukiU2UBjiBN1obDHoM5IIh3mGzyVhXBvUHU9Qn3qMzM46+9At6uEOSLlL1ytjRNuuawuyeSsk5oOwoTK/ucOtZgfmKwYGuo9VqRFmbQW2HsUwQ4/ID3DPvYL37BqXJCQ5iBT9aYVU12W84KG6ZlaqO6m3jZwX+WMox+XCHubKN4fgEvidUCVDfZixt9Uirc7j3vkQ5eYL18XFqYRWvvc9qtcaW6WKnZfSoTpBt0hus8SS/wpVHRV7UPcyGjaIoQlNE1usyFgQRQaKxreYpByo7C3MUr1zENR8RxM9wnDl0v4ARFAmiRaIkx7qS426uTNExaHiW7BGu2xk1Rzh0vZjIyxE1l0myHO5AxV28inXpYzLzNm33Fp30IVkwTbt+g0PnZ4lohoKxRdrOYTsahmESxxFDwYwlcVMiUdizK2wIwXl1n6wzT5i7jDX1Fal+WyLcwPfmSYJZQucJNfM5hXpVKMhjNyoCaI0AR7JpSVbCuIjqF8lbIZsCmjgztPxfifNX0S99wr5SQus28Fov8PsVNuu7PJasHwRD+bi4jkszax4BDgXaiGxy6gFus4QaKDjxBu3oAWq0Q3F7g+rE5wQzZ0ienSO+eJK9uz8yW9IkuwsYVmUkfs/zjgAjuaXWsLi/VaXsGqI9ITrOk3m/4/or6J06/vTXHJx4nej6Kbwv3sadPC2JXKK19j2ht48fxGTHEUZRQiOosGNJhMkGTrJFEj2mZVwTXp7iNdeJ/5kgunEK67sPic6/j3PvLEa4TVebwjbzEqGObdfp9Xoi7GYLL6qy76ji53WSdp5W8yn9+k8EwXOCToH43Ee4n71FcvEDlDdfo/jNaSpZg1btGp67L88NRYeheLzPWL/bZdfQmPxzjTvzS9xfWWW5uMJe6RFF8wWLlTzr09fxfvuW+l9X2btyntKFs5ibD+noU7j2LrpuEYbB0ZObScK+aXJjfpc7y1VuLijMlxQ0b028q7J4YLJcU6RwzOKIHdVUqNFFOpfGCZ//gJ9U0TWTJImPAAcSpiWp/7sgNrN8dup1tFAjbq7gpQUU8WnkPyXbvEBbu06m3aRdmyLR72Fd/pTG+gJOGEkVil+Vr1DebzuOSKA+Ct20dMmci2HW8GVumKrssTENRXi1scwqYSo+VoqihkD83R/x9wowDMUJHoaIejjWNV0OhqPCOpwPe9f10TRDEhDIXC70fHSzTv//RfYYsCuJabXbUqlT2tInwmunc9x3RD7xaN33/dHa8b5UxoOBFFcx8fH3L14BWtm/fqoAAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="raw_count_heatmap"
        title="raw_count_heatmap"
        src="/static/5beacf4e86ae8a7e04b202d5da8762d4/00d43/figure2.png"
        srcset="/static/5beacf4e86ae8a7e04b202d5da8762d4/63868/figure2.png 250w,
/static/5beacf4e86ae8a7e04b202d5da8762d4/0b533/figure2.png 500w,
/static/5beacf4e86ae8a7e04b202d5da8762d4/00d43/figure2.png 1000w,
/static/5beacf4e86ae8a7e04b202d5da8762d4/d6a46/figure2.png 1008w"
        sizes="(max-width: 1000px) 100vw, 1000px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/15d79e4396551cdbb2899a58354cdd75/d6a46/figure3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 92.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAEdUlEQVQ4y2WUW08bVxSF+XlVX/sLqqrpSys1bdQmUS9qm0DaivRCIkUJCaBAmkIgEJKSOmDAFzAGDBgb2+PL2GPPeHwb323AwNdtB/rQjnRmnxkd7bP2XmuvvrOzM7rPaXfJtiObaq1OJBJFz2SIRxXURJxIOIKW0mg1G3SOjzjpdODslP8+fd1XU0tTSQYp5RSs9AFVK8vhUYVitUrCKGFaVertJqVKCaNgoRoF9HwBzSzSbB9xenpC5+SE41qNvu4d2Yk7GN+8Rzt5j5bvBkbKTfnwgLEVL1dGNnjijeNQVPZ0k+FVhR+mfMzuphhfj+Pei2LqabJFi2bER59cQCVtozB3FWPwEg3nt+SSS3Kzk1H7Gh/+7uCuPcSbgIJHNRhxKozKWo8buGRF0yYVq0SjeSj9MumrNTtUwrN0QjcoD1/CuPwulfgcZyzyZNnFx/fXeeSO4VQUdgXhjE+QeeLsZ0tspkvsRZOkU0mKhSL1o7YkrLextG2M4DOs6AzG3G0Sw/1YRSfzewFuze4ythZlVUgKZnMshzO8kHJXFR1bKMNBUscqFXtkpfINSVhtUGunKbcDwp5D2HaQ35klNzbAlMvHtWcBKTnKYkjDGcsKQhVHzGRFkWS5HKmsKWoQUisVUckZfceHRwRSCSbdbl5tuljwrLCixng1/xe272/i9q0QKewQ0kMsKQZTWypPN1Vmd1TpZYTtcArT0KmIInqyaVYtXmyofCDNvzTk4tOHG/w0t8f15wf43bNYDy5zFL1LUHXxyBlnyOZnYG6Xzx66eP9XO0tehXrFolavnyesVfDGszwQ5oYWQ4y6ozyUdW9ZIVPfor39I/mr7xBemWZ40+TauIcvHnv58vEGl0c8LDiDZHWNkmW9TdhqNlELed4cxFg6iOJSIixHVOxSSsQIEkysEl6cZPXmzyw53EwIohF7gCfOAIMv/XiDKRoCqil5egkr5TJaMY8naeBNZfHrBnsyCd2m28IGD1Zj3PdmWXStoQ0PsrMbYC6cwxZM0i+tWfPHyWgim1LpvOR6lXVp9u2FfSY8CWExiT2SYXo7wZ9bCX557e+VOS7INqWKv7/uZ3LWwbxSZGBmm+1ImmpZhN04R3hy2MImjN2Y9vWSPd2IsRDMCEKjJ+Dvprb4fNTDmH2fl2GRjWOfua/6mZ+3MSNIQ4nMv7J528N6jd2kyfPdZE/9fjGDRSm1O2bjazE+ue/k+h+bTDgPRCoJnvkNJl1+4vekpwurInYxDz1D9UI2nBzjiWZ57I6wpeVxyH4xlCaSN7nzep+PfrNz5dEag/N73BK5DExv8Xw/w4IvxvbQXfSdHQrCQ02c5l/7MgslVBnyhJYhYxaIp9LkSxYhmdOokOUPJUhmcigJjXS2gCq+qJcqaKpKu1jkWKyr0/XHi4TVSplSsUAqmaQszqGlUhIt6Y1GXSRhZvXeGaNbmkRdYlnmN6PrYshn/zfY7tjUG40e7FarJY5do91u99TfOo/d7/pFlLO9/3LuRNB1Xf9i/QPW7Damh5qDxwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="normed_count"
        title="normed_count"
        src="/static/15d79e4396551cdbb2899a58354cdd75/00d43/figure3.png"
        srcset="/static/15d79e4396551cdbb2899a58354cdd75/63868/figure3.png 250w,
/static/15d79e4396551cdbb2899a58354cdd75/0b533/figure3.png 500w,
/static/15d79e4396551cdbb2899a58354cdd75/00d43/figure3.png 1000w,
/static/15d79e4396551cdbb2899a58354cdd75/d6a46/figure3.png 1008w"
        sizes="(max-width: 1000px) 100vw, 1000px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Without digging into code, I can't clearly say that MAnorm2's normalisation is better than QSEA or DiffBind, but to me, it's indeed grouped samples in same pheno togather, with just one-step normalisation.</p>
<h2>1.2 Two-step normalisation</h2>
<p>As the vignette recommanded, I prefer to use two-step normalisation method. It will fistly do normalisation within-group, to remove variance for samples in samde phenotype. Then do between-group normalisation. Sounds like suitable for samples have high variance, like mine.</p>
<p>I wrote a look to solve it, so the <code class="language-text">norm</code> object will save each time's within-group normalisation results. Then the result will be organized into <code class="language-text">conds</code> with <code class="language-text">bioConds()</code> function.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token comment"># Firstly perform one-step normalisation for each group, in my case 4 pheno.</span>
conds <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> c<span class="token punctuation">(</span><span class="token string">"NC"</span><span class="token punctuation">,</span> <span class="token string">"TC"</span><span class="token punctuation">,</span> <span class="token string">"LT"</span><span class="token punctuation">,</span> <span class="token string">"NL"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    message<span class="token punctuation">(</span><span class="token string">"within-group normalization for "</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>

    countIndex <span class="token operator">&lt;-</span> intersect<span class="token punctuation">(</span>grep<span class="token punctuation">(</span><span class="token string">"cnt"</span><span class="token punctuation">,</span> colnames<span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> grep<span class="token punctuation">(</span>i<span class="token punctuation">,</span> colnames<span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    occupancyIndex <span class="token operator">&lt;-</span> intersect<span class="token punctuation">(</span>grep<span class="token punctuation">(</span><span class="token string">"occupancy"</span><span class="token punctuation">,</span> colnames<span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> grep<span class="token punctuation">(</span>i<span class="token punctuation">,</span> colnames<span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token string">"NC"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        norm <span class="token operator">&lt;-</span> normalize<span class="token punctuation">(</span>pb<span class="token punctuation">,</span> count <span class="token operator">=</span> countIndex<span class="token punctuation">,</span> occupancy <span class="token operator">=</span> occupancyIndex<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        norm <span class="token operator">&lt;-</span> normalize<span class="token punctuation">(</span>norm<span class="token punctuation">,</span> count <span class="token operator">=</span> countIndex<span class="token punctuation">,</span> occupancy <span class="token operator">=</span> occupancyIndex<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    conds<span class="token punctuation">[</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> bioCond<span class="token punctuation">(</span>norm<span class="token punctuation">[</span>countIndex<span class="token punctuation">]</span><span class="token punctuation">,</span> norm<span class="token punctuation">[</span>occupancyIndex<span class="token punctuation">]</span><span class="token punctuation">,</span> name <span class="token operator">=</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Note that a very useful feature is <code class="language-text">summary(conds[[x]])</code> could check the pheno's status. Like how much genomic intervals occupied by the condition, and stats like mean and median. So I quickly checked my 4 phenotypes:</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token operator">></span> summary<span class="token punctuation">(</span>conds<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"NC"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

Biological condition NC<span class="token operator">:</span>
<span class="token number">570869</span> genomic intervals with <span class="token number">8</span> profiles

Occupancy states<span class="token operator">:</span>
<span class="token number">343207</span> <span class="token punctuation">(</span><span class="token number">60.1</span>%<span class="token punctuation">)</span> of the genomic intervals occupied by the condition

Summary of mean signal intensities at the genomic intervals<span class="token operator">:</span>
   Min. <span class="token number">1</span>st Qu.  Median    Mean <span class="token number">3</span>rd Qu.    Max.
 <span class="token operator">-</span><span class="token number">1.353</span>   <span class="token number">1.373</span>   <span class="token number">2.304</span>   <span class="token number">2.403</span>   <span class="token number">3.353</span>   <span class="token number">8.751</span>

<span class="token ellipsis">...</span>

<span class="token operator">></span> summary<span class="token punctuation">(</span>conds<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"TC"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

Biological condition TC<span class="token operator">:</span>
<span class="token number">570869</span> genomic intervals with <span class="token number">7</span> profiles

Occupancy states<span class="token operator">:</span>
<span class="token number">147812</span> <span class="token punctuation">(</span><span class="token number">25.9</span>%<span class="token punctuation">)</span> of the genomic intervals occupied by the condition

Summary of mean signal intensities at the genomic intervals<span class="token operator">:</span>
   Min. <span class="token number">1</span>st Qu.  Median    Mean <span class="token number">3</span>rd Qu.    Max.
<span class="token operator">-</span><span class="token number">0.7186</span>  <span class="token number">0.4843</span>  <span class="token number">1.1652</span>  <span class="token number">1.3228</span>  <span class="token number">2.0252</span>  <span class="token number">6.7152</span>

Summary of standard deviations of signal intensities at the genomic intervals<span class="token operator">:</span>
   Min. <span class="token number">1</span>st Qu.  Median    Mean <span class="token number">3</span>rd Qu.    Max.
 <span class="token number">0.0723</span>  <span class="token number">0.8007</span>  <span class="token number">1.0446</span>  <span class="token number">1.0497</span>  <span class="token number">1.2819</span>  <span class="token number">3.2681</span>

<span class="token ellipsis">...</span>

<span class="token operator">></span> summary<span class="token punctuation">(</span>conds<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"LT"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

Biological condition LT<span class="token operator">:</span>
<span class="token number">570869</span> genomic intervals with <span class="token number">5</span> profiles

Occupancy states<span class="token operator">:</span>
<span class="token number">243718</span> <span class="token punctuation">(</span><span class="token number">42.7</span>%<span class="token punctuation">)</span> of the genomic intervals occupied by the condition

Summary of mean signal intensities at the genomic intervals<span class="token operator">:</span>
   Min. <span class="token number">1</span>st Qu.  Median    Mean <span class="token number">3</span>rd Qu.    Max.
<span class="token operator">-</span><span class="token number">0.9125</span>  <span class="token number">0.4808</span>  <span class="token number">1.1856</span>  <span class="token number">1.2917</span>  <span class="token number">2.0129</span>  <span class="token number">6.1973</span>

Summary of standard deviations of signal intensities at the genomic intervals<span class="token operator">:</span>
   Min. <span class="token number">1</span>st Qu.  Median    Mean <span class="token number">3</span>rd Qu.    Max.
<span class="token number">0.04139</span> <span class="token number">0.75732</span> <span class="token number">1.04839</span> <span class="token number">1.05869</span> <span class="token number">1.35746</span> <span class="token number">2.84766</span>

<span class="token ellipsis">...</span>

<span class="token operator">></span> summary<span class="token punctuation">(</span>conds<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"NL"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

Biological condition NL<span class="token operator">:</span>
<span class="token number">570869</span> genomic intervals with <span class="token number">3</span> profiles

Occupancy states<span class="token operator">:</span>
<span class="token number">212115</span> <span class="token punctuation">(</span><span class="token number">37.2</span>%<span class="token punctuation">)</span> of the genomic intervals occupied by the condition

Summary of mean signal intensities at the genomic intervals<span class="token operator">:</span>
   Min. <span class="token number">1</span>st Qu.  Median    Mean <span class="token number">3</span>rd Qu.    Max.
<span class="token operator">-</span><span class="token number">0.8845</span>  <span class="token number">0.5077</span>  <span class="token number">1.6349</span>  <span class="token number">1.6685</span>  <span class="token number">2.7150</span>  <span class="token number">6.6694</span>

Summary of standard deviations of signal intensities at the genomic intervals<span class="token operator">:</span>
     Min.   <span class="token number">1</span>st Qu.    Median      Mean   <span class="token number">3</span>rd Qu.      Max.
<span class="token number">0.0006521</span> <span class="token number">0.3655651</span> <span class="token number">0.6997107</span> <span class="token number">0.7495489</span> <span class="token number">1.0379378</span> <span class="token number">3.0839296</span></code></pre></div>
<p>Well, here I have a question for ChIP-seq, for example in my case, when "LT" has 42.7% occupancy, higher than TC (25.9%) or NL (37.2%), why it's mean value seems lower than the rest two?</p>
<p>Then perform two-step normalisation as:</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token comment"># Then perform two-step normalisation between groups.</span>
conds <span class="token operator">&lt;-</span> normBioCond<span class="token punctuation">(</span>conds<span class="token punctuation">,</span> baseline<span class="token operator">=</span><span class="token string">"pseudo-reference"</span><span class="token punctuation">)</span></code></pre></div>
<p>Note that I suggest to use <strong>baseline="pseudo-reference"</strong>, if you have more than five samples. Because based on my test, without setting this, the data distribution was changed hugely.</p>
<p>So I believe this the result of two-step norm. I checked bit, seem the normalised result is still stored in <code class="language-text">conds</code> object, instead of returned. So I fetched it myself out, so does the occupancy information for each pheno.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">myNorm <span class="token operator">&lt;-</span> do.call<span class="token punctuation">(</span><span class="token string">"cbind"</span><span class="token punctuation">,</span> lapply<span class="token punctuation">(</span>conds<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> x<span class="token operator">$</span>norm.signal<span class="token punctuation">)</span><span class="token punctuation">)</span>
myOccupancy <span class="token operator">&lt;-</span> do.call<span class="token punctuation">(</span><span class="token string">"cbind"</span><span class="token punctuation">,</span> lapply<span class="token punctuation">(</span>conds<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> x<span class="token operator">$</span>occupancy<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>Also I checked the correlation heatmap, it's nearly similar to the one-step norm. Until this step, I got the normalised matrix for visualisation.</p></div></div></main></div><div style="padding-top:3em;padding-bottom:3em;text-align:center"><p class="MuiTypography-root MuiTypography-body2 MuiTypography-colorTextSecondary MuiTypography-alignCenter">Copyright © <!-- -->Yuan Tian<!-- --> <!-- -->2021<!-- -->.</p></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/notes/MAnorm2-package-for-hMeDIP-seq-2:-Normalisation-&-Analysis";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e05f21335a16b4e957d2.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6d00771802fd2ca67982.js"],"component---src-pages-index-js":["/component---src-pages-index-js-b6385afbc1884c2e0493.js"],"component---src-pages-page-2-js":["/component---src-pages-page-2-js-39efed459ede9cf8fd24.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-e9054962b603b8d7736f.js"],"component---src-templates-note-template-js":["/component---src-templates-note-template-js-fc45086a467872a9898c.js"]};/*]]>*/</script><script src="/component---src-templates-note-template-js-fc45086a467872a9898c.js" async=""></script><script src="/a0a122dce25329eef6729a0f7c3ee55af4d9135e-a9f2e945a21dbbbbeae0.js" async=""></script><script src="/commons-ee0fabfaa2cc0e7ca8a7.js" async=""></script><script src="/app-e05f21335a16b4e957d2.js" async=""></script><script src="/styles-f7a64dad1c13bebc31fd.js" async=""></script><script src="/framework-93d3a746c3cf42acdafc.js" async=""></script><script src="/webpack-runtime-052813ee9429edf61d8e.js" async=""></script></body></html>