<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:1.625rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.40625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:hsla(0,0%,0%,0.53);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(0.8125rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:#4078c0;text-decoration:none;}a:hover,a:active{text-decoration:underline;}h1,h2,h3,h4,h5,h6{color:hsla(0,0%,0%,0.9);margin-top:0.8em;margin-bottom:0.8em;line-height:1.3;}</style><style data-href="/styles.9384302f9cb08db7102b.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}html{background-color:#fff;font-family:Helvetica}::selection{background:rgba(254,217,10,.7)}pre[class*=language-]{font-size:.9em;margin:.5em 0;background-color:#272c34;border-radius:3px}code[class*=language-],pre[class*=language-]{color:#eee;text-shadow:none;font-family:SFMono-Regular,Monaco,Andale Mono,Ubuntu Mono,monospace}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;color:red;white-space:normal}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,0)}</style><meta name="generator" content="Gatsby 2.23.10"/><style id="jss-server-side">.jss11{margin-top:8px;margin-bottom:8px}.MuiTypography-root{margin:0}.MuiTypography-body2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.43;letter-spacing:.01071em}.MuiTypography-body1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.5;letter-spacing:.00938em}.MuiTypography-caption{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.66;letter-spacing:.03333em}.MuiTypography-button{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;letter-spacing:.02857em;text-transform:uppercase}.MuiTypography-h1{font-size:6rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.167;letter-spacing:-.01562em}.MuiTypography-h2{font-size:3.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.2;letter-spacing:-.00833em}.MuiTypography-h3{font-size:3rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.167;letter-spacing:0}.MuiTypography-h4{font-size:2.125rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.235;letter-spacing:.00735em}.MuiTypography-h5{font-size:1.5rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.334;letter-spacing:0}.MuiTypography-h6{font-size:1.25rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.6;letter-spacing:.0075em}.MuiTypography-subtitle1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.75;letter-spacing:.00938em}.MuiTypography-subtitle2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.57;letter-spacing:.00714em}.MuiTypography-overline{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:2.66;letter-spacing:.08333em;text-transform:uppercase}.MuiTypography-srOnly{width:1px;height:1px;overflow:hidden;position:absolute}.MuiTypography-alignLeft{text-align:left}.MuiTypography-alignCenter{text-align:center}.MuiTypography-alignRight{text-align:right}.MuiTypography-alignJustify{text-align:justify}.MuiTypography-noWrap{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.MuiTypography-gutterBottom{margin-bottom:.35em}.MuiTypography-paragraph{margin-bottom:16px}.MuiTypography-colorInherit{color:inherit}.MuiTypography-colorPrimary{color:#3f51b5}.MuiTypography-colorSecondary{color:#f50057}.MuiTypography-colorTextPrimary{color:rgba(0,0,0,.87)}.MuiTypography-colorTextSecondary{color:rgba(0,0,0,.54)}.MuiTypography-colorError{color:#f44336}.MuiTypography-displayInline{display:inline}.MuiTypography-displayBlock{display:block}.MuiContainer-root{width:100%;display:block;box-sizing:border-box;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiContainer-root{padding-left:24px;padding-right:24px}}.MuiContainer-disableGutters{padding-left:0;padding-right:0}@media (min-width:600px){.MuiContainer-fixed{max-width:600px}}@media (min-width:960px){.MuiContainer-fixed{max-width:960px}}@media (min-width:1280px){.MuiContainer-fixed{max-width:1280px}}@media (min-width:1920px){.MuiContainer-fixed{max-width:1920px}}@media (min-width:0px){.MuiContainer-maxWidthXs{max-width:444px}}@media (min-width:600px){.MuiContainer-maxWidthSm{max-width:600px}}@media (min-width:960px){.MuiContainer-maxWidthMd{max-width:960px}}@media (min-width:1280px){.MuiContainer-maxWidthLg{max-width:1280px}}@media (min-width:1920px){.MuiContainer-maxWidthXl{max-width:1920px}}.MuiGrid-container{width:100%;display:flex;flex-wrap:wrap;box-sizing:border-box}.MuiGrid-item{margin:0;box-sizing:border-box}.MuiGrid-zeroMinWidth{min-width:0}.MuiGrid-direction-xs-column{flex-direction:column}.MuiGrid-direction-xs-column-reverse{flex-direction:column-reverse}.MuiGrid-direction-xs-row-reverse{flex-direction:row-reverse}.MuiGrid-wrap-xs-nowrap{flex-wrap:nowrap}.MuiGrid-wrap-xs-wrap-reverse{flex-wrap:wrap-reverse}.MuiGrid-align-items-xs-center{align-items:center}.MuiGrid-align-items-xs-flex-start{align-items:flex-start}.MuiGrid-align-items-xs-flex-end{align-items:flex-end}.MuiGrid-align-items-xs-baseline{align-items:baseline}.MuiGrid-align-content-xs-center{align-content:center}.MuiGrid-align-content-xs-flex-start{align-content:flex-start}.MuiGrid-align-content-xs-flex-end{align-content:flex-end}.MuiGrid-align-content-xs-space-between{align-content:space-between}.MuiGrid-align-content-xs-space-around{align-content:space-around}.MuiGrid-justify-xs-center{justify-content:center}.MuiGrid-justify-xs-flex-end{justify-content:flex-end}.MuiGrid-justify-xs-space-between{justify-content:space-between}.MuiGrid-justify-xs-space-around{justify-content:space-around}.MuiGrid-justify-xs-space-evenly{justify-content:space-evenly}.MuiGrid-spacing-xs-1{width:calc(100% + 8px);margin:-4px}.MuiGrid-spacing-xs-1>.MuiGrid-item{padding:4px}.MuiGrid-spacing-xs-2{width:calc(100% + 16px);margin:-8px}.MuiGrid-spacing-xs-2>.MuiGrid-item{padding:8px}.MuiGrid-spacing-xs-3{width:calc(100% + 24px);margin:-12px}.MuiGrid-spacing-xs-3>.MuiGrid-item{padding:12px}.MuiGrid-spacing-xs-4{width:calc(100% + 32px);margin:-16px}.MuiGrid-spacing-xs-4>.MuiGrid-item{padding:16px}.MuiGrid-spacing-xs-5{width:calc(100% + 40px);margin:-20px}.MuiGrid-spacing-xs-5>.MuiGrid-item{padding:20px}.MuiGrid-spacing-xs-6{width:calc(100% + 48px);margin:-24px}.MuiGrid-spacing-xs-6>.MuiGrid-item{padding:24px}.MuiGrid-spacing-xs-7{width:calc(100% + 56px);margin:-28px}.MuiGrid-spacing-xs-7>.MuiGrid-item{padding:28px}.MuiGrid-spacing-xs-8{width:calc(100% + 64px);margin:-32px}.MuiGrid-spacing-xs-8>.MuiGrid-item{padding:32px}.MuiGrid-spacing-xs-9{width:calc(100% + 72px);margin:-36px}.MuiGrid-spacing-xs-9>.MuiGrid-item{padding:36px}.MuiGrid-spacing-xs-10{width:calc(100% + 80px);margin:-40px}.MuiGrid-spacing-xs-10>.MuiGrid-item{padding:40px}.MuiGrid-grid-xs-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-xs-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-xs-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-xs-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-xs-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-xs-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-xs-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-xs-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-xs-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-xs-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-xs-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-xs-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-xs-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-xs-12{flex-grow:0;max-width:100%;flex-basis:100%}@media (min-width:600px){.MuiGrid-grid-sm-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-sm-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-sm-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-sm-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-sm-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-sm-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-sm-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-sm-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-sm-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-sm-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-sm-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-sm-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-sm-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-sm-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:960px){.MuiGrid-grid-md-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-md-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-md-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-md-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-md-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-md-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-md-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-md-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-md-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-md-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-md-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-md-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-md-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-md-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:1280px){.MuiGrid-grid-lg-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-lg-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-lg-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-lg-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-lg-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-lg-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-lg-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-lg-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-lg-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-lg-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-lg-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-lg-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-lg-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-lg-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:1920px){.MuiGrid-grid-xl-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-xl-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-xl-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-xl-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-xl-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-xl-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-xl-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-xl-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-xl-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-xl-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-xl-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-xl-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-xl-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-xl-12{flex-grow:0;max-width:100%;flex-basis:100%}}.MuiToolbar-root{display:flex;position:relative;align-items:center}.MuiToolbar-gutters{padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiToolbar-gutters{padding-left:24px;padding-right:24px}}.MuiToolbar-regular{min-height:56px}@media (min-width:0px) and (orientation:landscape){.MuiToolbar-regular{min-height:48px}}@media (min-width:600px){.MuiToolbar-regular{min-height:64px}}.MuiToolbar-dense{min-height:48px}.jss2{margin-left:auto}.jss3{color:#000;font-weight:700;text-decoration:none}.jss3:hover{color:#000;text-decoration:none}.jss4{color:#000;cursor:pointer;font-weight:900}.jss5{display:flex}.jss5>*{margin:8px}.jss6{cursor:pointer;padding-right:24px}.jss7{width:50px;height:50px;margin-top:1em;border-radius:25px}.jss8{width:60px;height:60px;border-radius:30px}.jss9{right:2em;width:5em;bottom:-2em;height:5em;padding:.2em;position:absolute}.jss10{height:0;display:flex;align-items:center;justify-content:center;background-color:rgba(245,245,245,0)}</style><title data-react-helmet="true"></title><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/webpack-runtime-7edddabe2b187af8db09.js"/><link as="script" rel="preload" href="/framework-8dcecaaefd71e2213eb2.js"/><link as="script" rel="preload" href="/styles-fa79fef4936efa84b233.js"/><link as="script" rel="preload" href="/app-88cc7d53bff4b644d77c.js"/><link as="script" rel="preload" href="/commons-04ea66d531f38b0803fa.js"/><link as="script" rel="preload" href="/component---src-templates-note-template-js-bb2de861ebb76f6672a7.js"/><link as="fetch" rel="preload" href="/page-data/notes/RRBS-Analysis-3:-Differential-Methylated-Probes/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="blog-post-container"><div class="MuiContainer-root MuiContainer-maxWidthLg"><div class="MuiBox-root jss11"><div class="MuiToolbar-root MuiToolbar-regular jss1 MuiToolbar-gutters"><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-1 MuiGrid-align-items-xs-center"><div class="MuiGrid-root MuiGrid-item">              <a class="jss3" href="/">Tian</a></div></div><div class="jss2"></div></div></div><div class="MuiContainer-root MuiContainer-maxWidthMd"><main><p style="margin-top:1em;margin-bottom:0px;font-weight:100">September 16, 2020</p><h1 style="font-size:2.5em;font-weight:700;margin-top:0.2em">RRBS Analysis 3: Differential Methylated Probes</h1><div class="blog-post-content"><p>Then here comes to an important point: Differential calling, it's a very common but vital step for nearly all EWAS (Epigenome-wide association study).</p>
<h2>1. Differential Methylated Probe Calling</h2>
<p>Initially I directly applied the methylKit for DMP calling.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">myDiff <span class="token operator">&lt;-</span> calculateDiffMeth<span class="token punctuation">(</span>meth<span class="token punctuation">,</span> overdispersion<span class="token operator">=</span><span class="token string">"MN"</span><span class="token punctuation">,</span> mc.cores<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span></code></pre></div>
<p><strong>A very serious problem is the P-value distribution is quite weird. It shows a clear Bimodal Pattern.</strong> This is a very good <a href="http://varianceexplained.org/statistics/interpreting-pvalue-histogram/">post</a> to explain this kind of situation. In another word, this situation happens because maybe there are some low-quality data, or sometimes there are no read counts enriched at all.</p>
<p>So I first try to use <code class="language-text">filterCoverage</code> function provided by methylKit to remove more low-quality probes.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 664px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/4ed8b67eb8ae1b6d20eb52027abc0663/31493/figure1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAByElEQVQ4y5WUWavCQAyF/f9/SHFHBF/EBfVJXEBR677vmssXSW1rXe5AmMx05sxJcprI/X4XBrMZ43w+y2w2k8ViIZvNRtbrtYzHY5lOp7JcLuVwOITei3gXdoCx3++l0WhIrVaTdrstnU5H6vW6GvuTycR33vyI9wUv21+GN5rL5fJkaIyazaYvjNvt9ta8BIhgMBg8AEGG/mq1kmq16gP8laEPkNdINEZ+GF4Gn9IQCmgf5/O5JjvsUlAJXxmyQCKlUknlgY80LNHBwnlz/AK43W6VHXpLp9OSTCYlkUhIKpWSfD4v/X7/ay6RlAvY7XbVgVEmk1EggA0cIxU8SuEQOaLe7XaqjBeGvV5PhsOhXggCmsXjcQXGz2azksvl3LlQKOg9x3EegNfrVcMNYxgEZ40BbjMWi8WegJYHwnnHMGzPjDtE4AJSScKG5TvAb+YDpPQkmpDJy3/BXhhayACSDz4im1+NO9FoVEaj0bM5UH70yL+MuCuVilq5XHb9sH3OMxeLRSXk64emLaoOuPk8hm9nSA/7+PxV+Mfj0dWkr32dTifX55D1Ol7nG2A8xqCY5luU2mDDum6wMSD8VqulaoDRp+bxB/kQyYOKTYWeAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Bimodal P value Distribution"
        title="Bimodal P value Distribution"
        src="/static/4ed8b67eb8ae1b6d20eb52027abc0663/31493/figure1.png"
        srcset="/static/4ed8b67eb8ae1b6d20eb52027abc0663/63868/figure1.png 250w,
/static/4ed8b67eb8ae1b6d20eb52027abc0663/0b533/figure1.png 500w,
/static/4ed8b67eb8ae1b6d20eb52027abc0663/31493/figure1.png 664w"
        sizes="(max-width: 664px) 100vw, 664px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h2>2. P value Fix 1: Increase Coverage Filtering Threshold</h2>
<p>Then I wrote a function to dynamically filter CpGs' coverage, from 10 to 55, as I expected, as the threshold goes up, the P-value distribution turns to normal: the Anti-conservative p-values shape we are expecting. </p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/2f13ceac835622432874f7319c005e88/764d0/figure2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 38.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABP0lEQVQoz02R2arCQBBE8/9fFMFoQMG4BKKiD764R0Ujbpi4xLqcvozYMPTUdPVW430+Hz2fT5VlaR5cFIUwhx+Ph3k4HPD7/TYOHh5vmLdarezhdrtpv99rOp1aMM9zZVlmmDtNrter5vO57ve7FSaH/N8BvEqlomq1qsFgYAV931cQBOp0OjqdTqrX64YbjYbO57OiKPri3W5nebVaTd1uV/1+X95ms9FyubTk1+tlJKZgOvDhcLD4dru19eAtFgulaWqbMDVxDjme0wFjDTf6L6aww2jp+E5X501DOjijw/F4/OLL5WJvztCSjVwyE4JdQyuIHugymUxMQ3C73dZoNLL10KrVailJEtOQe7PZVK/Xs+bD4VBhGCqOY43H4/9fRjOKsep6vdZsNjPNwHjiaARGU+LoyMROUzhw/wCnNldiu3LEYAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Filter Coverage P value plots"
        title="Filter Coverage P value plots"
        src="/static/2f13ceac835622432874f7319c005e88/00d43/figure2.png"
        srcset="/static/2f13ceac835622432874f7319c005e88/63868/figure2.png 250w,
/static/2f13ceac835622432874f7319c005e88/0b533/figure2.png 500w,
/static/2f13ceac835622432874f7319c005e88/00d43/figure2.png 1000w,
/static/2f13ceac835622432874f7319c005e88/aa440/figure2.png 1500w,
/static/2f13ceac835622432874f7319c005e88/764d0/figure2.png 1898w"
        sizes="(max-width: 1000px) 100vw, 1000px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>The second thing I want to make sure is: <strong>How many DMPs will be removed if I took a large coverage threshold like 55</strong>? This is an important question, because if after removing improper CpGs I can only receive a very small amount of DMPs, which would be hard for future research. So sad that the below plot shows that if I apply high coverage threshold, only very few DMP I will get... So I basically this solution is not working, at least not working in my scenario.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 661px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/23790cc37b93c29abc55591ac7dbfd90/0012b/figure3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 78.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAABoklEQVQ4y5WU6arCQAyF+/6v5A8VF9xXUFAKLlj3fddqLl9gytBWvA6EiWnm5MxJRuf9fkvYWLvdTqbTabCPRiNZLBbqb7dbWa/XslqtNNc+50homQ/z+Vw6nY6Mx2MZDAbS7/d17/V6MplMZDgciud5UUDf9+V4PMrz+ZRms6nVf1kGyCwFhA2giUQiqPp6vdQ4YHw7ZrOKMARwv99LMpmU2WwWSfplKSDiwhBAm2Fcs74Coh2dg2Emk5FarSblclkoZDP9NyAHl8tlAFgqlXSHYRzTuEZEAJkpAwi7fD4v3W5XRyPc0TgZIk1hYMOAWL1eVzlOp5OO1aexsc3hSofDQc0GZK9UKpJKpaRaraoxDZvNRu73e6DxRw15Yul0WjXMZrNSLBYDPfGJUahQKEgul5NWqyXtdltc19XJ4Dy3cKD5eDyUIQcbjYYyY+flAGrHkIE8Mw3EiVEEaRTwdrtpN5nFy+WiH/DP57P61+tVfYxcYibP+DBUDe37kwxtNMJnNxOAdrxz809jcijGDSmmGn4bXADQmG7TFIzfcfnE/gCkLMP5fd9axgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="DMP number"
        title="DMP number"
        src="/static/23790cc37b93c29abc55591ac7dbfd90/0012b/figure3.png"
        srcset="/static/23790cc37b93c29abc55591ac7dbfd90/63868/figure3.png 250w,
/static/23790cc37b93c29abc55591ac7dbfd90/0b533/figure3.png 500w,
/static/23790cc37b93c29abc55591ac7dbfd90/0012b/figure3.png 661w"
        sizes="(max-width: 661px) 100vw, 661px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>I personally think this solution should work in one of these 2 situations: (1). The high-bar close to 1 is not too high, thus you may adjust it down by increase the coverage threshold. (2). The data format is something like RNA-seq, which the coverage itself indeed represent the expression value, not like CpG, that matrix value is actually the divide between two coverage value because, in RNA-seq scenario, the null distribution hypothesis assumption should stands.</p>
<h2>3. P-value Fix 2: Remove all-zero or all-one CpG</h2>
<p>The second thought crosses my mind is to find these close-to-1 CpGs, see why they are acting so wired. Then maybe just removed them (after all they are contributed to our DMP right?) Below is my checking code, so across all 554917 CpGs (filtered based on 10 reads coverage), there are 24628 CpG's p-value is completely 1, and among them, nearly all are have totally <strong>0 OR 1</strong> methylation status across all samples.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token operator">></span> index <span class="token operator">&lt;-</span> which<span class="token punctuation">(</span>myDiff<span class="token operator">$</span>pvalue <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">></span> length<span class="token punctuation">(</span>index<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">24628</span>
<span class="token operator">></span> sum<span class="token punctuation">(</span>rowSums<span class="token punctuation">(</span>beta<span class="token punctuation">[</span>index<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">24351</span>
<span class="token operator">></span></code></pre></div>
<p><strong>According to the discussion in this <a href="https://support.bioconductor.org/p/116411/">post</a></strong>. I decided to remove all these probes. And more importantly, I decided to apply a smaller threshold, like 7, to gain more DMPs eventually. A tricky thing here is that <strong>there are 3 functions in methylKit are all using 10 as default coverage threshold,</strong> so if I want loose the threshold, I need to adjust all of them:</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token comment">## Firstly is the processBismarkAln function</span>
my.methRaw<span class="token operator">=</span>processBismarkAln<span class="token punctuation">(</span>location<span class="token operator">=</span>files<span class="token punctuation">,</span>
                             sample.id<span class="token operator">=</span>file.name<span class="token punctuation">,</span>
                             assembly<span class="token operator">=</span><span class="token string">"danRer11"</span><span class="token punctuation">,</span>
                             save.context<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span>
                             read.context<span class="token operator">=</span><span class="token string">"CpG"</span><span class="token punctuation">,</span>
                             mincov<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token comment"># Position 1</span>
                             minqual<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>
                             treatment<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                             save.folder<span class="token operator">=</span><span class="token string">"./"</span><span class="token punctuation">)</span>
<span class="token comment"># ...</span>
<span class="token comment">## sceond is the methRead function</span>
myobj <span class="token operator">&lt;-</span> methRead<span class="token punctuation">(</span>CpGFiles<span class="token punctuation">,</span>
                  sample.id<span class="token operator">=</span> as.list<span class="token punctuation">(</span>sampleName<span class="token punctuation">)</span><span class="token punctuation">,</span>
                  assembly<span class="token operator">=</span><span class="token string">"danRer11"</span><span class="token punctuation">,</span>
                  treatment<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  context<span class="token operator">=</span><span class="token string">"CpG"</span><span class="token punctuation">,</span>
                  mincov<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment"># Position 2</span>
<span class="token comment"># ...</span>
<span class="token comment"># Thirdly is the filterByCoverage function, as I tested before</span>
filtered.myobj <span class="token operator">&lt;-</span> filterByCoverage<span class="token punctuation">(</span>myobj<span class="token punctuation">,</span>lo.count<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span>lo.perc<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span> hi.count<span class="token operator">=</span><span class="token keyword">NULL</span><span class="token punctuation">,</span>hi.perc<span class="token operator">=</span><span class="token number">99.9</span><span class="token punctuation">)</span></code></pre></div>
<p>After the above work (basically redo the work in the <a href="https://yuantian1991.github.io/notes/RRBS-Analysis-2:-MethylKit">last step</a>), I eventually get 746647 CpGs left. Then below is the code for DMP calling, as I said I removed all totally 1 and totally 0 CpGs:</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">index <span class="token operator">&lt;-</span> which<span class="token punctuation">(</span><span class="token operator">!</span>rowSums<span class="token punctuation">(</span>beta<span class="token punctuation">)</span> <span class="token percent-operator operator">%in%</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>ncol<span class="token punctuation">(</span>beta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
meth.dmp <span class="token operator">&lt;-</span> meth<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
myDiff <span class="token operator">&lt;-</span> calculateDiffMeth<span class="token punctuation">(</span>meth.dmp<span class="token punctuation">,</span> overdispersion<span class="token operator">=</span><span class="token string">"MN"</span><span class="token punctuation">,</span> mc.cores<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span></code></pre></div>
<p><strong>Now, we get a very good p-value distribution and an even bigger number of CpG.</strong> The sacrifice here is a comparably low Coverage Threshold and roughly 30000+ CpGs who was supposed to be close to 1 and contribute to ebayes estimation adjustment.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f3b0343309ae92603f341a0f1334afba/a6d36/figure4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 101.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAABnUlEQVQ4y52Uh67CMAxF8///BmKULfYWYu/pp+OnRGloC+9FuqqB9OTGNjav10t8sezz8XjIarVSzWYzmU6nqsPhENvnLxN+4YMBAuh2u9LpdKTVakmj0ZDFYpEO9N1dLpcYOGul/W7u97sMBgO9Rq/Xe3OKns9nTGFqYkA2bLdbVb/fz9z8zTLkiYRvNhsHTCrStwcocLlcOodJBfqLay0KwN1up5W8Xq9CXm+3WyI4Swo8Ho/aGgArlYpEUSTValVj2mW/36dWORHINc/nswMWi0UplUqqQqGgB0wmE92Dc1vptEMMLcML5BAgoHK57GTBPGu1mjSbTVW73dYU2aafz+e/DsnV6XTSPgyBIRz3VhyCiHO5nEJdlWloHJK7EPJJpASw7RCtMu6SHH4rgPZfpg7H47EW5T8O34C+Q2vfz9UnYSCfz2tx3PiimQEynur1uo4olBX7n7kZt3QOAVJtmphG50kKwphDKZ69kR/boWtsh/MFL7EsiEUzMzhsvF6vXSMzyamBfR9TJpwkSTGQ4XAoo9HIHZo2iX4A1hLrQMtCmPYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Final P value Distribution"
        title="Final P value Distribution"
        src="/static/f3b0343309ae92603f341a0f1334afba/a6d36/figure4.png"
        srcset="/static/f3b0343309ae92603f341a0f1334afba/63868/figure4.png 250w,
/static/f3b0343309ae92603f341a0f1334afba/0b533/figure4.png 500w,
/static/f3b0343309ae92603f341a0f1334afba/a6d36/figure4.png 650w"
        sizes="(max-width: 650px) 100vw, 650px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Finally, I filtering the DMPs based on mean meth different at 15, and q value 0.05, eventually I get 3424 CpGs. These 3424 CpGs will be used across nearly the whole project.</p>
<h2>4. Annotated DMPs</h2>
<p>Following the DMP calling, one important step here is to get annotation on this CpGs, like their related genes (if there are any), are they located in the promoter. Here I just want to quickly use <code class="language-text">genomation</code> package to load the .gtf file for annotation. </p>
<p>I eventually choose this package because it has a function to quickly load <strong><a href="ftp://ftp.ensembl.org/pub/release-98/gtf">gtf file downloaded from Ensemble</a></strong>. This is important because I previously used the Ensemble genome (fasta format) for preprocessing mapping (with Bismark), so I decided to download the same Ensemble annotation across the whole project.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">message<span class="token punctuation">(</span><span class="token string">"Annotate DMPs"</span><span class="token punctuation">)</span>
library<span class="token punctuation">(</span><span class="token string">"GenomicRanges"</span><span class="token punctuation">)</span>
library<span class="token punctuation">(</span><span class="token string">"genomation"</span><span class="token punctuation">)</span>
system<span class="token punctuation">(</span><span class="token string">"wget ftp://ftp.ensembl.org/pub/release-98/gtf/danio_rerio/Danio_rerio.GRCz11.98.gtf.gz"</span><span class="token punctuation">)</span>
gff <span class="token operator">&lt;-</span> gffToGRanges<span class="token punctuation">(</span><span class="token string">"./Danio_rerio.GRCz11.98.gtf.gz"</span><span class="token punctuation">)</span>
grl <span class="token operator">&lt;-</span> as<span class="token punctuation">(</span>split<span class="token punctuation">(</span>gff<span class="token punctuation">,</span> gff<span class="token operator">$</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"GRangesList"</span><span class="token punctuation">)</span>

Pairs <span class="token operator">&lt;-</span> findOverlapPairs<span class="token punctuation">(</span>as<span class="token punctuation">(</span>myDiff<span class="token punctuation">,</span><span class="token string">"GRanges"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> grl<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'gene'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<p>Below is an example how the Pairs looks like, so it joined two GRanges, one is my myDiff, and the other is the gene annotation, in theory they are both generated by Ensembl annotation so should be matching well. In the future I may need to find ways to get TSS, but for now I think this should be good enough as DMP annotation.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/457fcf60fc935f0bbcb4e912ed0d72ce/1843f/figure5.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 74.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACH0lEQVQ4y31Ux67iQBD0j3AAkUwy0TJgTM4myIBIB+KBAxwQ/69eVz3Me7xl99Dy2J6uru6qGaXdbstwOBTbtqXT6Uiz2ZRisSi6rotlWZLJZLjGM5vNSjqdllAoJOFw+GMo2JxMJiWXy0kkEpFKpULQUqkk8/lcEomEGIZBQIDl83lJpVLM+RQKErFAQjweJ1CtVpNyuSyTyYTfAAIwAIHlT0Csf4aCxNVqRTYAwxqtgtXhcOAo8A3P0Wgk2+2WrH8zewGiZWzabDZkgSe+xWIxuVwu0uv1ZLfbkW2/35f9fk/A38xegKZpEnC5XHJ+i8VCqtUqW0ay7QqGIgAcj8eyXq85HhT8YvfF1mNNhqh8Op24CQp6DAAMBwBgNptJNBqVRqPhRp0CekBeELBQKHA+5/OZYIFAgInY4AFCCMeZiaqqdEC9Xuf6k9oKBMAmJLZaLel2uwSCKCiEGaJ92x66/jT4blUsqq+ltL9niET8xMtgMKCiKACToognUK1edfepBDXNsqix6HN+76F4pkXi8CkAZoqWp9MpLYSWMTe0qesFKZYMdx15CfLWMvx3u93ker2SmWdyFILBUQj+wyi8Tj4ZGqFpmigw7+PxkPv9TjY+n0/8fj9VxAasIQKKBYNBgmIE/woFbR2PR6qMywGqQwSAw5c44wDEJQJm/7sYeDlgPgDCaXAcxz0tGg38PcskZwdwvH/b5T0Szxn+AaWC9BS3OM60AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Annotated DMP"
        title="Annotated DMP"
        src="/static/457fcf60fc935f0bbcb4e912ed0d72ce/00d43/figure5.png"
        srcset="/static/457fcf60fc935f0bbcb4e912ed0d72ce/63868/figure5.png 250w,
/static/457fcf60fc935f0bbcb4e912ed0d72ce/0b533/figure5.png 500w,
/static/457fcf60fc935f0bbcb4e912ed0d72ce/00d43/figure5.png 1000w,
/static/457fcf60fc935f0bbcb4e912ed0d72ce/1843f/figure5.png 1186w"
        sizes="(max-width: 1000px) 100vw, 1000px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p></div></main></div><div style="padding-top:3em;padding-bottom:3em;text-align:center"><p class="MuiTypography-root MuiTypography-body2 MuiTypography-colorTextSecondary MuiTypography-alignCenter">Copyright © <!-- -->Yuan Tian<!-- --> <!-- -->2021<!-- -->.</p></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/notes/RRBS-Analysis-3:-Differential-Methylated-Probes";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-88cc7d53bff4b644d77c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-852bd3a5faea7629c57d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-6dab3b30bb9a8f4fe806.js"],"component---src-pages-page-2-js":["/component---src-pages-page-2-js-ef8c063115e3c48e159a.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-ccc63956d1d6da3ec2a1.js"],"component---src-templates-note-template-js":["/component---src-templates-note-template-js-bb2de861ebb76f6672a7.js"]};/*]]>*/</script><script src="/component---src-templates-note-template-js-bb2de861ebb76f6672a7.js" async=""></script><script src="/commons-04ea66d531f38b0803fa.js" async=""></script><script src="/app-88cc7d53bff4b644d77c.js" async=""></script><script src="/styles-fa79fef4936efa84b233.js" async=""></script><script src="/framework-8dcecaaefd71e2213eb2.js" async=""></script><script src="/webpack-runtime-7edddabe2b187af8db09.js" async=""></script></body></html>