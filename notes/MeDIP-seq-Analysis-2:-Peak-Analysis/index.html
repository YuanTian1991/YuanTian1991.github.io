<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.7 'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:black;font-family:'Avenir Next','Helvetica Neue','Segoe UI','Helvetica','Arial',sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}ul{margin-left:1.7rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.7rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;font-size:0.85rem;line-height:1.7rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;font-size:1rem;line-height:1.7rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}blockquote{margin-left:1.7rem;margin-right:1.7rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.7rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.7rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.7rem;margin-bottom:calc(1.7rem / 2);margin-top:calc(1.7rem / 2);}li > ul{margin-left:1.7rem;margin-bottom:calc(1.7rem / 2);margin-top:calc(1.7rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.7rem / 2);}code{font-size:0.85rem;line-height:1.7rem;}kbd{font-size:0.85rem;line-height:1.7rem;}samp{font-size:0.85rem;line-height:1.7rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.13333rem;padding-right:1.13333rem;padding-top:0.85rem;padding-bottom:calc(0.85rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}</style><style data-href="/styles.8c9d20d4bc16c3f72d40.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}html{background-color:#fff}::selection{background:rgba(254,217,10,.7)}pre[class*=language-]{font-size:.8em;margin:2em 0;background-color:#272c34;border-radius:3px}code[class*=language-],pre[class*=language-]{color:#f5f5f5;text-shadow:none;font-family:Monaco,Andale Mono,Ubuntu Mono,SFMono-Regular,monospace}:not(pre)>code[class*=language-]{border-radius:.3em;color:red;white-space:normal}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,0)}</style><meta name="generator" content="Gatsby 2.23.10"/><style id="jss-server-side">.jss11{margin-top:8px;margin-bottom:8px}.MuiTypography-root{margin:0}.MuiTypography-body2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.43;letter-spacing:.01071em}.MuiTypography-body1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.5;letter-spacing:.00938em}.MuiTypography-caption{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.66;letter-spacing:.03333em}.MuiTypography-button{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;letter-spacing:.02857em;text-transform:uppercase}.MuiTypography-h1{font-size:6rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.167;letter-spacing:-.01562em}.MuiTypography-h2{font-size:3.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.2;letter-spacing:-.00833em}.MuiTypography-h3{font-size:3rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.167;letter-spacing:0}.MuiTypography-h4{font-size:2.125rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.235;letter-spacing:.00735em}.MuiTypography-h5{font-size:1.5rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.334;letter-spacing:0}.MuiTypography-h6{font-size:1.25rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.6;letter-spacing:.0075em}.MuiTypography-subtitle1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.75;letter-spacing:.00938em}.MuiTypography-subtitle2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.57;letter-spacing:.00714em}.MuiTypography-overline{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:2.66;letter-spacing:.08333em;text-transform:uppercase}.MuiTypography-srOnly{width:1px;height:1px;overflow:hidden;position:absolute}.MuiTypography-alignLeft{text-align:left}.MuiTypography-alignCenter{text-align:center}.MuiTypography-alignRight{text-align:right}.MuiTypography-alignJustify{text-align:justify}.MuiTypography-noWrap{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.MuiTypography-gutterBottom{margin-bottom:.35em}.MuiTypography-paragraph{margin-bottom:16px}.MuiTypography-colorInherit{color:inherit}.MuiTypography-colorPrimary{color:#3f51b5}.MuiTypography-colorSecondary{color:#f50057}.MuiTypography-colorTextPrimary{color:rgba(0,0,0,.87)}.MuiTypography-colorTextSecondary{color:rgba(0,0,0,.54)}.MuiTypography-colorError{color:#f44336}.MuiTypography-displayInline{display:inline}.MuiTypography-displayBlock{display:block}.MuiContainer-root{width:100%;display:block;box-sizing:border-box;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiContainer-root{padding-left:24px;padding-right:24px}}.MuiContainer-disableGutters{padding-left:0;padding-right:0}@media (min-width:600px){.MuiContainer-fixed{max-width:600px}}@media (min-width:960px){.MuiContainer-fixed{max-width:960px}}@media (min-width:1280px){.MuiContainer-fixed{max-width:1280px}}@media (min-width:1920px){.MuiContainer-fixed{max-width:1920px}}@media (min-width:0px){.MuiContainer-maxWidthXs{max-width:444px}}@media (min-width:600px){.MuiContainer-maxWidthSm{max-width:600px}}@media (min-width:960px){.MuiContainer-maxWidthMd{max-width:960px}}@media (min-width:1280px){.MuiContainer-maxWidthLg{max-width:1280px}}@media (min-width:1920px){.MuiContainer-maxWidthXl{max-width:1920px}}.MuiGrid-container{width:100%;display:flex;flex-wrap:wrap;box-sizing:border-box}.MuiGrid-item{margin:0;box-sizing:border-box}.MuiGrid-zeroMinWidth{min-width:0}.MuiGrid-direction-xs-column{flex-direction:column}.MuiGrid-direction-xs-column-reverse{flex-direction:column-reverse}.MuiGrid-direction-xs-row-reverse{flex-direction:row-reverse}.MuiGrid-wrap-xs-nowrap{flex-wrap:nowrap}.MuiGrid-wrap-xs-wrap-reverse{flex-wrap:wrap-reverse}.MuiGrid-align-items-xs-center{align-items:center}.MuiGrid-align-items-xs-flex-start{align-items:flex-start}.MuiGrid-align-items-xs-flex-end{align-items:flex-end}.MuiGrid-align-items-xs-baseline{align-items:baseline}.MuiGrid-align-content-xs-center{align-content:center}.MuiGrid-align-content-xs-flex-start{align-content:flex-start}.MuiGrid-align-content-xs-flex-end{align-content:flex-end}.MuiGrid-align-content-xs-space-between{align-content:space-between}.MuiGrid-align-content-xs-space-around{align-content:space-around}.MuiGrid-justify-xs-center{justify-content:center}.MuiGrid-justify-xs-flex-end{justify-content:flex-end}.MuiGrid-justify-xs-space-between{justify-content:space-between}.MuiGrid-justify-xs-space-around{justify-content:space-around}.MuiGrid-justify-xs-space-evenly{justify-content:space-evenly}.MuiGrid-spacing-xs-1{width:calc(100% + 8px);margin:-4px}.MuiGrid-spacing-xs-1>.MuiGrid-item{padding:4px}.MuiGrid-spacing-xs-2{width:calc(100% + 16px);margin:-8px}.MuiGrid-spacing-xs-2>.MuiGrid-item{padding:8px}.MuiGrid-spacing-xs-3{width:calc(100% + 24px);margin:-12px}.MuiGrid-spacing-xs-3>.MuiGrid-item{padding:12px}.MuiGrid-spacing-xs-4{width:calc(100% + 32px);margin:-16px}.MuiGrid-spacing-xs-4>.MuiGrid-item{padding:16px}.MuiGrid-spacing-xs-5{width:calc(100% + 40px);margin:-20px}.MuiGrid-spacing-xs-5>.MuiGrid-item{padding:20px}.MuiGrid-spacing-xs-6{width:calc(100% + 48px);margin:-24px}.MuiGrid-spacing-xs-6>.MuiGrid-item{padding:24px}.MuiGrid-spacing-xs-7{width:calc(100% + 56px);margin:-28px}.MuiGrid-spacing-xs-7>.MuiGrid-item{padding:28px}.MuiGrid-spacing-xs-8{width:calc(100% + 64px);margin:-32px}.MuiGrid-spacing-xs-8>.MuiGrid-item{padding:32px}.MuiGrid-spacing-xs-9{width:calc(100% + 72px);margin:-36px}.MuiGrid-spacing-xs-9>.MuiGrid-item{padding:36px}.MuiGrid-spacing-xs-10{width:calc(100% + 80px);margin:-40px}.MuiGrid-spacing-xs-10>.MuiGrid-item{padding:40px}.MuiGrid-grid-xs-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-xs-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-xs-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-xs-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-xs-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-xs-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-xs-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-xs-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-xs-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-xs-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-xs-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-xs-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-xs-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-xs-12{flex-grow:0;max-width:100%;flex-basis:100%}@media (min-width:600px){.MuiGrid-grid-sm-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-sm-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-sm-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-sm-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-sm-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-sm-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-sm-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-sm-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-sm-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-sm-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-sm-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-sm-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-sm-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-sm-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:960px){.MuiGrid-grid-md-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-md-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-md-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-md-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-md-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-md-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-md-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-md-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-md-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-md-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-md-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-md-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-md-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-md-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:1280px){.MuiGrid-grid-lg-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-lg-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-lg-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-lg-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-lg-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-lg-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-lg-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-lg-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-lg-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-lg-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-lg-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-lg-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-lg-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-lg-12{flex-grow:0;max-width:100%;flex-basis:100%}}@media (min-width:1920px){.MuiGrid-grid-xl-auto{flex-grow:0;max-width:none;flex-basis:auto}.MuiGrid-grid-xl-true{flex-grow:1;max-width:100%;flex-basis:0}.MuiGrid-grid-xl-1{flex-grow:0;max-width:8.333333%;flex-basis:8.333333%}.MuiGrid-grid-xl-2{flex-grow:0;max-width:16.666667%;flex-basis:16.666667%}.MuiGrid-grid-xl-3{flex-grow:0;max-width:25%;flex-basis:25%}.MuiGrid-grid-xl-4{flex-grow:0;max-width:33.333333%;flex-basis:33.333333%}.MuiGrid-grid-xl-5{flex-grow:0;max-width:41.666667%;flex-basis:41.666667%}.MuiGrid-grid-xl-6{flex-grow:0;max-width:50%;flex-basis:50%}.MuiGrid-grid-xl-7{flex-grow:0;max-width:58.333333%;flex-basis:58.333333%}.MuiGrid-grid-xl-8{flex-grow:0;max-width:66.666667%;flex-basis:66.666667%}.MuiGrid-grid-xl-9{flex-grow:0;max-width:75%;flex-basis:75%}.MuiGrid-grid-xl-10{flex-grow:0;max-width:83.333333%;flex-basis:83.333333%}.MuiGrid-grid-xl-11{flex-grow:0;max-width:91.666667%;flex-basis:91.666667%}.MuiGrid-grid-xl-12{flex-grow:0;max-width:100%;flex-basis:100%}}.MuiToolbar-root{display:flex;position:relative;align-items:center}.MuiToolbar-gutters{padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiToolbar-gutters{padding-left:24px;padding-right:24px}}.MuiToolbar-regular{min-height:56px}@media (min-width:0px) and (orientation:landscape){.MuiToolbar-regular{min-height:48px}}@media (min-width:600px){.MuiToolbar-regular{min-height:64px}}.MuiToolbar-dense{min-height:48px}.jss2{margin-left:auto}.jss3{color:#000;font-weight:700;text-decoration:none}.jss3:hover{color:#000;text-decoration:none}.jss4{color:#000;cursor:pointer;font-weight:900}.jss5{display:flex}.jss5>*{margin:8px}.jss6{cursor:pointer;padding-right:24px}.jss7{width:50px;height:50px;margin-top:1em;border-radius:25px}.jss8{width:60px;height:60px;border-radius:30px}.jss9{right:2em;width:5em;bottom:-2em;height:5em;padding:.2em;position:absolute}.jss10{height:0;display:flex;align-items:center;justify-content:center;background-color:rgba(245,245,245,0)}</style><title data-react-helmet="true"></title><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/webpack-runtime-6f28c2eee69962377363.js"/><link as="script" rel="preload" href="/framework-8dcecaaefd71e2213eb2.js"/><link as="script" rel="preload" href="/styles-fa79fef4936efa84b233.js"/><link as="script" rel="preload" href="/app-88cc7d53bff4b644d77c.js"/><link as="script" rel="preload" href="/commons-04ea66d531f38b0803fa.js"/><link as="script" rel="preload" href="/component---src-templates-note-template-js-3b4ebf0a47482aef66ee.js"/><link as="fetch" rel="preload" href="/page-data/notes/MeDIP-seq-Analysis-2:-Peak-Analysis/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="blog-post-container"><div class="MuiContainer-root MuiContainer-maxWidthLg"><div class="MuiBox-root jss11"><div class="MuiToolbar-root MuiToolbar-regular jss1 MuiToolbar-gutters"><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-1 MuiGrid-align-items-xs-center"><div class="MuiGrid-root MuiGrid-item">              <a class="jss3" href="/">Tian</a></div></div><div class="jss2"></div></div></div><div class="MuiContainer-root MuiContainer-maxWidthMd"><main><span style="margin-top:1em;margin-bottom:0px">November 17, 2020</span><h1 style="font-size:2.5em;font-weight:700;margin-top:0.2em">MeDIP-seq Analysis 2: Peak Analysis</h1><div class="blog-post-content"><p>After preprocessing, next I want to call peaks for each bound file. After searching seems there are some tools I can use, like Pepr, MACS2. etc, but since MACS2 is kind of popular and troditional, so I will use it here.</p>
<h2>1. Peak Calling</h2>
<h3>1.1. Merge Inputs files</h3>
<p>Firstly, since I have 4 phenotype (LT, TC, NC, NT), but only 2 of them have Input data, so I decided to merge all Input data togather and use all Bound file to call peak against it. I personally think, if we have proper Input data for each phenotype, we should definitly call peaks on each Input, so it's just a compromisation solution here.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">samtools merge MergedInput.bam <span class="token variable"><span class="token variable">`</span><span class="token function">ls</span> ./myGreyList/*_Inp.grey_filtered.bam<span class="token variable">`</span></span></code></pre></div>
<h3>1.2. Apply peak calling</h3>
<p>Then we can start to do peak calling. The key macs2 code is just online:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">macs2 callpeak -t Bound.bam -c Input.bam -f BAM -g hs --outdir macs2 -n SampleName <span class="token operator"><span class="token file-descriptor important">2</span>></span> macs2/SampleName-macs2.log</code></pre></div>
<p>The <code class="language-text">gs</code> parameter is vital as it indicates different species genome length, clearly that human and mouse have different genome length. Here I use hs indicate human. This is written in MACS2 manual. Since I want to make things easier and faster, I wrote below R script to do MACS2 calling across all samples automatically and parallel.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token comment"># This is script to do MACS2 calling</span>
<span class="token comment"># Author: Tian</span>

bams <span class="token operator">&lt;-</span> dir<span class="token punctuation">(</span><span class="token string">"../1.Preprocess/myGreyList/"</span><span class="token punctuation">,</span> pattern<span class="token operator">=</span><span class="token string">"*_bnd.grey_filtered.bam"</span><span class="token punctuation">)</span>
bams <span class="token operator">&lt;-</span> unique<span class="token punctuation">(</span>sapply<span class="token punctuation">(</span>bams<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> strsplit<span class="token punctuation">(</span>x<span class="token punctuation">,</span>split<span class="token operator">=</span><span class="token string">"[.]"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file.exists<span class="token punctuation">(</span><span class="token string">"./macs2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> dir.create<span class="token punctuation">(</span><span class="token string">"./macs2"</span><span class="token punctuation">)</span>

commands <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> bams<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    command <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span><span class="token string">"macs2 callpeak -t ../1.Preprocess/myGreyList/"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">".grey_filtered.bam -c ../1.Preprocess/MergedInput.bam -f BAM -g hs --outdir macs2 -n "</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">" -B -q 0.1 2>    macs2/"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">"-macs2.log"</span><span class="token punctuation">)</span>
    message<span class="token punctuation">(</span>command<span class="token punctuation">)</span>
    commands <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>commands<span class="token punctuation">,</span> command<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

runMacs <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    system<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

library<span class="token punctuation">(</span>doParallel<span class="token punctuation">)</span>
detectCores<span class="token punctuation">(</span><span class="token punctuation">)</span>
cl <span class="token operator">&lt;-</span> makeCluster<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>
registerDoParallel<span class="token punctuation">(</span>cl<span class="token punctuation">)</span>
getDoParWorkers<span class="token punctuation">(</span><span class="token punctuation">)</span>

library<span class="token punctuation">(</span>foreach<span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> foreach<span class="token punctuation">(</span>i <span class="token operator">=</span> commands<span class="token punctuation">)</span> <span class="token percent-operator operator">%dopar%</span> runMacs<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

registerDoSEQ<span class="token punctuation">(</span><span class="token punctuation">)</span>
on.exit<span class="token punctuation">(</span>stopCluster<span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<h2>2. DiffBind</h2>
<p>DiffBind could do many things, but in general, I am looking to do couple things as below:</p>
<ul>
<li>Find peaks enriched by each phenotype</li>
<li>Find Unique Peaks for each phenotype</li>
<li>Find non-unique but differential peaks by each phenotype (hyper- and hypo- separately)</li>
</ul>
<h3>2.1. Remove Outlier Sample</h3>
<p>So sad that even I have just so little samples, I still need to removed some as they are showing totally weird enrichment pattern for their phenotype. The second plot shows LT49 and LT51 seems wrong, maybe they are wrongly labeled, or during the experiment they did not get the tumour properly, instead they get normal liver samples. Anyway, I think we should remove them</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/42634808fc16bd774765caceca4808f0/4719e/figure.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 98%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAETklEQVQ4y02U224bVRSG/Ri8AS/ANQ/QO7hCCLioRIGbAkWAhERTpFCiSiWFVkmbQJ1CkzoNadM0hzYlbQ5ua6cxwYfYsePEcXF8SuLznGf8sWfGTrtHW3s0s/a//7XX/y/PwJKXm4Fp7NFstlBkFV3RaJsWlpjtdhtNUZkMzfDj/FUszaLVktBVHdOwMDVDrCaWZTnTM7a9yP2tJdxhiikAnLUzBKAqDpjPh7kWmjqOM0XU66NttZ3Vg2bSKKjMDSTw9UcIjSYp/7pB8UIAvVB/tUEwUo5kHt7bYXUkzvpglMDFNXIXnrG3mj8G9dgv/ug6p8+c587YOr7IHuFbG6RvBjioFtBFSoZhOBvS+7ucHR3k/j9x7s4nmLy+Sn78BeXHe4KvYSeHR5EU8vV9vn90jj7/eWrtPeocUhRPuVqi2WiiGzqapqPrKr+sXKFntpcCKeLGOnErTkbaoVVvuSnruoFqyCRrUfpm+hlcuEGyGiN2FKJUcxmapoEsy0iyxKFRwLc+wTe+Hrzx3xlODOLfW0FtqS6gHahoMgdKkbp5wPDqCJ/7vuVydIBYYRNDddM1TZNmq8l2LUGwskzvyk+8fekdTkyexBv+C1M2RMZtm6HunFyU/2O3kSRYXeL9ic/wfPEm4y9msa/GalsOqKppHMgFHuXmuJTo5y3vu3g+eoMvb/cdxzlFMURKpUqRg0aZzEGa5exzri77iO8mHaAuoCFYVppHpEoJAtkAE7F5rjwZ5WlsraMwu8odyTXqDWRRIFUI21Je6dBOw0VzF1WIXJVUDJFi91sXzAH0PhtlLDjjaFoRwYqiODLRhfpNy3WK7Zy5yEN+XvQ6IJJTIDElGbuoRifOARxKCKckl1/TvIUwn8Ot6xRJiHoyE2Ag6OuwNjrcTfFmdMPcKtts1HSDtT9j3Ln4gsgfmxR+2+T+9Sg7+9JxsC50KJdE8aZ2SS1mWbiXxD8QIX4tQjhdc6l0nbLyZI3eviuEbkRYehDh34kQs3MhoqWqiBKu1XVnQyKVprenn43oDk+DKTZ8EdIzW0RzVUwh+rYjbJFOXa8z8vwWl4NDZNlmnz3SephyLSe6j9ZxiuhAotrjkSlO3TzNoflSXE2DTTNMrr6N1JTdlDVVQ1FtHeb4ePQMX98+i7/4mMX9B2zlE6IgutCfuFVbr1ILyaoyvjbJyaHT+LPLxCohUuUkzXrTBVRkhbpUI9fK8FJJ8d3cOT70fsJY+gZbxbgANByGdpxmaDTUKlWrxO3wBKeGv2Jhd568lMXuCQ6gKhjWpSo7jThPi0sslmfp+fsHTgy+x2rqmSMnu562nBRF5lAtESz52ZaiTCen+GD4U+6GplFEyo71bFRdnJyv5MhUdogWIiQOY06H3swkj0Vru8XuyNVmhd2jNNnDDCV5n6XECqvR4LGjPN0NUkvGEM3WLpLthK4Mu/+7QxZi1sS9uq4SXVDRXwuE/wGoJKrPbhv1QQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="heatmap from Diffbind"
        title="heatmap from Diffbind"
        src="/static/42634808fc16bd774765caceca4808f0/00d43/figure.png"
        srcset="/static/42634808fc16bd774765caceca4808f0/63868/figure.png 250w,
/static/42634808fc16bd774765caceca4808f0/0b533/figure.png 500w,
/static/42634808fc16bd774765caceca4808f0/00d43/figure.png 1000w,
/static/42634808fc16bd774765caceca4808f0/4719e/figure.png 1330w"
        sizes="(max-width: 1000px) 100vw, 1000px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h3>2.2. Generate Affinity Matrix</h3>
<p>One very useful feature is to generate the affinity matrix, according to vignette, I can generate a matrix like this. In this step, the <code class="language-text">dba.count()</code> function  vital, as it calculate the affinity score based on read counts for every sample, rather than confidence scores for only those peaks called in a specific sample (occupancy scores). In short, the normalised matrix is "comparible" like a proper array matrix.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">myDBA <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>sampleSheet<span class="token operator">=</span><span class="token string">"./SampleList.csv"</span><span class="token punctuation">,</span> dir<span class="token operator">=</span><span class="token string">"./"</span><span class="token punctuation">)</span>
myDBA <span class="token operator">&lt;-</span> dba.count<span class="token punctuation">(</span>myDBA<span class="token punctuation">)</span>
myDBA <span class="token operator">&lt;-</span> dba.normalize<span class="token punctuation">(</span>myDBA<span class="token punctuation">)</span>
dba.peakset<span class="token punctuation">(</span>myDBA<span class="token punctuation">,</span> bRetrieve<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> writeFile<span class="token operator">=</span><span class="token string">"BindingAffinityMatrix.csv"</span><span class="token punctuation">)</span></code></pre></div>
<p>Eventually I get 441636, which is a good number indeed. Though compared with individual samples, there is a huge decrese of number, but still it's a good number. According to this post, Rory did normalisation across samples, so I think this result should be reliable. <strong>Here one reamining questions is I don't know how the these peaks are selected? Will find out later.</strong></p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token operator">></span> myDBA
<span class="token number">16</span> Samples<span class="token punctuation">,</span> <span class="token number">441636</span> sites <span class="token keyword">in</span> matrix<span class="token operator">:</span>
         ID Tissue Condition Treatment Replicate    Reads FRiP
<span class="token number">1</span>  SUL_LT52  Liver    Tumour      <span class="token number">5</span>hmC        <span class="token number">52</span> <span class="token number">19373481</span> <span class="token number">0.31</span>
<span class="token number">2</span>  SUL_LT53  Liver    Tumour      <span class="token number">5</span>hmC        <span class="token number">53</span>  <span class="token number">7815976</span> <span class="token number">0.27</span>
<span class="token number">3</span>  SUL_LT55  Liver    Tumour      <span class="token number">5</span>hmC        <span class="token number">55</span> <span class="token number">25472184</span> <span class="token number">0.23</span>
<span class="token number">4</span>  SUL_NC49  Colon    Normal      <span class="token number">5</span>hmC        <span class="token number">49</span> <span class="token number">12637511</span> <span class="token number">0.31</span>
<span class="token number">5</span>  SUL_NC51  Colon    Normal      <span class="token number">5</span>hmC        <span class="token number">51</span> <span class="token number">12560034</span> <span class="token number">0.32</span>
<span class="token number">6</span>  SUL_NC52  Colon    Normal      <span class="token number">5</span>hmC        <span class="token number">52</span>  <span class="token number">8095500</span> <span class="token number">0.29</span>
<span class="token number">7</span>  SUL_NC53  Colon    Normal      <span class="token number">5</span>hmC        <span class="token number">53</span> <span class="token number">15271257</span> <span class="token number">0.29</span>
<span class="token number">8</span>  SUL_NL49  Liver    Normal      <span class="token number">5</span>hmC        <span class="token number">49</span> <span class="token number">10980685</span> <span class="token number">0.38</span>
<span class="token number">9</span>  SUL_NL51  Liver    Normal      <span class="token number">5</span>hmC        <span class="token number">51</span> <span class="token number">18397068</span> <span class="token number">0.40</span>
<span class="token number">10</span> SUL_NL52  Liver    Normal      <span class="token number">5</span>hmC        <span class="token number">52</span>  <span class="token number">4259038</span> <span class="token number">0.34</span>
<span class="token number">11</span> SUL_NL53  Liver    Normal      <span class="token number">5</span>hmC        <span class="token number">53</span>  <span class="token number">1099676</span> <span class="token number">0.25</span>
<span class="token number">12</span> SUL_NL55  Liver    Normal      <span class="token number">5</span>hmC        <span class="token number">55</span>  <span class="token number">9119777</span> <span class="token number">0.39</span>
<span class="token number">13</span> SUL_TC49  Colon    Tumour      <span class="token number">5</span>hmC        <span class="token number">49</span>  <span class="token number">4753209</span> <span class="token number">0.21</span>
<span class="token number">14</span> SUL_TC51  Colon    Tumour      <span class="token number">5</span>hmC        <span class="token number">51</span> <span class="token number">12451098</span> <span class="token number">0.27</span>
<span class="token number">15</span> SUL_TC52  Colon    Tumour      <span class="token number">5</span>hmC        <span class="token number">52</span>  <span class="token number">7504298</span> <span class="token number">0.31</span>
<span class="token number">16</span> SUL_TC53  Colon    Tumour      <span class="token number">5</span>hmC        <span class="token number">53</span>  <span class="token number">9761884</span> <span class="token number">0.32</span></code></pre></div>
<h3>2.3. Get Consensus Peaks for each pheno</h3>
<p>Here I want to find out peaks that enriched in each phenotype (LT, TC. etc). The way consensus peak do is for each phenotype, find peaks show certain number of apperance in each phenotype. For example, in below code, <code class="language-text">minOverlap=2</code>, which means I set if a peak exist in two samples across all sample in this phenotype, I assume it's an peak for this phenotype.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">message<span class="token punctuation">(</span><span class="token string">"Generate Overlap Peaks across all Samples"</span><span class="token punctuation">)</span>
myDBA <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>sampleSheet<span class="token operator">=</span><span class="token string">"./SampleList.csv"</span><span class="token punctuation">,</span> dir<span class="token operator">=</span><span class="token string">"./"</span><span class="token punctuation">)</span>
myDBA_consensus <span class="token operator">&lt;-</span> dba.peakset<span class="token punctuation">(</span>myDBA<span class="token punctuation">,</span> consensus<span class="token operator">=</span>c<span class="token punctuation">(</span>DBA_TISSUE<span class="token punctuation">,</span>DBA_CONDITION<span class="token punctuation">)</span><span class="token punctuation">,</span> minOverlap<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
consensus <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>myDBA_consensus<span class="token punctuation">,</span> mask<span class="token operator">=</span>myDBA_consensus<span class="token operator">$</span>masks<span class="token operator">$</span>Consensus<span class="token punctuation">,</span> minOverlap<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
cons.ol <span class="token operator">&lt;-</span> dba.plotVenn<span class="token punctuation">(</span>consensus<span class="token punctuation">,</span> consensus<span class="token operator">$</span>masks<span class="token operator">$</span>Consensus<span class="token punctuation">)</span></code></pre></div>
<p>Below are consensus generated: so now I get one version of phenotype specific peaks. And even I can get their overlapped status below:</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token operator">></span> consensus
<span class="token number">4</span> Samples<span class="token punctuation">,</span> <span class="token number">378712</span> sites <span class="token keyword">in</span> matrix<span class="token operator">:</span>
            ID Tissue Condition Treatment      Replicate Intervals
<span class="token number">1</span> Liver<span class="token operator">:</span>Tumour  Liver    Tumour      <span class="token number">5</span>hmC       <span class="token number">52</span><span class="token operator">-</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">55</span>    <span class="token number">123665</span>
<span class="token number">2</span> Colon<span class="token operator">:</span>Normal  Colon    Normal      <span class="token number">5</span>hmC    <span class="token number">49</span><span class="token operator">-</span><span class="token number">51</span><span class="token operator">-</span><span class="token number">52</span><span class="token operator">-</span><span class="token number">53</span>    <span class="token number">130233</span>
<span class="token number">3</span> Liver<span class="token operator">:</span>Normal  Liver    Normal      <span class="token number">5</span>hmC <span class="token number">49</span><span class="token operator">-</span><span class="token number">51</span><span class="token operator">-</span><span class="token number">52</span><span class="token operator">-</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">55</span>    <span class="token number">275147</span>
<span class="token number">4</span> Colon<span class="token operator">:</span>Tumour  Colon    Tumour      <span class="token number">5</span>hmC    <span class="token number">49</span><span class="token operator">-</span><span class="token number">51</span><span class="token operator">-</span><span class="token number">52</span><span class="token operator">-</span><span class="token number">53</span>    <span class="token number">112944</span>
<span class="token operator">></span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 665px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b8f2fdbf3627dd634eeba6d86389ab3a/5f4af/figure1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 95.60000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAACnklEQVQ4y62U208TQRjFt61gm5CQKOiD8AcZ5ZIYn4z/kSGR6IPvJkpMAGlkERKIGjCFUiC0xGjAPkAWi9LtdXd2Lsdv9oZAKz6428lmv9357TnznamhlEI09BFd/zw61brVjateiGqcKxwfC1hWMFxXdpxjCCFg23ZXhVIG96WSi/7+Fnp6GFKpNhYW2n5diAtAz/NQLpfBGOsIjCbs7rro7RUwyJNhSMzPu7HyS5YdxyEL7l+BxaKLTIaHQAHT7ALknOPo6OifgOn0GbCrQr2GGqhV/hegBmh1sUIp4xhxxcEE11jsFh2yLK4G6qYcHBzECi/nJrh8KYnOCj0Zi4gVNptNuAT0Wi24jQZ4sw3bO8WcO4dpZxYmZrCyfYi+DM6ashCkQl7IrCGpKTWyWysWwYeG4A3fAQaGkf/wgiLQA8M1oM+JjSwGM0Fk9Mi+bQBVC+2yBad8CN5qh5YJ9t2yYBcK/udVIAGF95NI4xZ1zcdicnMeAzFQYfpVBVhdhWeuwckuw7UqYQ7Jv5Zd29mBSiYhUwmqJlBYeoZe3KRcGUjSa0/z54EzUydAIQ+1sgm+tAZW+RnGhppSqddR29721clEqHBRA290B74mYH4DcjkPb3EV7EcI5AS0qlXYW1tQqRTktSRVk6TwOVke9IGBZRO3+0JgQmF2qgtQW9YNr11Yw7w5QQ+v+0B9PlmfQ9qIFAJvXtKarecgl3Lg5iew45MwNrRTWqSyvr8PZ2wMzvgY+N1RfCu8wwP1CKPtEYyLe8h+3cDjhxL3Rx2M0Pj8sQrsleBs7qGZ2wE7tc9yqIMZZaoRNikqOL8cvVHigufZiAramd2ox4/9HJ77IyWYbhLC5Gs04wxCieCePsAY9/d3sDEUBOXYnxv88BvG/hYr1D45RQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Barplot for number of consensus peaks"
        title="Barplot for number of consensus peaks"
        src="/static/b8f2fdbf3627dd634eeba6d86389ab3a/5f4af/figure1.png"
        srcset="/static/b8f2fdbf3627dd634eeba6d86389ab3a/63868/figure1.png 250w,
/static/b8f2fdbf3627dd634eeba6d86389ab3a/0b533/figure1.png 500w,
/static/b8f2fdbf3627dd634eeba6d86389ab3a/5f4af/figure1.png 665w"
        sizes="(max-width: 665px) 100vw, 665px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 665px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f51123e3c8743d104c653032a7e648a2/5f4af/figure2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 95.60000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAACY0lEQVQ4y41UiXabMBDM//9Z075nv7S1Y5vYGCNzSNyHQICmCw4xkKv7LAvQ7mh2R9oHLExrPYzePM/DarXCdrvFfr/HbrfDer2G67rvfEd7+AqwqiokSYI4jpHn+TCiKBq+/xfguPiR48cbT99HwPGpnz8B6nT3tsltffQZY+6fHqbwo5tqa0QyQlAK5CqfsL95pCkQBhpJOoMe/u4MlYIuCpobNF2DY3LCNiIh+A5xFQ3eaQJYlsLzvsHBoPe4jyOGJa1Wi5Q1bas5B0wLyXmHhBmoXQ5mX8DLCL9PHK5QcBwP6TWEtIDoiWKPFEthCPQ85SGhXj3Ph6hD5EWK6npFaztgLwpnV+ASHtE6LSomEQkJ0ROPKXZIXU9SHllmtBKnSCkHkQl6zHAxFfKDidIXKE8KjDOIxAfnGcI+5bpnqN8KOWMIqmF2tvDCzghrHykxKORr1X85dDD7n0KkxFC/05kjofQR3hj2ws0BSRjFGNq2gx27ME4ZXP+K+tpSwRQ6j5G6EQznCPNSk3jkf1WAXAJO60g1hJIIEo0NsyGjHI3dEC9NgD5UwGFYJW0Y3I6hc6/fXJSxji2xIWUF4TqpgG976Aj84thoSKjwOcTZyUk4us+sF3J+u2YH+y11WcBZ2YTLIV582IlJh70FYYJvXFjsAMcgwPSe6lyU6W15nWUs4RoS2V+Jn08mfjxbeDxsEOz/oLIKVEE985+nvATtbnNdVggfXVSbAu6RoTI5wrWJKm/eNZNPAfWC6WAhyXih4csPOxP0l/1w0ca6V/XHsdj02wb7GdsBWE/b1ZzZaP8AMQfJIDbBGVAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Vennplot between consensus peaks"
        title="Vennplot between consensus peaks"
        src="/static/f51123e3c8743d104c653032a7e648a2/5f4af/figure2.png"
        srcset="/static/f51123e3c8743d104c653032a7e648a2/63868/figure2.png 250w,
/static/f51123e3c8743d104c653032a7e648a2/0b533/figure2.png 500w,
/static/f51123e3c8743d104c653032a7e648a2/5f4af/figure2.png 665w"
        sizes="(max-width: 665px) 100vw, 665px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Here I am thinking if I can firstly expend these peaks, then find consensus peaks, I should have more peaks with above code.</p>
<h3>2.4 Occupancy Analysis</h3>
<p>In above step, I get the consensus peaks for each phentoype, however, the Venn plot is too mess.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">message<span class="token punctuation">(</span><span class="token string">"Occupancy Analysis between NC and TC"</span><span class="token punctuation">)</span>
myDBA <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>sampleSheet<span class="token operator">=</span><span class="token string">"./SampleList.csv"</span><span class="token punctuation">,</span> dir<span class="token operator">=</span><span class="token string">"./"</span><span class="token punctuation">)</span>
NCTC <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>myDBA<span class="token punctuation">,</span> mask<span class="token operator">=</span>myDBA<span class="token operator">$</span>masks<span class="token operator">$</span>Colon<span class="token punctuation">)</span>
NCTC_consensus <span class="token operator">&lt;-</span> dba.peakset<span class="token punctuation">(</span>NCTC<span class="token punctuation">,</span> consensus<span class="token operator">=</span>c<span class="token punctuation">(</span>DBA_CONDITION<span class="token punctuation">)</span><span class="token punctuation">,</span> minOverlap<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
consensus <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>NCTC_consensus<span class="token punctuation">,</span> mask<span class="token operator">=</span>NCTC_consensus<span class="token operator">$</span>masks<span class="token operator">$</span>Consensus<span class="token punctuation">,</span> minOverlap<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
dba.plotVenn<span class="token punctuation">(</span>consensus<span class="token punctuation">,</span> consensus<span class="token operator">$</span>masks<span class="token operator">$</span>Consensus<span class="token punctuation">)</span>
NCTC.OL <span class="token operator">&lt;-</span> dba.overlap<span class="token punctuation">(</span>consensus<span class="token punctuation">,</span> consensus<span class="token operator">$</span>masks<span class="token operator">$</span>Consensus<span class="token punctuation">)</span></code></pre></div>
<p>Below is an example of these peaks:</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token operator">></span> consensus
<span class="token number">2</span> Samples<span class="token punctuation">,</span> <span class="token number">181063</span> sites <span class="token keyword">in</span> matrix<span class="token operator">:</span>
      ID Tissue Condition Treatment   Replicate Intervals
<span class="token number">1</span> Normal  Colon    Normal      <span class="token number">5</span>hmC <span class="token number">49</span><span class="token operator">-</span><span class="token number">51</span><span class="token operator">-</span><span class="token number">52</span><span class="token operator">-</span><span class="token number">53</span>    <span class="token number">130233</span>
<span class="token number">2</span> Tumour  Colon    Tumour      <span class="token number">5</span>hmC <span class="token number">49</span><span class="token operator">-</span><span class="token number">51</span><span class="token operator">-</span><span class="token number">52</span><span class="token operator">-</span><span class="token number">53</span>    <span class="token number">112944</span>
<span class="token operator">></span> head<span class="token punctuation">(</span>consensus<span class="token operator">$</span>peaks<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
   Chr Start   End      Score
<span class="token number">1</span> chr1 <span class="token number">20901</span> <span class="token number">21651</span> <span class="token number">0.08584423</span>
<span class="token number">2</span> chr1 <span class="token number">26761</span> <span class="token number">27145</span> <span class="token number">0.03783533</span>
<span class="token number">3</span> chr1 <span class="token number">29911</span> <span class="token number">30362</span> <span class="token number">0.13396484</span>
<span class="token number">4</span> chr1 <span class="token number">31371</span> <span class="token number">31761</span> <span class="token number">0.05202175</span>
<span class="token number">5</span> chr1 <span class="token number">35031</span> <span class="token number">35312</span> <span class="token number">0.04776754</span>
<span class="token number">6</span> chr1 <span class="token number">83634</span> <span class="token number">84090</span> <span class="token number">0.05267410</span>
<span class="token operator">></span></code></pre></div>
<p>The number is slightly different between below Venn Plot and above <code class="language-text">Intervals</code> because sometimes when calculating overlap peaks, multiple peaks in one peak set could be overlaped with only 1 peak in another peak set.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 429px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b84f16c2860ba4b58ffd19aa25c80d2f/3d026/figure3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 68.39999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAB30lEQVQ4y3VTWY6jMBDN/c/Tn3OCGWU+WgESErEFQhSIIeyL8WuXWQTd6ZJK5fLy/GrbQQig7wHOgWGA8icVK/tdSQYxoOMd+qFXa5KdArEswDCA61Vtikmxsu+k6iscn0dckgvyNp8A1VfDyHIGeTyAywXCPAHeFTzPELYxzuwMk5nwMg9lVy4sSWfWuyVEkqaB0HXA9yHqWt4G8iiA9u8DofEXLTh6GWJSJzCeBoI8GAlM78kqQOXKHIrDAaKqljBr3uDADAkjJbhLtt4mZAr1Xtw3oLuZnXBdII7HNefLg7zJxtBo/3iUv9SbvFIOqSg/GZomhMzjfJkuUb7GFPNxnzEIWTgx7SniMuyoilaAtJgqzdsWZ1kMTdOQFRmcwgF7Mui6JiO+Y0hT1Qk3Gcn//R6+6yMsQ8RV/DvDXmorgam/FEN5SD7xEUmiACnAuq5UHm75DVEZbQGVY9sAPRhPlKE2qab2UL1Jn5blpjAndkLL2zcMu26sMudLHou+hJ6cRucuWTjuBsx9ufAz/1uVV4xQFAoUUTQy6Qewhwv98w+YvpeTUSs2WfNSHeC8nPd9uAElhjSClg1BI+l4aKMQbhnATm2pFiypaZMuIDPgz0mZf5pneE7HL7IGm+0XFpY/xJ5rXa0AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Venn plot between Normal and Tumour"
        title="Venn plot between Normal and Tumour"
        src="/static/b84f16c2860ba4b58ffd19aa25c80d2f/3d026/figure3.png"
        srcset="/static/b84f16c2860ba4b58ffd19aa25c80d2f/63868/figure3.png 250w,
/static/b84f16c2860ba4b58ffd19aa25c80d2f/3d026/figure3.png 429w"
        sizes="(max-width: 429px) 100vw, 429px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h3>2.5 Differential Analysis</h3>
<p>Differential Analysis contains two points: One is normalisation, according to the vignette: "the <strong>safest</strong> method is probably to set <code class="language-text">background=TRUE</code> and <code class="language-text">normalize=DBA_NORM_NATIVE</code>, resulting in the use of background reads and the native normalization method". And the other is batch effect adjustment.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">message<span class="token punctuation">(</span><span class="token string">"Differential Analysis"</span><span class="token punctuation">)</span>
myDBA <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>sampleSheet<span class="token operator">=</span><span class="token string">"./SampleList.csv"</span><span class="token punctuation">,</span> dir<span class="token operator">=</span><span class="token string">"./"</span><span class="token punctuation">)</span>
NCTC <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>myDBA<span class="token punctuation">,</span> mask<span class="token operator">=</span>myDBA<span class="token operator">$</span>masks<span class="token operator">$</span>Colon<span class="token punctuation">)</span>

<span class="token comment"># Get Consensus Peaks</span>
NCTC_consensus <span class="token operator">&lt;-</span> dba.peakset<span class="token punctuation">(</span>NCTC<span class="token punctuation">,</span> consensus<span class="token operator">=</span>c<span class="token punctuation">(</span>DBA_CONDITION<span class="token punctuation">)</span><span class="token punctuation">,</span> minOverlap<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
consensus <span class="token operator">&lt;-</span> dba<span class="token punctuation">(</span>NCTC_consensus<span class="token punctuation">,</span> mask<span class="token operator">=</span>NCTC_consensus<span class="token operator">$</span>masks<span class="token operator">$</span>Consensus<span class="token punctuation">,</span> minOverlap<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
consensus_peaks <span class="token operator">&lt;-</span> dba.peakset<span class="token punctuation">(</span>consensus<span class="token punctuation">,</span> bRetrieve<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment"># Count/Normalize with ONLY consensus peaks</span>
NCTC <span class="token operator">&lt;-</span> dba.count<span class="token punctuation">(</span>NCTC<span class="token punctuation">,</span> peaks<span class="token operator">=</span>consensus_peaks<span class="token punctuation">,</span> summits<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> bParallel<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
NCTC <span class="token operator">&lt;-</span> dba.normalize<span class="token punctuation">(</span>NCTC<span class="token punctuation">,</span> method<span class="token operator">=</span>DBA_ALL_METHODS<span class="token punctuation">,</span> normalize<span class="token operator">=</span>DBA_NORM_NATIVE<span class="token punctuation">,</span> background<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment"># Find Differential Peaks with batch correction on Replicate.</span>
<span class="token comment"># The analysis step also will do Blacklist and Greylist removin</span>
NCTC <span class="token operator">&lt;-</span> dba.contrast<span class="token punctuation">(</span>NCTC<span class="token punctuation">,</span> design<span class="token operator">=</span><span class="token string">"~Replicate + Condition"</span><span class="token punctuation">)</span>
NCTC <span class="token operator">&lt;-</span> dba.analyze<span class="token punctuation">(</span>NCTC<span class="token punctuation">,</span> bParallel<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span>
rownames<span class="token punctuation">(</span>NCTC<span class="token operator">$</span>binding<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token operator">:</span>nrow<span class="token punctuation">(</span>NCTC<span class="token operator">$</span>binding<span class="token punctuation">)</span> <span class="token comment"># This is bug fix provided by package author</span>
NCTC.peaks <span class="token operator">&lt;-</span> dba.report<span class="token punctuation">(</span>NCTC<span class="token punctuation">,</span> bCalled<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span> th<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre></div>
<p>With above code, the <code class="language-text">bCalled</code> parameter is not working because I have generated consensus peaks, if I don't set <code class="language-text">peaks</code> parameter in <code class="language-text">dba.count()</code> I will get Called result for each groups.  I will asses their similarities later. So the result is below, there are 1171 significantly different peaks between two status among 168185 peaks. The number of consensus peak (total peaks for below table) is not as I expected as above Occupancy analysis, I need to find out why.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r"><span class="token operator">></span> knitr<span class="token operator">::</span>kable<span class="token punctuation">(</span>head<span class="token punctuation">(</span>NCTC.peaks<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token operator">|</span>seqnames <span class="token operator">|</span>     start<span class="token operator">|</span>       end<span class="token operator">|</span> width<span class="token operator">|</span>strand <span class="token operator">|</span> Conc<span class="token operator">|</span> Conc_Tumour<span class="token operator">|</span> Conc_Normal<span class="token operator">|</span> Fold<span class="token operator">|</span> p.value<span class="token operator">|</span>      FDR<span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">:</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span><span class="token operator">:</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">:</span><span class="token operator">|</span>
<span class="token operator">|</span>chr4     <span class="token operator">|</span>  <span class="token number">86515538</span><span class="token operator">|</span>  <span class="token number">86516038</span><span class="token operator">|</span>   <span class="token number">501</span><span class="token operator">|</span><span class="token operator">*</span>      <span class="token operator">|</span> <span class="token number">4.41</span><span class="token operator">|</span>        <span class="token number">5.41</span><span class="token operator">|</span>        <span class="token number">0.00</span><span class="token operator">|</span> <span class="token number">4.71</span><span class="token operator">|</span>       <span class="token number">0</span><span class="token operator">|</span> <span class="token number">0.000192</span><span class="token operator">|</span>
<span class="token operator">|</span>chr10    <span class="token operator">|</span>   <span class="token number">3978236</span><span class="token operator">|</span>   <span class="token number">3978736</span><span class="token operator">|</span>   <span class="token number">501</span><span class="token operator">|</span><span class="token operator">*</span>      <span class="token operator">|</span> <span class="token number">4.72</span><span class="token operator">|</span>        <span class="token number">5.64</span><span class="token operator">|</span>        <span class="token number">1.39</span><span class="token operator">|</span> <span class="token number">3.54</span><span class="token operator">|</span>       <span class="token number">0</span><span class="token operator">|</span> <span class="token number">0.000192</span><span class="token operator">|</span>
<span class="token operator">|</span>chr6     <span class="token operator">|</span>  <span class="token number">43543694</span><span class="token operator">|</span>  <span class="token number">43544194</span><span class="token operator">|</span>   <span class="token number">501</span><span class="token operator">|</span><span class="token operator">*</span>      <span class="token operator">|</span> <span class="token number">5.78</span><span class="token operator">|</span>        <span class="token number">6.74</span><span class="token operator">|</span>        <span class="token number">1.82</span><span class="token operator">|</span> <span class="token number">3.15</span><span class="token operator">|</span>       <span class="token number">0</span><span class="token operator">|</span> <span class="token number">0.000297</span><span class="token operator">|</span>
<span class="token operator">|</span>chr6     <span class="token operator">|</span>  <span class="token number">54690578</span><span class="token operator">|</span>  <span class="token number">54691078</span><span class="token operator">|</span>   <span class="token number">501</span><span class="token operator">|</span><span class="token operator">*</span>      <span class="token operator">|</span> <span class="token number">4.08</span><span class="token operator">|</span>        <span class="token number">5.07</span><span class="token operator">|</span>        <span class="token number">0.00</span><span class="token operator">|</span> <span class="token number">4.18</span><span class="token operator">|</span>       <span class="token number">0</span><span class="token operator">|</span> <span class="token number">0.000620</span><span class="token operator">|</span>
<span class="token operator">|</span>chrX     <span class="token operator">|</span>  <span class="token number">46375722</span><span class="token operator">|</span>  <span class="token number">46376222</span><span class="token operator">|</span>   <span class="token number">501</span><span class="token operator">|</span><span class="token operator">*</span>      <span class="token operator">|</span> <span class="token number">4.85</span><span class="token operator">|</span>        <span class="token number">5.81</span><span class="token operator">|</span>        <span class="token number">0.69</span><span class="token operator">|</span> <span class="token number">3.59</span><span class="token operator">|</span>       <span class="token number">0</span><span class="token operator">|</span> <span class="token number">0.000682</span><span class="token operator">|</span>
<span class="token operator">|</span>chr9     <span class="token operator">|</span> <span class="token number">124981900</span><span class="token operator">|</span> <span class="token number">124982400</span><span class="token operator">|</span>   <span class="token number">501</span><span class="token operator">|</span><span class="token operator">*</span>      <span class="token operator">|</span> <span class="token number">4.36</span><span class="token operator">|</span>        <span class="token number">5.34</span><span class="token operator">|</span>        <span class="token number">0.00</span><span class="token operator">|</span> <span class="token number">4.01</span><span class="token operator">|</span>       <span class="token number">0</span><span class="token operator">|</span> <span class="token number">0.000682</span><span class="token operator">|</span>
<span class="token operator">></span> sum<span class="token punctuation">(</span>NCTC.peaks<span class="token operator">$</span>FDR <span class="token operator">&lt;=</span> <span class="token number">0.05</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">1171</span>
<span class="token operator">></span></code></pre></div>
<h3>2.6. Questions not clear</h3>
<ul>
<li>There are seems multiple ways to find peaks enriched by each phenotype, Consensus, Occupancy Analysis, Differential Analysis .etc. <strong>I need to make sure I understand perfectly what are their differences, and what are really reliable occupancy peaks.</strong></li>
<li>If count and normalisation is the only way to generate affinity scores / matrix, can I generate them separately? As if I do it togather, I may have too few consensus peaks.</li>
</ul>
<h2>3. Annotated Peaks</h2>
<p>In above section, I successfully get differential peak information from DiffBind, but they are unannotated. Here I found a quick and easy way to do annotation for these peaks, by using <code class="language-text">org.Hs.eg.db</code> and <code class="language-text">ChIPpeakAnno</code> packages.</p>
<div class="gatsby-highlight" data-language="r"><pre class="language-r"><code class="language-r">message<span class="token punctuation">(</span><span class="token string">"Annotate Regions"</span><span class="token punctuation">)</span>
library<span class="token punctuation">(</span>org.Hs.eg.db<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>ChIPpeakAnno<span class="token punctuation">)</span>
data<span class="token punctuation">(</span>TSS.human.GRCh38<span class="token punctuation">)</span>
NCTC.peaks <span class="token operator">&lt;-</span> annotatePeakInBatch<span class="token punctuation">(</span>NCTC.peaks<span class="token punctuation">,</span> AnnotationData<span class="token operator">=</span>TSS.human.GRCh38<span class="token punctuation">)</span>
NCTC.peaks <span class="token operator">&lt;-</span> addGeneIDs<span class="token punctuation">(</span>NCTC.peaks<span class="token punctuation">,</span> <span class="token string">"org.Hs.eg.db"</span><span class="token punctuation">,</span> IDs2Add <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"entrez_id"</span><span class="token punctuation">,</span> <span class="token string">'symbol'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>After annotation, we know where are these peaks, then downstream analysis like GSEA, TSS selection, transcript factor binding site enrichment could consevutively done</p></div></main></div><div style="padding-top:3em;padding-bottom:3em;text-align:center"><p class="MuiTypography-root MuiTypography-body2 MuiTypography-colorTextSecondary MuiTypography-alignCenter">Copyright  <!-- -->Yuan Tian<!-- --> <!-- -->2021<!-- -->.</p></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/notes/MeDIP-seq-Analysis-2:-Peak-Analysis";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-88cc7d53bff4b644d77c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-852bd3a5faea7629c57d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-6dab3b30bb9a8f4fe806.js"],"component---src-pages-page-2-js":["/component---src-pages-page-2-js-ef8c063115e3c48e159a.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-ccc63956d1d6da3ec2a1.js"],"component---src-templates-note-template-js":["/component---src-templates-note-template-js-3b4ebf0a47482aef66ee.js"]};/*]]>*/</script><script src="/component---src-templates-note-template-js-3b4ebf0a47482aef66ee.js" async=""></script><script src="/commons-04ea66d531f38b0803fa.js" async=""></script><script src="/app-88cc7d53bff4b644d77c.js" async=""></script><script src="/styles-fa79fef4936efa84b233.js" async=""></script><script src="/framework-8dcecaaefd71e2213eb2.js" async=""></script><script src="/webpack-runtime-6f28c2eee69962377363.js" async=""></script></body></html>