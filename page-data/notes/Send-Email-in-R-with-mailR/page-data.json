{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Send-Email-in-R-with-mailR",
    "result": {"data":{"markdownRemark":{"html":"<p>It's cool and useful to allow R to send email, but I found it's not that easy to set up the environment. Here I am using <a href=\"https://cran.r-project.org/web/packages/mailR/index.html\">mailR</a> package. There are indeed some steps to follow to get it running...</p>\n<h2>1. Install Java and mailR package</h2>\n<p>Firstly this package relies on Java, so I need to install Java in my Ubuntu system:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">apt</span> <span class=\"token function\">install</span> -y default-jre\n<span class=\"token function\">apt</span> <span class=\"token function\">install</span> -y default-jdk</code></pre></div>\n<p>After above installation, if you already have R installed, try to config Java environment like:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">R CMD javareconf <span class=\"token comment\"># Configure Java</span></code></pre></div>\n<p>After above step, you can install mailR:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">install.packages<span class=\"token punctuation\">(</span><span class=\"token string\">\"mailR\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>2. Download dependences and modify security</h2>\n<p>Then it will still not working, because some Java library seems missing, I found the solution from <a href=\"https://stackoverflow.com/a/55418571\">here</a>. <strong>You need to enter the mailR library location, download two dependence packages below</strong>. Im my case (Ubuntu 20), the location is: /usr/local/lib/R/site-library/mailR/java</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> /usr/local/lib/R/site-library/mailR/java\n<span class=\"token function\">wget</span> https://repo1.maven.org/maven2/javax/activation/javax.activation-api/1.2.0/javax.activation-api-1.2.0.jar\n<span class=\"token function\">wget</span> https://repo1.maven.org/maven2/com/sun/activation/javax.activation/1.2.0/javax.activation-1.2.0.jar</code></pre></div>\n<p>Then, in some case you need to unblock your system's TLSv1 and TLSv1.1 setting: enter /usr/lib/jvm/java-11-openjdk-amd64/conf/security folder, modify <strong>java.security</strong> file, remove TLSv1 and TLSv1.1. I can't rememebr where I found this solution...</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">jdk.tls.disabledAlgorithms=SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, \\\n    DH keySize &lt; 1024, EC keySize &lt; 224, 3DES_EDE_CBC, anon, NULL, \\\n    include jdk.disabled.namedCurves</code></pre></div>\n<h2>3. Write R function</h2>\n<p>After you done all these above, now we can start to write a small R function to send email, like below. Note that the email SMTP setting must be in accord with your email, you need to google it out. And these email <strong>CAN NOT</strong> have security settings like two-step verification. You have to disable it to make everything work. It may makes your email weak. So in my case, I registered a new email for specifically deal with my \"programming email\".</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>mailR<span class=\"token punctuation\">)</span>\n\nNoticeEmail <span class=\"token operator\">&lt;-</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>Title<span class=\"token punctuation\">,</span> Message<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  send.mail<span class=\"token punctuation\">(</span>from <span class=\"token operator\">=</span> <span class=\"token string\">\"XXXX@gmail.com\"</span><span class=\"token punctuation\">,</span>\n            to <span class=\"token operator\">=</span> <span class=\"token string\">\"others@email.com\"</span><span class=\"token punctuation\">,</span>\n            subject <span class=\"token operator\">=</span> Title<span class=\"token punctuation\">,</span>\n            body <span class=\"token operator\">=</span> Message<span class=\"token punctuation\">,</span>\n            smtp <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span>host.name <span class=\"token operator\">=</span> <span class=\"token string\">\"smtp.gmail.com\"</span><span class=\"token punctuation\">,</span> port <span class=\"token operator\">=</span> <span class=\"token number\">587</span><span class=\"token punctuation\">,</span>\n                        user.name <span class=\"token operator\">=</span> <span class=\"token string\">\"XXXX@gmail.com\"</span><span class=\"token punctuation\">,</span>\n                        passwd <span class=\"token operator\">=</span> <span class=\"token string\">\"myPassword\"</span><span class=\"token punctuation\">,</span>\n                        ssl <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            authenticate <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span>\n            send <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The way to run it is like below, easy to use, so everytime I have a big function running. I can just copy page below two lines into stalled R session. Like</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">source<span class=\"token punctuation\">(</span><span class=\"token string\">\"./NoticeEmail.R\"</span><span class=\"token punctuation\">)</span>\nNoticeEmail<span class=\"token punctuation\">(</span><span class=\"token string\">\" XXX Program Finished Title\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"XXX Programe success/fail.\"</span><span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"date":"October 05, 2021","slug":"/notes/Send-Email-in-R-with-mailR","title":"Send Email in R with mailR","tags":["R"],"abstract":"In many cases we may want to send email with R. For example, running a super long program, we want to have a remind email after finishing. Or like me, want to create website with R backend that automatically do some work. Based on my test, mailR is one solution."}}},"pageContext":{"slug":"/notes/Send-Email-in-R-with-mailR"}},
    "staticQueryHashes": ["63159454"]}