{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/R-Plotly-Quick-Code",
    "result": {"data":{"markdownRemark":{"html":"<p>For years I believe when compared with interative figures like Echart.js, Ploly in R .etc, static figures are so weak. However, I did not spend time on it because in academic most figure have to be generated in static ways... Here is some of my corrections of Plotly code, I put them here for myself copy-paste.</p>\n<p>Actually, I am thinking to wrap it in a better way, so that in the future I can directly run a simple command for interactive figures, like:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">fig <span class=\"token operator\">&lt;-</span> myPlotly.bar<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>country<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>population<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token ellipsis\">...</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>Note that I am using plotly version plotly_4.10.0 here.</strong></p>\n<h2>StackBarplot</h2>\n<p>The code is similar to ggplot2, which is good. Assuming I have a data.frame as:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>TotalReadCount<span class=\"token punctuation\">)</span>\n    sample        fileID readsNumber\n<span class=\"token number\">1</span> N002S006 N002S006.json    <span class=\"token number\">17922821</span>\n<span class=\"token number\">2</span> N002S007 N002S007.json    <span class=\"token number\">21331323</span>\n<span class=\"token number\">3</span> N002S008 N002S008.json    <span class=\"token number\">20830328</span>\n<span class=\"token number\">4</span> N002S009 N002S009.json    <span class=\"token number\">25751431</span>\n<span class=\"token number\">5</span> N002S010 N002S010.json    <span class=\"token number\">67328774</span>\n<span class=\"token number\">6</span> N002S011 N002S011.json    <span class=\"token number\">52996705</span></code></pre></div>\n<p>Then below code can be used to draw the figure:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">\"plotly\"</span><span class=\"token punctuation\">)</span>\n\nfig <span class=\"token operator\">&lt;-</span> plot_ly<span class=\"token punctuation\">(</span>TotalReadCount<span class=\"token punctuation\">,</span>\n               x <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>sample<span class=\"token punctuation\">,</span>\n               y <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>readsNumber<span class=\"token punctuation\">,</span>\n               text<span class=\"token operator\">=</span><span class=\"token operator\">~</span>fileID<span class=\"token punctuation\">,</span>\n               type <span class=\"token operator\">=</span> <span class=\"token string\">'bar'</span><span class=\"token punctuation\">,</span>\n               name <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>fileID<span class=\"token punctuation\">,</span>\n               marker <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span>color <span class=\"token operator\">=</span> <span class=\"token string\">'rgb(158,202,225)'</span><span class=\"token punctuation\">,</span> line <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span>color <span class=\"token operator\">=</span> <span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span> width <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span>\n       layout<span class=\"token punctuation\">(</span>yaxis <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'Total Reads Number'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              barmode <span class=\"token operator\">=</span> <span class=\"token string\">'stack'</span><span class=\"token punctuation\">,</span>\n              title <span class=\"token operator\">=</span> <span class=\"token string\">'Total raw reads across all samples'</span><span class=\"token punctuation\">,</span>\n              showlegend <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span>\n\nhtmlwidgets<span class=\"token operator\">::</span>saveWidget<span class=\"token punctuation\">(</span>as_widget<span class=\"token punctuation\">(</span>fig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TotalReads.html\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Below is the generated HTML file, by click it I can check each sample's status very easily.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/07bb648b6add48501e389d53ebb53acb/3b25c/stackBarPlot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTElEQVQY01WO2UsCcRSF5/9/SE1oeSh6KAhyz6QSdyOXXCoryaJSJ2dGR8fKbVy+mF8qdOFwPi6He640m80ZjCeY0xmrWSwWQisWDvS+B/QHI+HGz/Bfdr50aWJOqcmaCFkzmpjr4IqtMkuFWp3zm0eS9y/cvjbXD8zm8/VDUks3OMs98FRXGE9MXj/bWCX9nyH3bzKK3udF1qi8fxLMVtjwxNi7yHAcL6D1vhiOTT5UHbXbF0elakPlJFXCnS4TuL4jUn7Gky7jSpU4CGfZCqbYDV1xGM2zf5nF4Utg8yXE3pUsEszccRTNcxTNcZqtIIWLVWyeKDuhKxzeGFunKezeGHZvHKc/IQ5s+hM4A0sXnGTTFxc5py8u2OaOsB1MI7W7Bu+yQr2l0VA06i2VhsWtJS93H7IiuKm2aSptZLWDqhsoeg+l8ye1a/ALIgirKTAw3FMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"StackBarplot\"\n        title=\"StackBarplot\"\n        src=\"/static/07bb648b6add48501e389d53ebb53acb/00d43/stackBarPlot.png\"\n        srcset=\"/static/07bb648b6add48501e389d53ebb53acb/63868/stackBarPlot.png 250w,\n/static/07bb648b6add48501e389d53ebb53acb/0b533/stackBarPlot.png 500w,\n/static/07bb648b6add48501e389d53ebb53acb/00d43/stackBarPlot.png 1000w,\n/static/07bb648b6add48501e389d53ebb53acb/aa440/stackBarPlot.png 1500w,\n/static/07bb648b6add48501e389d53ebb53acb/e8950/stackBarPlot.png 2000w,\n/static/07bb648b6add48501e389d53ebb53acb/3b25c/stackBarPlot.png 3440w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Some key point for this figure:</p>\n<ul>\n<li>Learn how to modify colour, especially line colour has to be set along with width.</li>\n<li>Learn how to export it into HTML. I will later see if I can merge multiple plotly interactive figures into one big HTML like fastQC do. If it works, it would be very cool...</li>\n</ul>\n<h2>Multiple Line Plot</h2>\n<p>Below I draw the miltiple line plot. The key thing for below plot is, in a big df, there is a column indicates each sample, which need to be specified in <code class=\"language-text\">split</code> parameter, then the colour need to specified in <code class=\"language-text\">color</code>. However, the legend is still not very right... thus I am hiding it.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">figCpGNumber <span class=\"token operator\">&lt;-</span> plot_ly<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> x <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>frac<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>value<span class=\"token punctuation\">,</span> split<span class=\"token operator\">=</span><span class=\"token operator\">~</span>sample<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token operator\">~</span>run<span class=\"token punctuation\">,</span> type <span class=\"token operator\">=</span> <span class=\"token string\">'scatter'</span><span class=\"token punctuation\">,</span> mode <span class=\"token operator\">=</span> <span class=\"token string\">'lines+markers'</span><span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%>%</span>      \n    layout<span class=\"token punctuation\">(</span>yaxis <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'Number of CpG remained'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>                    \n           title <span class=\"token operator\">=</span> <span class=\"token string\">'CpG Coverage Filtering'</span><span class=\"token punctuation\">,</span>                                  \n           showlegend <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span>                                                \n                                                                              \nhtmlwidgets<span class=\"token operator\">::</span>saveWidget<span class=\"token punctuation\">(</span>as_widget<span class=\"token punctuation\">(</span>figCpGNumber<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CpGNumberCoverage.html\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4486ec6d36fa082c944ca68d3126d704/985a9/multipleLinePlot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABl0lEQVQoz4WSz2sTQRTH8x970IMH9SBIT4IggiDiQQ/axDSatEtjGwpJtE2kJpSSGNrYH1qzy26zu213NrM785FZG5JKqQ++M1/ePD4z7zE5rTVKKaILn0RGmDA5rVXm0zRFCJHJ+Nn59coZmDHheUhv6w2x3WUa8+CruRuAZkkSmRXvbjfovF9g3H9NEgxQCvQc+H+wDDjfiuvaVJcKNPIvOdq6jxg8Q3q7qOSy1SmcG4BRFGUzNOUilnxr11jOWzSLFX40nxC2byP2XhF7PZQI0H9LZ6/+B56bTCZM55hq+HW4R33DorK0SmN5nc7ndzhfHhB0H3K28xgxLCLHfZS4QCdcXqCuztC0bHYTp37IYKfFp7UqVrnKWrlGu2Zx2HnLcespJ817uF/vEPQXECcV1NkBWkp0yjXAzCvs3yM6mxusrnzE+lBgPb9IrVCiXirTKi3SLb7ge+kRw5Vb2PW7+L3nCG9z9m2klBl0qslEEvghp46DMzrGdYe4zj7eaIg3OmBs/yQwGh1xbu8Tu9vEfp80TfgD0wCiIImhdDwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MultipleLinePlot\"\n        title=\"MultipleLinePlot\"\n        src=\"/static/4486ec6d36fa082c944ca68d3126d704/00d43/multipleLinePlot.png\"\n        srcset=\"/static/4486ec6d36fa082c944ca68d3126d704/63868/multipleLinePlot.png 250w,\n/static/4486ec6d36fa082c944ca68d3126d704/0b533/multipleLinePlot.png 500w,\n/static/4486ec6d36fa082c944ca68d3126d704/00d43/multipleLinePlot.png 1000w,\n/static/4486ec6d36fa082c944ca68d3126d704/aa440/multipleLinePlot.png 1500w,\n/static/4486ec6d36fa082c944ca68d3126d704/985a9/multipleLinePlot.png 1512w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"July 24, 2022","slug":"/notes/R-Plotly-Quick-Code","title":"R Plotly Quick Code","tags":["R","Plotly","Web","Visualisation"],"abstract":"A couple of years I did not use Plotly anymore, which is still such a good tool for interactive figure. Here are code I used to draw Plotly figures."}}},"pageContext":{"slug":"/notes/R-Plotly-Quick-Code"}},
    "staticQueryHashes": ["63159454"]}