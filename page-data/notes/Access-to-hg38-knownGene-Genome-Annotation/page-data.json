{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Access-to-hg38-knownGene-Genome-Annotation",
    "result": {"data":{"markdownRemark":{"html":"<p>In my last post, I compared ncbiRefSeq, refGene, wgEncodeXXXXV39 and knownGene. Based on my test, knownGene is actually a pretty good \"general usage\" annotation and decide to it as my main (hopefully only) genome annotation across all my work. Here I record a bit how to get this knownGene (and it's attributes). Mererly I found two ways, one is through UCSC mySQL browser, and the other is R package <code class=\"language-text\">TxDb.Hsapiens.UCSC.hg38.knownGene</code>.</p>\n<blockquote>\n<p>knownGene for hg19 is generated from NCBI RefSeq, but knwonGene for hg38 is generated from GENCODE. So even the gene ID are not the same...</p>\n</blockquote>\n<h2>UCSC MySQL Approach</h2>\n<p>This my favorite access, the code is simple. I use R access below, but actually any language would work. The table on UCSC mySQL is <code class=\"language-text\">knownGene</code>, <strong>which is actually not match <a href=\"https://genome.ucsc.edu/cgi-bin/hgTables?hgta_doSchemaDb=hg38&#x26;hgta_doSchemaTable=knownGene\">the schema</a> though</strong>...</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>RMySQL<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>GenomicRanges<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>stringr<span class=\"token punctuation\">)</span>\n\ncon_ucsc <span class=\"token operator\">&lt;-</span> dbConnect<span class=\"token punctuation\">(</span>RMySQL<span class=\"token operator\">::</span>MySQL<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> db <span class=\"token operator\">=</span> <span class=\"token string\">\"hg38\"</span><span class=\"token punctuation\">,</span> user <span class=\"token operator\">=</span> <span class=\"token string\">\"genome\"</span><span class=\"token punctuation\">,</span> host <span class=\"token operator\">=</span> <span class=\"token string\">\"genome-mysql.soe.ucsc.edu\"</span><span class=\"token punctuation\">)</span>\ngenomeAnnotation <span class=\"token operator\">&lt;-</span> suppressWarnings<span class=\"token punctuation\">(</span>dbGetQuery<span class=\"token punctuation\">(</span>con_ucsc<span class=\"token punctuation\">,</span> stringr<span class=\"token operator\">::</span>str_interp<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * FROM knownGene\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndbDisconnect<span class=\"token punctuation\">(</span>con_ucsc<span class=\"token punctuation\">)</span></code></pre></div>\n<p>The returned tabls is a data.frame. It contains key informations like chrom, TSS, TTS, cds range, exon locations .etc It's good enought for me to calculate ranges like first exon, 5-TUR .etc</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">(</span>genomeAnnotation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">|</span>name              <span class=\"token operator\">|</span>chrom <span class=\"token operator\">|</span>strand <span class=\"token operator\">|</span> txStart<span class=\"token operator\">|</span> txEnd<span class=\"token operator\">|</span> cdsStart<span class=\"token operator\">|</span> cdsEnd<span class=\"token operator\">|</span> exonCount<span class=\"token operator\">|</span>exonStarts         <span class=\"token operator\">|</span>exonEnds           <span class=\"token operator\">|</span>proteinID <span class=\"token operator\">|</span>alignID    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000619216.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>chr1  <span class=\"token operator\">|</span><span class=\"token operator\">-</span>      <span class=\"token operator\">|</span>   <span class=\"token number\">17368</span><span class=\"token operator\">|</span> <span class=\"token number\">17436</span><span class=\"token operator\">|</span>    <span class=\"token number\">17368</span><span class=\"token operator\">|</span>  <span class=\"token number\">17368</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">17368</span><span class=\"token punctuation\">,</span>             <span class=\"token operator\">|</span><span class=\"token number\">17436</span><span class=\"token punctuation\">,</span>             <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>uc031tla.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000473358.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>chr1  <span class=\"token operator\">|</span><span class=\"token operator\">+</span>      <span class=\"token operator\">|</span>   <span class=\"token number\">29553</span><span class=\"token operator\">|</span> <span class=\"token number\">31097</span><span class=\"token operator\">|</span>    <span class=\"token number\">29553</span><span class=\"token operator\">|</span>  <span class=\"token number\">29553</span><span class=\"token operator\">|</span>         <span class=\"token number\">3</span><span class=\"token operator\">|</span><span class=\"token number\">29553</span><span class=\"token punctuation\">,</span><span class=\"token number\">30563</span><span class=\"token punctuation\">,</span><span class=\"token number\">30975</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">|</span><span class=\"token number\">30039</span><span class=\"token punctuation\">,</span><span class=\"token number\">30667</span><span class=\"token punctuation\">,</span><span class=\"token number\">31097</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>uc057aty.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000469289.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>chr1  <span class=\"token operator\">|</span><span class=\"token operator\">+</span>      <span class=\"token operator\">|</span>   <span class=\"token number\">30266</span><span class=\"token operator\">|</span> <span class=\"token number\">31109</span><span class=\"token operator\">|</span>    <span class=\"token number\">30266</span><span class=\"token operator\">|</span>  <span class=\"token number\">30266</span><span class=\"token operator\">|</span>         <span class=\"token number\">2</span><span class=\"token operator\">|</span><span class=\"token number\">30266</span><span class=\"token punctuation\">,</span><span class=\"token number\">30975</span><span class=\"token punctuation\">,</span>       <span class=\"token operator\">|</span><span class=\"token number\">30667</span><span class=\"token punctuation\">,</span><span class=\"token number\">31109</span><span class=\"token punctuation\">,</span>       <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>uc057atz.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000607096.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>chr1  <span class=\"token operator\">|</span><span class=\"token operator\">+</span>      <span class=\"token operator\">|</span>   <span class=\"token number\">30365</span><span class=\"token operator\">|</span> <span class=\"token number\">30503</span><span class=\"token operator\">|</span>    <span class=\"token number\">30365</span><span class=\"token operator\">|</span>  <span class=\"token number\">30365</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">30365</span><span class=\"token punctuation\">,</span>             <span class=\"token operator\">|</span><span class=\"token number\">30503</span><span class=\"token punctuation\">,</span>             <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>uc031tlb.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000417324.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>chr1  <span class=\"token operator\">|</span><span class=\"token operator\">-</span>      <span class=\"token operator\">|</span>   <span class=\"token number\">34553</span><span class=\"token operator\">|</span> <span class=\"token number\">36081</span><span class=\"token operator\">|</span>    <span class=\"token number\">34553</span><span class=\"token operator\">|</span>  <span class=\"token number\">34553</span><span class=\"token operator\">|</span>         <span class=\"token number\">3</span><span class=\"token operator\">|</span><span class=\"token number\">34553</span><span class=\"token punctuation\">,</span><span class=\"token number\">35276</span><span class=\"token punctuation\">,</span><span class=\"token number\">35720</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">|</span><span class=\"token number\">35174</span><span class=\"token punctuation\">,</span><span class=\"token number\">35481</span><span class=\"token punctuation\">,</span><span class=\"token number\">36081</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>uc001aak.<span class=\"token number\">4</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000461467.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>chr1  <span class=\"token operator\">|</span><span class=\"token operator\">-</span>      <span class=\"token operator\">|</span>   <span class=\"token number\">35244</span><span class=\"token operator\">|</span> <span class=\"token number\">36073</span><span class=\"token operator\">|</span>    <span class=\"token number\">35244</span><span class=\"token operator\">|</span>  <span class=\"token number\">35244</span><span class=\"token operator\">|</span>         <span class=\"token number\">2</span><span class=\"token operator\">|</span><span class=\"token number\">35244</span><span class=\"token punctuation\">,</span><span class=\"token number\">35720</span><span class=\"token punctuation\">,</span>       <span class=\"token operator\">|</span><span class=\"token number\">35481</span><span class=\"token punctuation\">,</span><span class=\"token number\">36073</span><span class=\"token punctuation\">,</span>       <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>uc057aua.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p>However, I need some more additional information, like Gene Symbol, Transcript Types (coding gene, long-non-coding .etc). The <code class=\"language-text\">knownAttrs</code> and <code class=\"language-text\">kgXref</code> is a good option. We can get it as below:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">genomeAttrs <span class=\"token operator\">&lt;-</span> suppressWarnings<span class=\"token punctuation\">(</span>dbGetQuery<span class=\"token punctuation\">(</span>con_ucsc<span class=\"token punctuation\">,</span> stringr<span class=\"token operator\">::</span>str_interp<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * FROM knownAttrs\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ngenomeXref <span class=\"token operator\">&lt;-</span> suppressWarnings<span class=\"token punctuation\">(</span>dbGetQuery<span class=\"token punctuation\">(</span>con_ucsc<span class=\"token punctuation\">,</span> stringr<span class=\"token operator\">::</span>str_interp<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * FROM kgXref\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-text\">knownAttrs</code> is useful here is because it provided geneID, geneType and havana status.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">(</span>genomeAttrs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">|</span>kgID               <span class=\"token operator\">|</span>geneId             <span class=\"token operator\">|</span>geneStatus <span class=\"token operator\">|</span>geneType       <span class=\"token operator\">|</span>transcriptName <span class=\"token operator\">|</span>transcriptType <span class=\"token operator\">|</span>transcriptStatus <span class=\"token operator\">|</span>havanaGeneId         <span class=\"token operator\">|</span>ccdsId      <span class=\"token operator\">|</span>supportLevel <span class=\"token operator\">|</span>transcriptClass <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000000233.<span class=\"token number\">10</span> <span class=\"token operator\">|</span>ENSG00000004059.<span class=\"token number\">11</span> <span class=\"token operator\">|</span>           <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>ARF5<span class=\"token operator\">-</span><span class=\"token number\">201</span>       <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>                 <span class=\"token operator\">|</span>OTTHUMG00000023246.<span class=\"token number\">7</span> <span class=\"token operator\">|</span>CCDS34745.<span class=\"token number\">1</span> <span class=\"token operator\">|</span><span class=\"token number\">2</span>            <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000000412.<span class=\"token number\">8</span>  <span class=\"token operator\">|</span>ENSG00000003056.<span class=\"token number\">8</span>  <span class=\"token operator\">|</span>           <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>M6PR<span class=\"token operator\">-</span><span class=\"token number\">201</span>       <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>                 <span class=\"token operator\">|</span>OTTHUMG00000168276.<span class=\"token number\">4</span> <span class=\"token operator\">|</span>CCDS8598.<span class=\"token number\">1</span>  <span class=\"token operator\">|</span><span class=\"token number\">2</span>            <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000000442.<span class=\"token number\">11</span> <span class=\"token operator\">|</span>ENSG00000173153.<span class=\"token number\">17</span> <span class=\"token operator\">|</span>           <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>ESRRA<span class=\"token operator\">-</span><span class=\"token number\">201</span>      <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>                 <span class=\"token operator\">|</span>OTTHUMG00000150641.<span class=\"token number\">9</span> <span class=\"token operator\">|</span>CCDS41667.<span class=\"token number\">1</span> <span class=\"token operator\">|</span><span class=\"token number\">2</span>            <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000001008.<span class=\"token number\">6</span>  <span class=\"token operator\">|</span>ENSG00000004478.<span class=\"token number\">8</span>  <span class=\"token operator\">|</span>           <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>FKBP4<span class=\"token operator\">-</span><span class=\"token number\">201</span>      <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>                 <span class=\"token operator\">|</span>OTTHUMG00000090429.<span class=\"token number\">4</span> <span class=\"token operator\">|</span>CCDS8512.<span class=\"token number\">1</span>  <span class=\"token operator\">|</span><span class=\"token number\">2</span>            <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000001146.<span class=\"token number\">7</span>  <span class=\"token operator\">|</span>ENSG00000003137.<span class=\"token number\">9</span>  <span class=\"token operator\">|</span>           <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>CYP26B1<span class=\"token operator\">-</span><span class=\"token number\">201</span>    <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>                 <span class=\"token operator\">|</span>OTTHUMG00000129756.<span class=\"token number\">5</span> <span class=\"token operator\">|</span>CCDS1919.<span class=\"token number\">1</span>  <span class=\"token operator\">|</span><span class=\"token number\">2</span>            <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000002125.<span class=\"token number\">9</span>  <span class=\"token operator\">|</span>ENSG00000003509.<span class=\"token number\">16</span> <span class=\"token operator\">|</span>           <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>NDUFAF7<span class=\"token operator\">-</span><span class=\"token number\">201</span>    <span class=\"token operator\">|</span>protein_coding <span class=\"token operator\">|</span>                 <span class=\"token operator\">|</span>OTTHUMG00000128468.<span class=\"token number\">7</span> <span class=\"token operator\">|</span>CCDS1788.<span class=\"token number\">1</span>  <span class=\"token operator\">|</span><span class=\"token number\">2</span>            <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p><code class=\"language-text\">kgXref</code> is useful because it provided a mapping between Ensembl gene ID (kgID below), geneSymbol and NCBI RefSeq gene ID.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">(</span>genomeXref<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">|</span>kgID              <span class=\"token operator\">|</span>mRNA      <span class=\"token operator\">|</span>spID <span class=\"token operator\">|</span>spDisplayID <span class=\"token operator\">|</span>geneSymbol  <span class=\"token operator\">|</span>refseq    <span class=\"token operator\">|</span>protAcc   <span class=\"token operator\">|</span>description                                                                                                       <span class=\"token operator\">|</span>rfamAcc <span class=\"token operator\">|</span>tRnaName <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000619216.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>NR_106918 <span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>            <span class=\"token operator\">|</span>MIR6859<span class=\"token operator\">-</span><span class=\"token number\">1</span>   <span class=\"token operator\">|</span>NR_106918 <span class=\"token operator\">|</span>NR_106918 <span class=\"token operator\">|</span>Homo sapiens microRNA <span class=\"token number\">6859</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token punctuation\">(</span>MIR6859<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> microRNA. <span class=\"token punctuation\">(</span>from RefSeq NR_106918<span class=\"token punctuation\">)</span>                                       <span class=\"token operator\">|</span>        <span class=\"token operator\">|</span>         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000473358.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>            <span class=\"token operator\">|</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span> host gene <span class=\"token punctuation\">(</span>from HGNC MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG<span class=\"token punctuation\">)</span>                                                                       <span class=\"token operator\">|</span>        <span class=\"token operator\">|</span>         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000469289.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>            <span class=\"token operator\">|</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span> host gene <span class=\"token punctuation\">(</span>from HGNC MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG<span class=\"token punctuation\">)</span>                                                                       <span class=\"token operator\">|</span>        <span class=\"token operator\">|</span>         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000607096.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>NR_036051 <span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>            <span class=\"token operator\">|</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>   <span class=\"token operator\">|</span>NR_036051 <span class=\"token operator\">|</span>NR_036051 <span class=\"token operator\">|</span>Homo sapiens microRNA <span class=\"token number\">1302</span><span class=\"token operator\">-</span><span class=\"token number\">2</span> <span class=\"token punctuation\">(</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> microRNA. <span class=\"token punctuation\">(</span>from RefSeq NR_036051<span class=\"token punctuation\">)</span>                                       <span class=\"token operator\">|</span>        <span class=\"token operator\">|</span>         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000417324.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>NR_026818 <span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>            <span class=\"token operator\">|</span>FAM138A     <span class=\"token operator\">|</span>NR_026818 <span class=\"token operator\">|</span>NR_026818 <span class=\"token operator\">|</span>Homo sapiens family with sequence similarity <span class=\"token number\">138</span> member A <span class=\"token punctuation\">(</span>FAM138A<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> long non<span class=\"token operator\">-</span>coding RNA. <span class=\"token punctuation\">(</span>from RefSeq NR_026818<span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span>        <span class=\"token operator\">|</span>         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>ENST00000461467.<span class=\"token number\">1</span> <span class=\"token operator\">|</span>AY341950  <span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>            <span class=\"token operator\">|</span>FAM138A     <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>family with sequence similarity <span class=\"token number\">138</span> member A <span class=\"token punctuation\">(</span>from HGNC FAM138A<span class=\"token punctuation\">)</span>                                                  <span class=\"token operator\">|</span>        <span class=\"token operator\">|</span>         <span class=\"token operator\">|</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p>That's good enough, then I need to organise these 3 table togather with a R script, for long-term usage.</p>\n<blockquote>\n<p>Additionally, another very important table can be get from UCSC is <code class=\"language-text\">cpgIslandExt</code>, which listed all CpG Islands on genome. The schema is <a href=\"https://genome.ucsc.edu/cgi-bin/hgTables?hgta_doSchemaDb=hg38&#x26;hgta_doSchemaTable=cpgIslandExt\">here</a>.</p>\n</blockquote>\n<p>The pity thing here is, I always want to find a \"universal\" way to preprocess UCSC Table, like make it works across NCBI RefSeq, RefGene, GENCODE. etc, but sadly even from UCSC website, tables have different column, names .etc. Thus, my champ.GeneFeature() function looks can only deal with one of them carefully. So now I will upgrade champ.GeneFeature function as <code class=\"language-text\">knownGene</code>, <code class=\"language-text\">knownAttrs</code>, <code class=\"language-text\">kgXref</code>, and <code class=\"language-text\">cpgIslandExt</code>.</p>\n<h2>TxDb.Hsapiens.UCSC.hg38.knownGene</h2>\n<p>TxDb R annotation pacakge is also built on knownGene table from UCSC. <strong>However, I found that the last version was built last year, which means it's not very up-to-date,</strong> but still it's a pretty good annotation package.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">\"GenomicFeatures\"</span><span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span><span class=\"token string\">\"TxDb.Hsapiens.UCSC.hg38.knownGene\"</span><span class=\"token punctuation\">)</span>\n\ntxdb <span class=\"token operator\">&lt;-</span> TxDb.Hsapiens.UCSC.hg38.knownGene\nknitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>metadata<span class=\"token punctuation\">(</span>txdb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token operator\">|</span>name                                     <span class=\"token operator\">|</span>value                                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Db type                                  <span class=\"token operator\">|</span>TxDb                                         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Supporting package                       <span class=\"token operator\">|</span>GenomicFeatures                              <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Data source                              <span class=\"token operator\">|</span>UCSC                                         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Genome                                   <span class=\"token operator\">|</span>hg38                                         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Organism                                 <span class=\"token operator\">|</span>Homo sapiens                                 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Taxonomy ID                              <span class=\"token operator\">|</span><span class=\"token number\">9606</span>                                         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>UCSC Table                               <span class=\"token operator\">|</span>knownGene                                    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>UCSC Track                               <span class=\"token operator\">|</span>GENCODE V38                                  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Resource URL                             <span class=\"token operator\">|</span>http<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>genome.ucsc.edu<span class=\"token operator\">/</span>                      <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Type of Gene ID                          <span class=\"token operator\">|</span>Entrez Gene ID                               <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Full dataset                             <span class=\"token operator\">|</span>yes                                          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>miRBase build ID                         <span class=\"token operator\">|</span><span class=\"token keyword\">NA</span>                                           <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Nb of transcripts                        <span class=\"token operator\">|</span><span class=\"token number\">258145</span>                                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Db created by                            <span class=\"token operator\">|</span>GenomicFeatures package from Bioconductor    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>Creation time                            <span class=\"token operator\">|</span><span class=\"token number\">2021</span><span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token operator\">-</span><span class=\"token number\">19</span> <span class=\"token number\">10</span><span class=\"token operator\">:</span><span class=\"token number\">58</span><span class=\"token operator\">:</span><span class=\"token number\">00</span> <span class=\"token operator\">-</span><span class=\"token number\">0700</span> <span class=\"token punctuation\">(</span>Tue<span class=\"token punctuation\">,</span> <span class=\"token number\">19</span> Oct <span class=\"token number\">2021</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GenomicFeatures version at creation time <span class=\"token operator\">|</span><span class=\"token number\">1.45</span><span class=\"token number\">.2</span>                                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>RSQLite version at creation time         <span class=\"token operator\">|</span><span class=\"token number\">2.2</span><span class=\"token number\">.8</span>                                        <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>DBSCHEMAVERSION                          <span class=\"token operator\">|</span><span class=\"token number\">1.2</span>                                          <span class=\"token operator\">|</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p>Then below functions return transcrips from this annotation package:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">features <span class=\"token operator\">&lt;-</span> transcriptsBy<span class=\"token punctuation\">(</span>txdb<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># The result is grouped by genes, in other word, it returned transcripts in each gene.</span>\n<span class=\"token comment\"># BE CAREFUL, if unlist as below, gene informaiton is lost...</span>\nfeatures <span class=\"token operator\">&lt;-</span> unlist<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Here on important feature here is to get gene information (not transcript). To me, nowadays the words <code class=\"language-text\">gene</code> and <code class=\"language-text\">transcript</code> has been mix-used widely. Many times people say \"genome annotaiton\", actually they are doing \"transcriptom annotation\". TxDb provided a way to get gene information:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">genes <span class=\"token operator\">&lt;-</span> genes<span class=\"token punctuation\">(</span>txdb<span class=\"token punctuation\">)</span></code></pre></div>\n<p>It will only return genes (not transcripts), but I did not quite understand how he did that... And one thing I can't quite understand is there is only 217130 transcripts, and 29474 genes from above two functions. I suspect there is some filtering step in it... Another problem is inconsistency gene ID, with <code class=\"language-text\">transcriptsBy()</code> it use Ensembl (GENCODE) gene ID, but in <code class=\"language-text\">genes()</code> it use another gene ID...</p>\n<p>Additionally, if I want to get intron/exon/cds, I can use below code:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">intronList <span class=\"token operator\">&lt;-</span> intronsByTranscript<span class=\"token punctuation\">(</span>txdb<span class=\"token punctuation\">)</span>\nexonList <span class=\"token operator\">&lt;-</span> exonsBy<span class=\"token punctuation\">(</span>txdb<span class=\"token punctuation\">)</span>\ncdsBy<span class=\"token punctuation\">(</span>txdb<span class=\"token punctuation\">)</span>\nfiveUTRsByTranscript<span class=\"token punctuation\">(</span>txdb<span class=\"token punctuation\">)</span>\nthreeUTRsByTranscript<span class=\"token punctuation\">(</span>txdb<span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p>There is a function called <code class=\"language-text\">promoters()</code>, it's the same name as the function from \"GenomicRanges\", so I should be very careful when to use <code class=\"language-text\">promoters()</code> function.</p>\n</blockquote>\n<h2>Summary</h2>\n<p>In short, I will in the future merely (hopefully only) use knownGene for all Bioinformatic work. By coding my own script from UCSC Table enabls me to:</p>\n<ol>\n<li>Always get most updated knownGene table.</li>\n<li>Easy to modify, no restrictions from sealed/wrapped packages.</li>\n<li>Get transcript types, like protain-coding, pseudo .etc</li>\n<li>Get matched gene Id from Ensembl to NCBI RefSeq to Gene Symbol.</li>\n<li>I can write a general visualisation function based on my-created annotation format, for CpG/Peak visualisation.</li>\n</ol>\n<p>The limitations are:</p>\n<ol>\n<li>I need to code myself, and maintain the code if one day knownGene get updated.</li>\n<li>The knownGene table may get updated, which will cause reproducible problem. In this case, actually wgEncodeXXXXV39 have some advantage.</li>\n</ol>","frontmatter":{"date":"March 28, 2022","slug":"/notes/Access-to-hg38-knownGene-Genome-Annotation","title":"Access to hg38 knownGene Genome Annotation","tags":["annotation"],"abstract":"In my past post, I compared 5 different version of genome annotation, and seems knownGene is the best to use. It contains most transcripts, and update gradually with GENCODE. Here I record a bit how to fetch, organise, use knownGene."}}},"pageContext":{"slug":"/notes/Access-to-hg38-knownGene-Genome-Annotation"}},
    "staticQueryHashes": ["63159454"]}