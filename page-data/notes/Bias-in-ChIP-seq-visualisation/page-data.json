{"componentChunkName":"component---src-templates-note-template-js","path":"/notes/Bias-in-ChIP-seq-visualisation","result":{"data":{"markdownRemark":{"html":"<p>The things is I am working on some hMeDIP-seq data, which is a kind of ChIP-seq data but is designed to capture hydroxyMethylation signals. I have 3-4 phenotypes in it, so apparently I want to find a way to compare between these phenotypes.</p>\n<p>A troditional way for ChIP-seq analysis is firstly using Peak Calling software like MACS2, SICER for peak identification for <strong>each sample</strong>. Then these peaks in each sample will be merged into conensus peaks, which means a peak would appread in multiple samples, to increase the reliability, until this step, we actually still <strong>NOT</strong> have speicific intensity information for each peak in each sample, because different samples have different sequence depth, and maybe other bias. Finally, <strong>normalisation</strong> would be done by softwares like DiffBind, MAnorm2 .etc. In theory, after normalisation, we can do downstream analysis, like differential peak finding .etc.</p>\n<p>During my analysis, I am using <a href=\"https://github.com/tushiqi/MAnorm2\">MAnorm2</a> for normalisation, it works well and returned me normalised matrix for downstream analysis. <strong>However, when I was checking the IGV plot, it shows another way</strong>.</p>\n<h2>1. Mismatch between IGV plot and normalised result</h2>\n<p>Below is a subset of gene list I discovered that should have higher mean 5hmC value in NC and LT phenotype, but lower value in TC phenotype.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">|</span>                              <span class=\"token operator\">|</span> AllCount<span class=\"token operator\">|</span> NC.MeanValue<span class=\"token operator\">|</span> TC.MeanValue<span class=\"token operator\">|</span> LT.MeanValue<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span>\n<span class=\"token ellipsis\">...</span>\n<span class=\"token operator\">|</span>chr1<span class=\"token operator\">-</span>BTNL10                   <span class=\"token operator\">|</span>       <span class=\"token number\">24</span><span class=\"token operator\">|</span>    <span class=\"token number\">1.9539123</span><span class=\"token operator\">|</span>    <span class=\"token number\">1.1080244</span><span class=\"token operator\">|</span>    <span class=\"token number\">1.6104720</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr10<span class=\"token operator\">-</span>VIM                     <span class=\"token operator\">|</span>      <span class=\"token number\">153</span><span class=\"token operator\">|</span>    <span class=\"token number\">0.8124961</span><span class=\"token operator\">|</span>    <span class=\"token number\">0.5232620</span><span class=\"token operator\">|</span>    <span class=\"token number\">0.8462570</span><span class=\"token operator\">|</span>\n<span class=\"token ellipsis\">...</span></code></pre></div>\n<p>To visualise it, I merged all samples in each phenotype togather, then generated bigwig file with <code class=\"language-text\">bamCompare</code> software. The generated bigwig files were imported into IGV, in IGV I checked the status of these genes, however, the status is not as I expected.</p>\n<p>Below is BTNL10 gene's IGV plot:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bd7e89b4eb7e669ebd97e03a3fa8c123/be460/figure1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.599999999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABEElEQVQY0x2P4Y6CMBCEef/H8SWMib+8CFKseC2FVgSB0AKXmLmhPzadbr+d6Sal0hBSodIKShtcxS8yIfGT5rhmAkUhkaUZSilRGQOtNZRSscqyjPf7/Y78JiBEgeT7/aJuGtR1DescQR2hLLshz3MaFng8SrTWYBh6VJWJrKG5ECLqB8OerD0g2Qderxe895jnGdM48ZywbSuWZcE4jvjbAqTczT7kRoTg+ebjOQwDe4E6kJ2QHI9HpjlM04bPZyGwMiAweUbbBpr42D8cLE6nnnpF03g4F2CtR9+vNNrnFnqsSPbfGVNzuKNRR6hDmlqu62j25hotLhfLnuH6Duezpm5YLnI78373DOgY5PAP6lZxY9pizgYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"BTNL10_IGV\"\n        title=\"BTNL10_IGV\"\n        src=\"/static/bd7e89b4eb7e669ebd97e03a3fa8c123/00d43/figure1.png\"\n        srcset=\"/static/bd7e89b4eb7e669ebd97e03a3fa8c123/63868/figure1.png 250w,\n/static/bd7e89b4eb7e669ebd97e03a3fa8c123/0b533/figure1.png 500w,\n/static/bd7e89b4eb7e669ebd97e03a3fa8c123/00d43/figure1.png 1000w,\n/static/bd7e89b4eb7e669ebd97e03a3fa8c123/aa440/figure1.png 1500w,\n/static/bd7e89b4eb7e669ebd97e03a3fa8c123/be460/figure1.png 1645w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Below is VIM gene's IGV plot:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5b8f58aeedf4f8719a89c187d2f955cb/be460/figure2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.599999999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABEUlEQVQY0y2Q0XKDIBBF/f//yrSdzGTyEMegiCgRRdREUGwfMrdb7MMOC/fs7l2SqlHIhUItK8haIcsFhCghK7pXEnnBkd5S5DmDUgpSSpSlQF3XMYQ4+IILcF4ieb/fGIYBjSKAmvwBrdYwbYvRGAI5siyL0fdd1Bm7o2kaVMQzxuKQlviu65BwKui0wTStcM5h21aEsGFxC/x65Ovqse8B1r7wejl4H+J5vO+xzjkfI/n8+qAVOprksSzfeD53chzITYj5NO0xNybgfJ6J9bT+gtNpooY/5M5jnndyuCFNFyTWWtq9phUs/Ymhfxpwvxvcbj01mggcSRvxeAy4XtuoMWZwuWhoPaIohn/d0iCNX163cEsBcQNMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"VIM\"\n        title=\"VIM\"\n        src=\"/static/5b8f58aeedf4f8719a89c187d2f955cb/00d43/figure2.png\"\n        srcset=\"/static/5b8f58aeedf4f8719a89c187d2f955cb/63868/figure2.png 250w,\n/static/5b8f58aeedf4f8719a89c187d2f955cb/0b533/figure2.png 500w,\n/static/5b8f58aeedf4f8719a89c187d2f955cb/00d43/figure2.png 1000w,\n/static/5b8f58aeedf4f8719a89c187d2f955cb/aa440/figure2.png 1500w,\n/static/5b8f58aeedf4f8719a89c187d2f955cb/be460/figure2.png 1645w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>I can't see clear trend that NC/LT are higher than TC. I think the reaon is that IGV's normalisation is not good enough for visualisation.</p>\n<h2>2. Call peak without cutoff</h2>\n<p>Now the question is, how can I get correct Bigwig for visualisation? My idea is:</p>\n<h3>2.1. MACS2 for all peaks</h3>\n<p>MACS2 would defautly return only q value &#x3C;= 0.05 peaks. However, these peaks are only top-intensity peaks among all, if we only focus on them, a large fraction of lower-intensity peaks will be missed. Second reason is the bigwig format defatuly use 50 bp width, in other work, for a bigwig file, it cuts whole genome into 50 bp, then cound reads mapped on it. The bigwig could be seen as a \"summary\" of bam files, it is generated for IGV (or USCS) visaulisation. So if I set width of MACS2 as 50, the peak resolute I will get should be similar as troditional big-wig generation tools like <strong>bamCoverage</strong> or <strong>bamCompare</strong>.</p>\n<p>Below is my command for peak calling.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">macs2 callpeak --bw <span class=\"token number\">50</span> -t boundPath -c inputFile -f BAM -g <span class=\"token number\">3</span>.0e9 --outdir macs2_bin50 -n name -B -q <span class=\"token number\">1</span> <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span> macs2_bin50/name -macs2.log</code></pre></div>\n<p>After calling, I will got a series of huge .narrowPeak matrix for each sample.</p>\n<h3>2.2. MAnorm2 normalisation</h3>\n<p>After calling, it's time to load them all into a software for normalisation. In terms of this task, I prefer MAnorm2, though DiffBind also works in this case based on my test. MAnorm2 is not very easy to run, I detaily described it in <a href=\"https://yuantian1991.github.io/notes/MAnorm2-package-for-hMeDIP-seq-data\">another post</a>. In this case, some parameters should be set in param.bash profile:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">peaks</span><span class=\"token operator\">=</span><span class=\"token punctuation\">..</span>.\n<span class=\"token assign-left variable\">labs</span><span class=\"token operator\">=</span><span class=\"token punctuation\">..</span>.\n<span class=\"token assign-left variable\">n</span><span class=\"token operator\">=</span>SmallBin\n<span class=\"token assign-left variable\">summits</span><span class=\"token operator\">=</span><span class=\"token punctuation\">..</span>.\nkeep-dup<span class=\"token operator\">=</span><span class=\"token number\">1</span>\nfix-bin-size\ntypical-bin-size<span class=\"token operator\">=</span><span class=\"token number\">50</span></code></pre></div>\n<p>By setting like this, MAnorm2 will also take 50 bp as width for normalisation.</p>\n<h3>2.3. Convert normalised matrix into bigwig</h3>\n<p>After MAnorm2 normalisation, we can get a hudge matrix, in my case I got 39,065,425 Peaks. (By the way, if we use MACS2 q value 0.05 as cutoff, I only got 468,289 peaks, these are only high-intensity peaks, that's the reason I always want to keep all peaks, as those lower-intensity peaks also have value to be analyed). <strong>Here comes the important part: How to convert normalised scores back to bigwig file. Note that the scores provided by MAnorm2 are normalised read counts.</strong></p>\n<p>The matrix after normalisation looks like below:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> dim<span class=\"token punctuation\">(</span>M_SmallBin<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">39065425</span>       <span class=\"token number\">37</span>\n<span class=\"token operator\">></span> M_SmallBin<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span>\n  chrom start   end LT52_bnd.read_cnt LT53_bnd.read_cnt\n<span class=\"token number\">1</span>  chr1 <span class=\"token number\">10922</span> <span class=\"token number\">10972</span>        <span class=\"token operator\">-</span><span class=\"token number\">0.1829227</span>         <span class=\"token number\">0.1123974</span>\n<span class=\"token number\">2</span>  chr1 <span class=\"token number\">10972</span> <span class=\"token number\">11022</span>        <span class=\"token operator\">-</span><span class=\"token number\">0.1829227</span>         <span class=\"token number\">0.1123974</span>\n<span class=\"token number\">3</span>  chr1 <span class=\"token number\">11022</span> <span class=\"token number\">11072</span>        <span class=\"token operator\">-</span><span class=\"token number\">0.1829227</span>         <span class=\"token number\">0.1123974</span>\n<span class=\"token number\">4</span>  chr1 <span class=\"token number\">11072</span> <span class=\"token number\">11122</span>        <span class=\"token operator\">-</span><span class=\"token number\">0.1829227</span>         <span class=\"token number\">0.1123974</span>\n<span class=\"token number\">5</span>  chr1 <span class=\"token number\">11122</span> <span class=\"token number\">11172</span>        <span class=\"token operator\">-</span><span class=\"token number\">0.1829227</span>         <span class=\"token number\">0.1123974</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p>Firstly I merged all same phenotype into one column, by average the scores in each sample.</p>\n<ol>\n<li><strong>Write out score into bed files</strong></li>\n</ol>\n<p>Firstly, each pheno's 5hmC score was write out into a bed file. Note that chrom, start, end columns <strong>must</strong> be kept.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">write.table<span class=\"token punctuation\">(</span>Peaks<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"chrom\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"end\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NC.avgValue\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> file<span class=\"token operator\">=</span><span class=\"token string\">\"NC.bed\"</span><span class=\"token punctuation\">,</span> quote<span class=\"token operator\">=</span>F<span class=\"token punctuation\">,</span> col.names<span class=\"token operator\">=</span>F<span class=\"token punctuation\">,</span> row.names<span class=\"token operator\">=</span>F<span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ol start=\"2\">\n<li><strong>Sort bed files</strong></li>\n</ol>\n<p>Actually I don't know why we need to sort it... but I encountered problem in next step, which tells me the bed files need to be sorted. So this is the code. And also, I don't actually know the difference between bed and bedGraph. To me they are both txt files, not binary. So, actually you can name them whatever you want.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sort</span> -k1,1 -k2,2n NC.bed <span class=\"token operator\">></span> NC.bedGraph</code></pre></div>\n<ol start=\"3\">\n<li><strong>Convert bedgraph into bw</strong></li>\n</ol>\n<p>To finish this step, I found some software for help: <a href=\"https://anaconda.org/bioconda/ucsc-fetchchromsizes\">fetchchromsizes</a>, <a href=\"https://anaconda.org/bioconda/ucsc-bedclip\">bedclip</a>, and the main program we are going to use - <a href=\"https://anaconda.org/bioconda/ucsc-bedgraphtobigwig\">bedGraphToBigWig</a>. I installed them with conda, and encountered some problems indeed, eventualy solved with the help of <a href=\"https://www.biostars.org/p/432589/\">this post</a>. After installation, below three commands are to be used to convert the bed (or bedGraph) files into bigwig:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">## Creaeted hg38 referenece.</span>\nfetchChromSizes hg38 <span class=\"token operator\">></span> hg38.chrom.sizes\n\n<span class=\"token comment\">## Clip (remove) peaks outside of above reference range.</span>\nbedClip NC.bedGraph hg38.chrom.sizes NC_cliped.bedGraph\n\n<span class=\"token comment\">## Finally, convert the bedGraph file to bigwig, based on hg38 reference.</span>\nbedGraphToBigWig NC_cliped.bedGraph hg38.chrom.sizes NC.bw</code></pre></div>\n<h2>3. Adjusted IGV Plot</h2>\n<p>After above steps, use IGV to load these files into software, now the plot very much like the analysis results:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fed2b30f4d431326e2bee014ec044cc8/be460/figure3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.599999999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABHUlEQVQY0x2QSW7DMBAE9f/X5AcBchFycRbH0b5SpKzFkqjFNgIYlbEOA3Kmq5sYOlmpCJOSSpUUSuPHOUkSE/gBQRASRTHer0cmM11VKKUoy3KvLMv2Po6ffEgYRjiPxwNjakxtaNpWQLVDnu8TRhGRwGmaitYw2AmttfBmP5/6856kCbkwzwecSIZ917HOC/MwYseRZbZc7cwms7Htuf3dMQePLi6wErpa0a+beGamYdi5bVnFO+G4rktTGVbTYXPDolvm3jKWDVadGbOabbuTv7xRvR5YLgu2HoSRsPoiTMNy7pmFvU0LTitrGm3o6jOdBLfKcPySdX7lC/KKPNR8fhjyU0LyU/DuFpy+9V7Hg6JKNUPT0oq3qWv+AUJhb7SPtcRlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"BTNL10_IGV_adjusted\"\n        title=\"BTNL10_IGV_adjusted\"\n        src=\"/static/fed2b30f4d431326e2bee014ec044cc8/00d43/figure3.png\"\n        srcset=\"/static/fed2b30f4d431326e2bee014ec044cc8/63868/figure3.png 250w,\n/static/fed2b30f4d431326e2bee014ec044cc8/0b533/figure3.png 500w,\n/static/fed2b30f4d431326e2bee014ec044cc8/00d43/figure3.png 1000w,\n/static/fed2b30f4d431326e2bee014ec044cc8/aa440/figure3.png 1500w,\n/static/fed2b30f4d431326e2bee014ec044cc8/be460/figure3.png 1645w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/479160cbe01a8f87f333c2391ff99bc0/be460/figure4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.599999999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABI0lEQVQY0x2QzW7bMBCE9f4v1GtPbRoUcNPaUSKKIimJlEnaiiVTOjX4uvVhsD+Y2R1MZfqRphtwpsO6gbrp6DqNNUZgaRrF6XiS+s7Q94+d1hpnHc454QpfZqU0baupPv9+ElOi9yO9tQ+CD4HoPTlGVNtS12+CmnNOdPKo0S2D8M3/XjVixBHOE2e5U7UiiD5wbSy3+YOtFPZtY1kWSrmz3e/c15V934m1Zh4nZuXIylL2jSKaW75wdZ6LGam+/3hi0j3x+ZWSb+xLYU03ynVlm1cWnyhpZg0Z9+WJ9Evhv/1h/Hpg+1jJJ8PqM5ffinx4p8o507WWIDkOLuCHRH0MHF88MSRxHx+YxMHbzwZzlFwPhvbFMA0R8+oYzUTUFi/4ByT8bf0m1kVmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"VIM_IGV_adjusted\"\n        title=\"VIM_IGV_adjusted\"\n        src=\"/static/479160cbe01a8f87f333c2391ff99bc0/00d43/figure4.png\"\n        srcset=\"/static/479160cbe01a8f87f333c2391ff99bc0/63868/figure4.png 250w,\n/static/479160cbe01a8f87f333c2391ff99bc0/0b533/figure4.png 500w,\n/static/479160cbe01a8f87f333c2391ff99bc0/00d43/figure4.png 1000w,\n/static/479160cbe01a8f87f333c2391ff99bc0/aa440/figure4.png 1500w,\n/static/479160cbe01a8f87f333c2391ff99bc0/be460/figure4.png 1645w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>I suspect other softwares also work, like DiffBind, but I did not try. The bigwig file eventually shows the log2(readcount) from MAnorm2, but importantly the trend (height) is comparable in IGV plot.</p>","frontmatter":{"date":"August 24, 2021","slug":"/notes/Bias-in-ChIP-seq-visualisation","title":"Bias in ChIP-seq visualisation","tags":["ChIP-seq","IGV","MAnorm2"],"abstract":"Recently I am working on some ChIP-seq data. However, after normalisation, I noticed some of my result is not in accord with the IGV visualisation. I find a way to do adjustment for normalised plot, and it works well."}}},"pageContext":{"slug":"/notes/Bias-in-ChIP-seq-visualisation"}}}