{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Nanopore-Analysis:-Handle-Fast5-File",
    "result": {"data":{"markdownRemark":{"html":"<p>Fast5 data seems important, as it contains raw signals, and eventually I think we need it for methylation or hydroxy-methylation calling. But it’s better to firstly understand the structure of fas5 file a bit, before blindly running software on it.</p>\n<p>According to <a href=\"https://denbi-nanopore-training-course.readthedocs.io/en/latest/basecalling/inspect_h5.html\">here</a>. “The raw signals in Nanopore sequencing are stored in HDF5 format. HDF stands for “Hierarchical Data Format”, this is some data structure I had experience with when I was using Hadoop and Spark.</p>\n<h2>Check Groups in fast5</h2>\n<p>It’s quite easy to install HDF5 tool according <a href=\"https://zoomadmin.com/HowToInstall/UbuntuPackage/hdf5-tools\">here</a>. Below command could list the structure of fa fast5 file.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">h5ls <span class=\"token parameter variable\">-r</span> ./S01_subFast5/PAD69014_dc2ac203adf3e034d363fe1208fc805805ace1f5_0.fast5 <span class=\"token operator\">|</span> <span class=\"token function\">less</span></code></pre></div>\n<p>Looks like there are <code class=\"language-text\">Groups</code> in one fast5 file, and each group contains information like Analyses, Raw, channel_id .etc</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/                        Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97 Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses/Basecall_1D_000 Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses/Basecall_1D_000/BaseCalled_template Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses/Basecall_1D_000/BaseCalled_template/Fastq Dataset <span class=\"token punctuation\">{</span>SCALAR<span class=\"token punctuation\">}</span>\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses/Basecall_1D_000/Summary Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses/Basecall_1D_000/Summary/basecall_1d_template Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses/Segmentation_000 Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses/Segmentation_000/Summary Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Analyses/Segmentation_000/Summary/segmentation Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Raw Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Raw/Signal Dataset <span class=\"token punctuation\">{</span><span class=\"token number\">19251</span>/Inf<span class=\"token punctuation\">}</span>\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/channel_id Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/context_tags Group\n/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/tracking_id Group\n/read_000d5bae-8b68-44d6-8306-9565846de423 Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses/Basecall_1D_000 Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses/Basecall_1D_000/BaseCalled_template Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses/Basecall_1D_000/BaseCalled_template/Fastq Dataset <span class=\"token punctuation\">{</span>SCALAR<span class=\"token punctuation\">}</span>\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses/Basecall_1D_000/Summary Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses/Basecall_1D_000/Summary/basecall_1d_template Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses/Segmentation_000 Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses/Segmentation_000/Summary Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Analyses/Segmentation_000/Summary/segmentation Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Raw Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/Raw/Signal Dataset <span class=\"token punctuation\">{</span><span class=\"token number\">33739</span>/Inf<span class=\"token punctuation\">}</span>\n/read_000d5bae-8b68-44d6-8306-9565846de423/channel_id Group\n/read_000d5bae-8b68-44d6-8306-9565846de423/context_tags Group, same as /read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/context_tags\n/read_000d5bae-8b68-44d6-8306-9565846de423/tracking_id Group, same as /read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/tracking_id\n/read_0012399f-1f0b-436a-a818-e93951a3032a Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses/Basecall_1D_000 Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses/Basecall_1D_000/BaseCalled_template Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses/Basecall_1D_000/BaseCalled_template/Fastq Dataset <span class=\"token punctuation\">{</span>SCALAR<span class=\"token punctuation\">}</span>\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses/Basecall_1D_000/Summary Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses/Basecall_1D_000/Summary/basecall_1d_template Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses/Segmentation_000 Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses/Segmentation_000/Summary Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Analyses/Segmentation_000/Summary/segmentation Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Raw Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/Raw/Signal Dataset <span class=\"token punctuation\">{</span><span class=\"token number\">10812</span>/Inf<span class=\"token punctuation\">}</span>\n/read_0012399f-1f0b-436a-a818-e93951a3032a/channel_id Group\n/read_0012399f-1f0b-436a-a818-e93951a3032a/context_tags Group, same as /read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/context_tags\n/read_0012399f-1f0b-436a-a818-e93951a3032a/tracking_id Group, same as /read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/tracking_id\n/read_001b0e65-8d52-44df-a9ee-28778ec718f9 Group\n/read_001b0e65-8d52-44df-a9ee-28778ec718f9/Analyses Group\n/read_001b0e65-8d52-44df-a9ee-28778ec718f9/Analyses/Basecall_1D_000 Group</code></pre></div>\n<h2>View All Reads</h2>\n<p>Below command would list all reads contains in this fast5. In theory, I guess later these read number would be appear in converted fastq file.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">h5ls ./S01_subFast5/PAD69014_dc2ac203adf3e034d363fe1208fc805805ace1f5_0.fast5 | less\nread_000cecd0-55f8-4392-bb24-91e0d4bf0d97 Group\nread_000d5bae-8b68-44d6-8306-9565846de423 Group\nread_0012399f-1f0b-436a-a818-e93951a3032a Group\nread_001b0e65-8d52-44df-a9ee-28778ec718f9 Group\nread_001ce58b-5105-4e04-894a-80bb521487b9 Group\nread_00335fb1-408d-4c4f-b639-fcd149d055ff Group\nread_004c85e0-cae5-447f-9d2c-3b049653e998 Group\nread_004de239-d2a8-4788-abe8-0ec03d35e90b Group\nread_004f65c6-9be1-44c5-a2de-07ce21aee666 Group\nread_007fc14d-96a0-4536-83ac-5f0af0629d21 Group\n</code></pre></div>\n<p>To check totally how many reads, we can do:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">h5ls ./S01_subFast5/* <span class=\"token operator\">|</span> <span class=\"token function\">wc</span> <span class=\"token parameter variable\">-l</span></code></pre></div>\n<h2>View one Reads’ Signal</h2>\n<p>By using below command, we can have a look at more detail structure of each group like:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">h5dump <span class=\"token parameter variable\">-g</span> <span class=\"token string\">\"/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Raw\"</span> ./S01_subFast5/PAD69014_dc2ac203adf3e034d363fe1208fc805805ace1f5_0.fast5 <span class=\"token operator\">|</span> <span class=\"token function\">less</span>\n\nHDF5 <span class=\"token string\">\"./S01_subFast5/PAD69014_dc2ac203adf3e034d363fe1208fc805805ace1f5_0.fast5\"</span> <span class=\"token punctuation\">{</span>\nGROUP <span class=\"token string\">\"/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Raw\"</span> <span class=\"token punctuation\">{</span>\n   ATTRIBUTE <span class=\"token string\">\"duration\"</span> <span class=\"token punctuation\">{</span>\n      DATATYPE  H5T_STD_U32LE\n      DATASPACE  SCALAR\n      DATA <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">19251</span>\n      <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n   ATTRIBUTE <span class=\"token string\">\"median_before\"</span> <span class=\"token punctuation\">{</span>\n      DATATYPE  H5T_IEEE_F64LE\n      DATASPACE  SCALAR\n      DATA <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">178.09</span>\n      <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n   ATTRIBUTE <span class=\"token string\">\"read_id\"</span> <span class=\"token punctuation\">{</span>\n      DATATYPE  H5T_STRING <span class=\"token punctuation\">{</span>\n         STRSIZE <span class=\"token number\">37</span><span class=\"token punctuation\">;</span>\n         STRPAD H5T_STR_NULLTERM<span class=\"token punctuation\">;</span>\n         CSET H5T_CSET_ASCII<span class=\"token punctuation\">;</span>\n         CTYPE H5T_C_S1<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      DATASPACE  SCALAR\n      DATA <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>: <span class=\"token string\">\"000cecd0-55f8-4392-bb24-91e0d4bf0d97\"</span>\n      <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n   ATTRIBUTE <span class=\"token string\">\"read_number\"</span> <span class=\"token punctuation\">{</span>\n      DATATYPE  H5T_STD_I32LE\n      DATASPACE  SCALAR\n      DATA <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">90</span>\n      <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n   ATTRIBUTE <span class=\"token string\">\"start_mux\"</span> <span class=\"token punctuation\">{</span>\n      DATATYPE  H5T_STD_U8LE\n      DATASPACE  SCALAR\n      DATA <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">4</span>\n      <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n   ATTRIBUTE <span class=\"token string\">\"start_time\"</span> <span class=\"token punctuation\">{</span>\n      DATATYPE  H5T_STD_U64LE\n      DATASPACE  SCALAR\n      DATA <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">423002</span>\n      <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\nDATASET <span class=\"token string\">\"Signal\"</span> <span class=\"token punctuation\">{</span>\n      DATATYPE  H5T_STD_I16LE\n      DATASPACE  SIMPLE <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">(</span> <span class=\"token number\">19251</span> <span class=\"token punctuation\">)</span> / <span class=\"token punctuation\">(</span> H5S_UNLIMITED <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n      DATA <span class=\"token punctuation\">{</span>\n      <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">475</span>, <span class=\"token number\">426</span>, <span class=\"token number\">416</span>, <span class=\"token number\">415</span>, <span class=\"token number\">418</span>, <span class=\"token number\">418</span>, <span class=\"token number\">421</span>, <span class=\"token number\">410</span>, <span class=\"token number\">412</span>, <span class=\"token number\">415</span>, <span class=\"token number\">419</span>, <span class=\"token number\">417</span>, <span class=\"token number\">427</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">425</span>, <span class=\"token number\">431</span>, <span class=\"token number\">427</span>, <span class=\"token number\">424</span>, <span class=\"token number\">419</span>, <span class=\"token number\">415</span>, <span class=\"token number\">415</span>, <span class=\"token number\">418</span>, <span class=\"token number\">406</span>, <span class=\"token number\">411</span>, <span class=\"token number\">418</span>, <span class=\"token number\">406</span>, <span class=\"token number\">395</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">392</span>, <span class=\"token number\">396</span>, <span class=\"token number\">389</span>, <span class=\"token number\">393</span>, <span class=\"token number\">397</span>, <span class=\"token number\">404</span>, <span class=\"token number\">407</span>, <span class=\"token number\">406</span>, <span class=\"token number\">402</span>, <span class=\"token number\">395</span>, <span class=\"token number\">411</span>, <span class=\"token number\">416</span>, <span class=\"token number\">409</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">39</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">405</span>, <span class=\"token number\">398</span>, <span class=\"token number\">402</span>, <span class=\"token number\">402</span>, <span class=\"token number\">406</span>, <span class=\"token number\">406</span>, <span class=\"token number\">407</span>, <span class=\"token number\">391</span>, <span class=\"token number\">391</span>, <span class=\"token number\">404</span>, <span class=\"token number\">406</span>, <span class=\"token number\">399</span>, <span class=\"token number\">402</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">52</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">400</span>, <span class=\"token number\">404</span>, <span class=\"token number\">405</span>, <span class=\"token number\">407</span>, <span class=\"token number\">403</span>, <span class=\"token number\">402</span>, <span class=\"token number\">405</span>, <span class=\"token number\">406</span>, <span class=\"token number\">399</span>, <span class=\"token number\">411</span>, <span class=\"token number\">414</span>, <span class=\"token number\">405</span>, <span class=\"token number\">407</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">65</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">399</span>, <span class=\"token number\">403</span>, <span class=\"token number\">398</span>, <span class=\"token number\">411</span>, <span class=\"token number\">411</span>, <span class=\"token number\">410</span>, <span class=\"token number\">399</span>, <span class=\"token number\">401</span>, <span class=\"token number\">399</span>, <span class=\"token number\">406</span>, <span class=\"token number\">411</span>, <span class=\"token number\">402</span>, <span class=\"token number\">415</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">78</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">398</span>, <span class=\"token number\">399</span>, <span class=\"token number\">402</span>, <span class=\"token number\">411</span>, <span class=\"token number\">400</span>, <span class=\"token number\">412</span>, <span class=\"token number\">408</span>, <span class=\"token number\">401</span>, <span class=\"token number\">404</span>, <span class=\"token number\">409</span>, <span class=\"token number\">399</span>, <span class=\"token number\">408</span>, <span class=\"token number\">410</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">91</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">406</span>, <span class=\"token number\">409</span>, <span class=\"token number\">399</span>, <span class=\"token number\">411</span>, <span class=\"token number\">407</span>, <span class=\"token number\">407</span>, <span class=\"token number\">412</span>, <span class=\"token number\">409</span>, <span class=\"token number\">403</span>, <span class=\"token number\">404</span>, <span class=\"token number\">409</span>, <span class=\"token number\">407</span>, <span class=\"token number\">408</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">104</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">409</span>, <span class=\"token number\">401</span>, <span class=\"token number\">411</span>, <span class=\"token number\">411</span>, <span class=\"token number\">399</span>, <span class=\"token number\">403</span>, <span class=\"token number\">405</span>, <span class=\"token number\">407</span>, <span class=\"token number\">410</span>, <span class=\"token number\">399</span>, <span class=\"token number\">409</span>, <span class=\"token number\">402</span>, <span class=\"token number\">407</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">117</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">416</span>, <span class=\"token number\">407</span>, <span class=\"token number\">414</span>, <span class=\"token number\">412</span>, <span class=\"token number\">405</span>, <span class=\"token number\">409</span>, <span class=\"token number\">405</span>, <span class=\"token number\">410</span>, <span class=\"token number\">409</span>, <span class=\"token number\">412</span>, <span class=\"token number\">401</span>, <span class=\"token number\">412</span>, <span class=\"token number\">410</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">130</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">411</span>, <span class=\"token number\">414</span>, <span class=\"token number\">402</span>, <span class=\"token number\">407</span>, <span class=\"token number\">407</span>, <span class=\"token number\">411</span>, <span class=\"token number\">407</span>, <span class=\"token number\">398</span>, <span class=\"token number\">408</span>, <span class=\"token number\">405</span>, <span class=\"token number\">407</span>, <span class=\"token number\">408</span>, <span class=\"token number\">411</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">143</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">412</span>, <span class=\"token number\">414</span>, <span class=\"token number\">403</span>, <span class=\"token number\">410</span>, <span class=\"token number\">404</span>, <span class=\"token number\">399</span>, <span class=\"token number\">408</span>, <span class=\"token number\">411</span>, <span class=\"token number\">408</span>, <span class=\"token number\">411</span>, <span class=\"token number\">406</span>, <span class=\"token number\">407</span>, <span class=\"token number\">401</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">156</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">406</span>, <span class=\"token number\">410</span>, <span class=\"token number\">410</span>, <span class=\"token number\">411</span>, <span class=\"token number\">403</span>, <span class=\"token number\">410</span>, <span class=\"token number\">405</span>, <span class=\"token number\">412</span>, <span class=\"token number\">406</span>, <span class=\"token number\">407</span>, <span class=\"token number\">408</span>, <span class=\"token number\">405</span>, <span class=\"token number\">408</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">169</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">411</span>, <span class=\"token number\">407</span>, <span class=\"token number\">403</span>, <span class=\"token number\">405</span>, <span class=\"token number\">402</span>, <span class=\"token number\">413</span>, <span class=\"token number\">410</span>, <span class=\"token number\">409</span>, <span class=\"token number\">412</span>, <span class=\"token number\">407</span>, <span class=\"token number\">403</span>, <span class=\"token number\">404</span>, <span class=\"token number\">413</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">182</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">419</span>, <span class=\"token number\">410</span>, <span class=\"token number\">397</span>, <span class=\"token number\">405</span>, <span class=\"token number\">411</span>, <span class=\"token number\">411</span>, <span class=\"token number\">405</span>, <span class=\"token number\">406</span>, <span class=\"token number\">402</span>, <span class=\"token number\">408</span>, <span class=\"token number\">415</span>, <span class=\"token number\">416</span>, <span class=\"token number\">415</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">195</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">396</span>, <span class=\"token number\">411</span>, <span class=\"token number\">412</span>, <span class=\"token number\">407</span>, <span class=\"token number\">410</span>, <span class=\"token number\">408</span>, <span class=\"token number\">401</span>, <span class=\"token number\">406</span>, <span class=\"token number\">405</span>, <span class=\"token number\">410</span>, <span class=\"token number\">417</span>, <span class=\"token number\">408</span>, <span class=\"token number\">398</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">208</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">411</span>, <span class=\"token number\">409</span>, <span class=\"token number\">401</span>, <span class=\"token number\">411</span>, <span class=\"token number\">409</span>, <span class=\"token number\">412</span>, <span class=\"token number\">403</span>, <span class=\"token number\">407</span>, <span class=\"token number\">407</span>, <span class=\"token number\">409</span>, <span class=\"token number\">412</span>, <span class=\"token number\">410</span>, <span class=\"token number\">411</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">221</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">411</span>, <span class=\"token number\">401</span>, <span class=\"token number\">402</span>, <span class=\"token number\">405</span>, <span class=\"token number\">412</span>, <span class=\"token number\">407</span>, <span class=\"token number\">401</span>, <span class=\"token number\">410</span>, <span class=\"token number\">413</span>, <span class=\"token number\">408</span>, <span class=\"token number\">409</span>, <span class=\"token number\">407</span>, <span class=\"token number\">392</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">234</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">409</span>, <span class=\"token number\">405</span>, <span class=\"token number\">400</span>, <span class=\"token number\">405</span>, <span class=\"token number\">415</span>, <span class=\"token number\">408</span>, <span class=\"token number\">400</span>, <span class=\"token number\">405</span>, <span class=\"token number\">409</span>, <span class=\"token number\">415</span>, <span class=\"token number\">410</span>, <span class=\"token number\">399</span>, <span class=\"token number\">406</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">247</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">399</span>, <span class=\"token number\">412</span>, <span class=\"token number\">414</span>, <span class=\"token number\">401</span>, <span class=\"token number\">411</span>, <span class=\"token number\">412</span>, <span class=\"token number\">406</span>, <span class=\"token number\">413</span>, <span class=\"token number\">400</span>, <span class=\"token number\">403</span>, <span class=\"token number\">408</span>, <span class=\"token number\">410</span>, <span class=\"token number\">396</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">260</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">409</span>, <span class=\"token number\">409</span>, <span class=\"token number\">414</span>, <span class=\"token number\">412</span>, <span class=\"token number\">401</span>, <span class=\"token number\">400</span>, <span class=\"token number\">406</span>, <span class=\"token number\">413</span>, <span class=\"token number\">413</span>, <span class=\"token number\">406</span>, <span class=\"token number\">401</span>, <span class=\"token number\">411</span>, <span class=\"token number\">414</span>,\n      <span class=\"token punctuation\">(</span><span class=\"token number\">273</span><span class=\"token punctuation\">)</span>: <span class=\"token number\">402</span>, <span class=\"token number\">408</span>, <span class=\"token number\">401</span>, <span class=\"token number\">406</span>, <span class=\"token number\">413</span>, <span class=\"token number\">407</span>, <span class=\"token number\">406</span>, <span class=\"token number\">397</span>, <span class=\"token number\">406</span>, <span class=\"token number\">409</span>, <span class=\"token number\">405</span>, <span class=\"token number\">406</span>, <span class=\"token number\">403</span>,\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n<p>So this is one of the raw data group, or can be seen as a “folder”. It shows that <code class=\"language-text\">000cecd0-55f8-4392-bb24-91e0d4bf0d97</code> is a ”read_id”.</p>\n<p>Another solution to check raw signal is here:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">h5ls <span class=\"token parameter variable\">-d</span> ./S01_subFast5/PAD69014_dc2ac203adf3e034d363fe1208fc805805ace1f5_0.fast5/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/Raw</code></pre></div>\n<p>According to <a href=\"https://medium.com/@shiansu/a-look-at-the-nanopore-fast5-format-f711999e2ff6#id_token=eyJhbGciOiJSUzI1NiIsImtpZCI6ImNlYzEzZGViZjRiOTY0Nzk2ODM3MzYyMDUwODI0NjZjMTQ3OTdiZDAiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJuYmYiOjE2NDkwODY4NTUsImF1ZCI6IjIxNjI5NjAzNTgzNC1rMWs2cWUwNjBzMnRwMmEyamFtNGxqZGNtczAwc3R0Zy5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjExMTQ4NDQ1NjUyMzUzNDk0MjE3MSIsImVtYWlsIjoidGlhbnl1YW4xOTkxaGl0QGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhenAiOiIyMTYyOTYwMzU4MzQtazFrNnFlMDYwczJ0cDJhMmphbTRsamRjbXMwMHN0dGcuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJuYW1lIjoiWXVhbiBUaWFuIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hLS9BT2gxNEdoeGpyVTNRWHYyXzFNc0xySkNnZkZRY2xLTFYtS2VrM2w5TWVyVl9RPXM5Ni1jIiwiZ2l2ZW5fbmFtZSI6Ill1YW4iLCJmYW1pbHlfbmFtZSI6IlRpYW4iLCJpYXQiOjE2NDkwODcxNTUsImV4cCI6MTY0OTA5MDc1NSwianRpIjoiZjg5MjViMmI3NTg5YjJmNzMyNmRlZWFiYTdkZTM0OWFiNzc3Y2JjOCJ9.T07BQUI6DNC7egXsbk880IfYHUn2_pF4iyXpCPlBrMuo8VBPjZqcxONB1lzWhAgLf8cgvuaRCvSsVJvH0yfMeAK_phcYXgNOgvWi6r20zv2YmQ0lIvlLll8mKP2fxvpO_OS1l_WQGFOy0EvJ31Ma9VyVhlsGw2VWHzLRKYMYpj8aZW8j3hBQAa0nW_eNr4cOC0C9sdGZos0ShmhjSBCItryrSs3_VlIGVQAvmKu2-JnpyOtsfVQuxInr1gmGC4wF-1mN_suIwJ4Zho452ThcoCEAGhkroGpQZ-kplpN6VUhhjARjOMpmcA3TkzycRrG5xCR1NY95WGieOIaRbxRZVQ\">this post</a> author, he discovered the equation for raw pA calculation is <a href=\"https://github.com/nanoporetech/ont_fast5_api/blob/4d5691645ce2d5e326f6dfa7ef28bc4c3b9bc903/ont_fast5_api/fast5_file.py#L691\">here</a>.</p>\n<p>“The signals are orignally measured as pA (picoamps) values and stored as 16-bit integer values. To transform back into the original pA values requires offset and scaling, I discovered the transformation in the source code of ONT’s fast5 API:</p>\n<p><code class=\"language-text\">pA_val</code> = <code class=\"language-text\">scale</code> * (<code class=\"language-text\">raw</code> + <code class=\"language-text\">offset</code>)</p>\n<p>Where raw is the 16-bit values stored inside Raw/Read_####/Signal and scale is calculated as range/digitisation. range, digitisation and offset can be found in the Attributes of <code class=\"language-text\">/channel_id.</code>”, which can be checked via:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">h5dump <span class=\"token parameter variable\">-A</span> <span class=\"token parameter variable\">-g</span> <span class=\"token string\">\"/read_000cecd0-55f8-4392-bb24-91e0d4bf0d97/channel_id\"</span> ./S01_subFast5/PAD69014_dc2ac203adf3e034d363fe1208fc805805ace1f5_0.fast5 <span class=\"token operator\">|</span> <span class=\"token function\">less</span></code></pre></div>\n<h2>Summary</h2>\n<p>Above is really amazing detail work, I guess I don’t need to touch base to this level deep, but it’s still a good idea later to <strong>compared the reads_ID, signal intensity and BaseCalled fastq</strong> file a bit.</p>\n<p>Another important thing is that seems methylation signal MUST be driven from fast5 file. So does it means I can’t ask Nanopore Machine to directly export fastq format file? In other word, the vital signal for methylation and 5hmC is hidden exactly in these signals. <strong>It’s vital to know how exactly they match</strong>.</p>","frontmatter":{"date":"April 05, 2022","slug":"/notes/Nanopore-Analysis:-Handle-Fast5-File","title":"Nanopore Analysis: Handle Fast5 File","tags":["nanopore","alignment"],"abstract":"Recently I am working on Nanopore data, firstly I am trying to set up the pipeline for 5hmC/5mC and SNP calling. In this post, I record my first exploration of fast5 data, which is the default output format for Nanpore machines."}}},"pageContext":{"slug":"/notes/Nanopore-Analysis:-Handle-Fast5-File"}},
    "staticQueryHashes": ["63159454"]}