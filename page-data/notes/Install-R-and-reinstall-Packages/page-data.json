{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Install-R-and-reinstall-Packages",
    "result": {"data":{"markdownRemark":{"html":"<p>So, now the R 4.0.2 is coming... I need to update it on the server, and reinstall all packages on it. Then I can finally start working.</p>\n<h2>R 4.0.2 Installation</h2>\n<p>After download and <code class=\"language-text\">tar zxvf</code>, it's the key step: <strong>Configuration</strong>, there are so so many parameters in it. In theory just <code class=\"language-text\">./configure</code> should work, but in practic, it's never works on my side, not even once...There are always some missing libraries, some missing libs, and even after everything is done, you can find your R can not open web browser, can not generate HTML .etc... A lot of problems.</p>\n<p>Firstly, I tried...</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./configure <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/Data/Tian/Software/install/R_4.0.2 --exec-prefix<span class=\"token operator\">=</span>/Data/Tian/Software/install/R_4.0.2 --enable-R-shlib</code></pre></div>\n<p>As expected, not working. The error is:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">configure: error: libcurl <span class=\"token operator\">>=</span> <span class=\"token number\">7.28</span>.0 library and headers are required with support <span class=\"token keyword\">for</span> https</code></pre></div>\n<p>After searching across the website, the way seems is to install <code class=\"language-text\">curl</code> library in a folder, then tell R to find it there...</p>\n<p>Firstly I created a folder <code class=\"language-text\">mylib</code> beside the current folder, then enter it, try install latest curl directly.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Install curl in my local folder, which should requires no sudo authority</span>\n\n<span class=\"token function\">wget</span> https://curl.haxx.se/download/curl-7.72.0.tar.gz\n<span class=\"token function\">tar</span> zxvf curl-7.72.0.tar.gz\n<span class=\"token function\">mkdir</span> mycurl\n<span class=\"token builtin class-name\">cd</span> curl-7.72.0\n./configure  <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/Data/Tian/Software/mylib/mycurl\n<span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></code></pre></div>\n<p>After a while, I can see the <code class=\"language-text\">curl</code> has been installed into <code class=\"language-text\">mycurl</code> folder:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(base) regmtyu@SLMSICANBECK01:/Data/Tian/Software/mylib/mycurl$ ls\nbin  include  lib  share</code></pre></div>\n<p>Then, let me retry the command, add the curl path at the end:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">./configure <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/Data/Tian/Software/install/R_4.0.2 <span class=\"token punctuation\">\\</span>\n            --exec-prefix<span class=\"token operator\">=</span>/Data/Tian/Software/install/R_4.0.2 <span class=\"token punctuation\">\\</span>\n            --enable-R-shlib <span class=\"token punctuation\">\\</span>\n            <span class=\"token assign-left variable\">LDFLAGS</span><span class=\"token operator\">=</span><span class=\"token string\">\"-L/Data/Tian/Software/mylib/mycurl/lib\"</span> <span class=\"token punctuation\">\\</span>\n            <span class=\"token assign-left variable\">CPPFLAGS</span><span class=\"token operator\">=</span><span class=\"token string\">\"-I/Data/Tian/Software/mylib/mycurl/include\"</span></code></pre></div>\n<p>Then it works. If I miss more other library, I can continue to add them to the folder and the path. Now, I can <code class=\"language-text\">make &amp;&amp; make install</code> to finish the installation.</p>\n<p>Then modify the R/Rscript in my bin folder, make them my default choice.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># in /Data/Tian/Software/bin folder</span>\n\n<span class=\"token function\">rm</span> R\n<span class=\"token function\">rm</span> Rscript\n<span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> <span class=\"token punctuation\">..</span>/install/R_4.0.2/bin/R\n<span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> <span class=\"token punctuation\">..</span>/install/R_4.0.2/bin/Rscript</code></pre></div>\n<p>Finally, in my home directory, create a file called <code class=\"language-text\">.Renviron</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">TMP = \"/Data/Tian/myTMP\"\nR_LIBS_USER=/Data/Tian/Software/install/R_4.0.2/lib64/R/library</code></pre></div>\n<p>The first line indicates if R is about to create some tmp, where should it download it. <strong>The second line indicates where to install packages</strong>. I don't want to put everything in my Home Directory.</p>\n<h2>Install Packages</h2>\n<p>Then, I think I need a script to install all packages. So the steps are simply: 1, get package names from old installed R, 2, install in new R.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>requireNamespace<span class=\"token punctuation\">(</span><span class=\"token string\">\"BiocManager\"</span><span class=\"token punctuation\">,</span> quietly <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    install.packages<span class=\"token punctuation\">(</span><span class=\"token string\">\"BiocManager\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># below is the key code</span>\ninstallList <span class=\"token operator\">&lt;-</span> setdiff<span class=\"token punctuation\">(</span>dir<span class=\"token punctuation\">(</span><span class=\"token string\">\"/Data/Tian/Software/install/R_3.6.0/lib64/R/library\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dir<span class=\"token punctuation\">(</span><span class=\"token string\">\"/Data/Tian/Software/install/R_4.0.2//lib64/R/library\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nBiocManager<span class=\"token operator\">::</span>install<span class=\"token punctuation\">(</span>installList<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Then I want to go to sleep, just leave it running...</p>","frontmatter":{"date":"August 19, 2020","slug":"/notes/Install-R-and-reinstall-Packages","title":"Install R and reinstall Packages","tags":["R"],"abstract":"It is absolute a nightmare to install R, and R package. Nor to say in this world there are some packages as horrible as my ChAMP... Every year basically I need to install a newer version R, and reinstall packages..."}}},"pageContext":{"slug":"/notes/Install-R-and-reinstall-Packages"}},
    "staticQueryHashes": ["63159454"]}