{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Read-count-and-initial-quality-check-plots-on-BAM-files",
    "result": {"data":{"markdownRemark":{"html":"<p>The thing starts as I have a set of BAM files, some of them are low quality samples. So I want to have a quick quality check on them. Apart from troditional <code class=\"language-text\">fastQC</code> or <code class=\"language-text\">fastp</code> way, plots like <code class=\"language-text\">MDS</code>, <code class=\"language-text\">PCA</code>, <code class=\"language-text\">tSNE</code>, <code class=\"language-text\">Heatmap</code>, <code class=\"language-text\">Dendrogram</code> are quite useful for quality check. <strong>However, one vital problem is, normally we need a matrix data to plot above plots, so eventually I get this question: How to get a \"value\" matrix from a set of BAM files?</strong></p>\n<p>After searching online, I think one answer close to my requirement is <a href=\"https://deeptools.readthedocs.io/en/develop/content/tools/multiBamSummary.html#:~:text=multiBamSummary%20computes%20the%20read%20coverages,the%20BED%2Dfile%20mode%20instead.\">multiBamSummary</a> from deepTool. It computes the read coverages for genomic regions for typically two or more BAM files. In other words, it will count reads for all bam files into small region bins, and return a matrix-similar result, with rows as bins and columns as each sample (bam file). Note that deepTool actually provided another function <a href=\"https://deeptools.readthedocs.io/en/develop/content/tools/plotPCA.html\">plotPCA</a> as downstream function of <code class=\"language-text\">multiBamSummary</code>, it could generate a PCA plot based on the result fo multiBamSummary. However, I perfer to create wheel myself, as a matrix would alow me to do more things, but a PCA PNG plot can't help me much.</p>\n<p>So the solution is firstly get readCount matrix from multiBamSummary, then try plot some quality check plot based on the result.</p>\n<h2>Get Read Count matrix from multiBamSummary</h2>\n<p>The code is below works nicely, <strong>remember that BAM files MUST be indexed</strong>. My <a href=\"https://yuantian1991.github.io/notes/My-Samtools-Command\">this post</a> suggested a quick way to do sorting and indexing parallelly.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">multiBamSummary bins --bamfiles ./myBam/* -o results.npz -bl ./myMergedGreyList.bed -p <span class=\"token number\">30</span> --outRawCounts readCounts.tab</code></pre></div>\n<p>There are many parameters for multiBamSummary, above are some key I will use:</p>\n<ul>\n<li><strong>--bamfiles</strong>: indicates location of bam files. For example in above code, I directly specified all bam files in one folder</li>\n<li><strong>-o</strong>: output of default result results.npz, which is a compressed numpy array (.npz), I guess it's useful for python numpy users.</li>\n<li><strong>-bl</strong>: a blacklist bed file for removing. If you have you can specify it. But actually think normally black list only count for a very small fraction across genome. It should not make much differece for PCA/Heatmap .etc. Normally I think I don't need this parameter, because I normally do GreyList filtering myself with <code class=\"language-text\">GreyListChIP</code> and <code class=\"language-text\">bedtools intersect</code>.</li>\n<li><strong>-p</strong>: parallel thread, luckily I have a good computational server...</li>\n<li><strong>--outRawCounts</strong>: This is returned readCounts in txt format, convinient for people like me who don't use python.</li>\n</ul>\n<p>After running, we can have a look what the result looks like, below I read into the <code class=\"language-text\">readCounts.tab</code> file and printed the first 6 columns. Totally for my dataset, there are 46 columns.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> readCount <span class=\"token operator\">&lt;-</span> read.csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"./readCounts.tab\"</span><span class=\"token punctuation\">,</span> header<span class=\"token operator\">=</span><span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> stringsAsFactors<span class=\"token operator\">=</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">\"\\t\"</span> <span class=\"token punctuation\">,</span>quote<span class=\"token operator\">=</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>readCount<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">|</span>X.chr                <span class=\"token operator\">|</span> start<span class=\"token operator\">|</span>   end<span class=\"token operator\">|</span> LT49_bnd.grey_filtered.sorted.bam<span class=\"token operator\">|</span> LT51_bnd.grey_filtered.sorted.bam<span class=\"token operator\">|</span> LT51_Inp.grey_filtered.sorted.bam<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr19_KI270917v1_alt <span class=\"token operator\">|</span>     <span class=\"token number\">0</span><span class=\"token operator\">|</span> <span class=\"token number\">10000</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">1</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">2</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">4</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr19_KI270917v1_alt <span class=\"token operator\">|</span> <span class=\"token number\">10000</span><span class=\"token operator\">|</span> <span class=\"token number\">20000</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">1</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">0</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">1</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr19_KI270917v1_alt <span class=\"token operator\">|</span> <span class=\"token number\">20000</span><span class=\"token operator\">|</span> <span class=\"token number\">30000</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">2</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">2</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">2</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr19_KI270917v1_alt <span class=\"token operator\">|</span> <span class=\"token number\">30000</span><span class=\"token operator\">|</span> <span class=\"token number\">40000</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">0</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">2</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">1</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr19_KI270917v1_alt <span class=\"token operator\">|</span> <span class=\"token number\">40000</span><span class=\"token operator\">|</span> <span class=\"token number\">50000</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">0</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">1</span><span class=\"token operator\">|</span>                                 <span class=\"token number\">2</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">></span></code></pre></div>\n<h2>Plotly MDS plot</h2>\n<p>Now I want to visualise it with a MDS plot, it's plot to show clustering status between samples. Firstly I need to normalise it a bit, just like other data type, raw read count data varis a lot. So I use <code class=\"language-text\">edgeR</code> pacakge's <code class=\"language-text\">cpm</code> function to convert origin read count into count per million. Also it's better to remove row all 0, they will fail functions like PCA.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/267b7990844b81054553e0473b97e0cb/2093e/figure2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.800000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvUlEQVQoz4VSiw7DIAjs/39u11Qoj1tg6phJOxIiwfM4wM3dcedhqgoiAjNnPGxgIhduqjhIsJnZI2HcmxuYCQNranB0zCgsgvN4PROq9+pmoLNlnHd2hzdsq6JhSeaKS69UuNrAr++SMNvqztTQ9h3KDFGBiGSLFXPnwTUJxQQaBNQgfOWQU2kB//VU2OextuWfflLp3HguyL8F4hTJ/MDMpdSvUAlie0GiReWP4hLPGVZQPVNN+W93uCroDc2nyasuPfpvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MDSplot\"\n        title=\"MDSplot\"\n        src=\"/static/267b7990844b81054553e0473b97e0cb/00d43/figure2.png\"\n        srcset=\"/static/267b7990844b81054553e0473b97e0cb/63868/figure2.png 250w,\n/static/267b7990844b81054553e0473b97e0cb/0b533/figure2.png 500w,\n/static/267b7990844b81054553e0473b97e0cb/00d43/figure2.png 1000w,\n/static/267b7990844b81054553e0473b97e0cb/aa440/figure2.png 1500w,\n/static/267b7990844b81054553e0473b97e0cb/2093e/figure2.png 1858w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Full code:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\"># A script to calcualte PCA on bam files.</span>\n<span class=\"token comment\"># Author: Tian</span>\n\nreadCount <span class=\"token operator\">&lt;-</span> read.csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"./readCounts.tab\"</span><span class=\"token punctuation\">,</span> header<span class=\"token operator\">=</span><span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> stringsAsFactors<span class=\"token operator\">=</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">\"\\t\"</span> <span class=\"token punctuation\">,</span>quote<span class=\"token operator\">=</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">)</span>\n\nlibrary<span class=\"token punctuation\">(</span><span class=\"token string\">\"edgeR\"</span><span class=\"token punctuation\">)</span>\nCountMatrix <span class=\"token operator\">&lt;-</span> readCount<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token operator\">:</span>ncol<span class=\"token punctuation\">(</span>readCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\ncolnames<span class=\"token punctuation\">(</span>CountMatrix<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;-</span> sapply<span class=\"token punctuation\">(</span>colnames<span class=\"token punctuation\">(</span>CountMatrix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> strsplit<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> split<span class=\"token operator\">=</span><span class=\"token string\">\"[.]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nmyCPM <span class=\"token operator\">&lt;-</span> cpm<span class=\"token punctuation\">(</span>CountMatrix<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># Removed all 0 column here</span>\nmyCPM <span class=\"token operator\">&lt;-</span> myCPM<span class=\"token punctuation\">[</span>apply<span class=\"token punctuation\">(</span>myCPM<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> var<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">## ====== PCA Plot ======</span>\n\nTPM <span class=\"token operator\">&lt;-</span> cbind<span class=\"token punctuation\">(</span>as.data.frame<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">(</span>myCPM<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span>substr<span class=\"token punctuation\">(</span>colnames<span class=\"token punctuation\">(</span>myCPM<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nlibrary<span class=\"token punctuation\">(</span>ggfortify<span class=\"token punctuation\">)</span>\ndf <span class=\"token operator\">&lt;-</span> TPM<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>ncol<span class=\"token punctuation\">(</span>TPM<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\npca_res <span class=\"token operator\">&lt;-</span> prcomp<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> scale. <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span>\nautoplot<span class=\"token punctuation\">(</span>pca_res<span class=\"token punctuation\">,</span> data <span class=\"token operator\">=</span> TPM<span class=\"token punctuation\">,</span> colour <span class=\"token operator\">=</span> <span class=\"token string\">'label'</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> main<span class=\"token operator\">=</span><span class=\"token string\">\"PCA for all samples\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## ====== MDS Plot ======</span>\n\nlibrary<span class=\"token punctuation\">(</span>plotly<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>RColorBrewer<span class=\"token punctuation\">)</span>\n\npheno <span class=\"token operator\">&lt;-</span> substr<span class=\"token punctuation\">(</span>colnames<span class=\"token punctuation\">(</span>CountMatrix<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> \nbeta <span class=\"token operator\">&lt;-</span> as.matrix<span class=\"token punctuation\">(</span>myCPM<span class=\"token punctuation\">)</span>\n\no <span class=\"token operator\">&lt;-</span> order<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>matrixStats<span class=\"token operator\">::</span>rowVars<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">1000</span><span class=\"token punctuation\">]</span>\nd <span class=\"token operator\">&lt;-</span> dist<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">[</span>o<span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nfit <span class=\"token operator\">&lt;-</span> cmdscale<span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span>\ncol <span class=\"token operator\">&lt;-</span> brewer.pal<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Dark2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>as.factor<span class=\"token punctuation\">(</span>pheno<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\ncolor_number <span class=\"token operator\">&lt;-</span> nlevels<span class=\"token punctuation\">(</span>pheno<span class=\"token punctuation\">)</span>\n        pal <span class=\"token operator\">&lt;-</span> RColorBrewer<span class=\"token operator\">::</span>brewer.pal<span class=\"token punctuation\">(</span>color_number<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Set1\"</span><span class=\"token punctuation\">)</span>\n        data <span class=\"token operator\">&lt;-</span> data.frame<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>fit<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>y<span class=\"token operator\">=</span>fit<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>pheno<span class=\"token operator\">=</span>pheno<span class=\"token punctuation\">,</span>Sample_Name<span class=\"token operator\">=</span>colnames<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        p <span class=\"token operator\">&lt;-</span> plot_ly<span class=\"token punctuation\">(</span>data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">,</span> x <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>x<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>y<span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token operator\">~</span>Sample_Name<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>pheno<span class=\"token punctuation\">,</span>colors <span class=\"token operator\">=</span> <span class=\"token operator\">~</span>pal<span class=\"token punctuation\">,</span> type<span class=\"token operator\">=</span><span class=\"token string\">\"scatter\"</span><span class=\"token punctuation\">,</span> mode <span class=\"token operator\">=</span> <span class=\"token string\">\"markers\"</span><span class=\"token punctuation\">,</span> marker<span class=\"token operator\">=</span>list<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        m <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span>l <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>r <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>b <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>t <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>pad <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n        p <span class=\"token operator\">&lt;-</span> layout<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">'MDS 1000 most variable positions'</span><span class=\"token punctuation\">,</span>margin<span class=\"token operator\">=</span>m<span class=\"token punctuation\">)</span>\n\n</code></pre></div>","frontmatter":{"date":"March 14, 2021","slug":"/notes/Read-count-and-initial-quality-check-plots-on-BAM-files","title":"Read count and initial quality check plots on BAM files","tags":["R","MeDIP-seq","BAM","PCA"],"abstract":"I want to quickly check the quality of a set of BAM files, generated from bowtie2. However, I did not see many tools for it, eventually I found multiBamSummary is one solution out. Here I record a bit how I get read count matrix from a set of BAM files, then plot a quick plotly plot for visualisation."}}},"pageContext":{"slug":"/notes/Read-count-and-initial-quality-check-plots-on-BAM-files"}},
    "staticQueryHashes": ["63159454"]}