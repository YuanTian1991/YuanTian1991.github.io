{"componentChunkName":"component---src-templates-note-template-js","path":"/notes/R-Tip-My-ggplot2-Plots-Code","result":{"data":{"markdownRemark":{"html":"<p>I used to only use pure R code to draw plots, it's not bad, but ggplot2 indeed do much better than I do. But it's not very easy to remember code from ggplot2. So here I record a bit code I used. Or better, form them into functions or even a small personal use R visualisation package in the future.</p>\n<h3>Histogram</h3>\n<p>For example, histogram could be used to check p value quickly.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">'ggplot2'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#head(DEG$pvalue)</span>\n\n<span class=\"token comment\">#[1] 7.459678e-33 5.611091e-31 5.081911e-23 4.894006e-21 1.068582e-20</span>\n<span class=\"token comment\">#[6] 1.921252e-20</span>\n\nggplot<span class=\"token punctuation\">(</span>DEG<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>pvalue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> geom_histogram<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> theme_minimal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span><span class=\"token string\">\"p value histogram\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 652px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAByUlEQVQ4y61UuaoCQRDcbxQvvANFDDQ0FTQxFkz8BA0VFG9DRbwCTxAEQUw0EO+j3uuGWdeTt49tKLZnZ7a6q3ZmJPzGfr/HYrFgzGYzxvl8pincbjeoCelwOOB0OmG9XmO328kTRHS9XvkpoBx/mpNEJ+VyGcPhkPPL5fKwWA0kIalarWI8HnP+XF0VIcnVlJA8FISj0eiB8JuHz5A91Fyy+CmaER6PRyap1WpfJVP+l7G0Wq2YpFKpvBD+q0Pa0JoSKiUrPfyrxBfJ4qdks1kkEglVHSqPqXhK9DFFOp1GNBp9WERHUOBd19SMGNMB4Q6F5EKhAK/Xi8FgANrsopAyRCdCFfk+n885LxaL2G63d8JSqQSTyQS/349gMIhIJIJcLod6vY7JZIJ+v883Uq/XkwuQTcvlkvNkMonNZnOXTBXsdjs8Hg9cLhccDgdsNhssFgvcbjcCgQDC4TBCoRBisRgTxONxZDIZpFIp2S6J/KHI5/MwGAxM5nQ6GZQLcqvVygqoAK3T6/Uwm80wGo3Q6XTw+XyYTqf3Dqn1ZrOJTqeDdruNVqvFoJzQ7XZZLs1TThA5vW80GnzjS89GfwoyXHmjvwtS+wPj9M8UbimrTwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"P value Histogram\"\n        title=\"P value Histogram\"\n        src=\"/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png\"\n        srcset=\"/static/1f4f01f1614a299e4bd9a71f6932d750/772e8/fig1.png 200w,\n/static/1f4f01f1614a299e4bd9a71f6932d750/e17e5/fig1.png 400w,\n/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png 652w\"\n        sizes=\"(max-width: 652px) 100vw, 652px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>PCA plot</h3>\n<p>The <a href=\"https://cran.r-project.org/web/packages/ggfortify/vignettes/plot_pca.html\">ggfortify</a> is a easy to use and beautiful tool for PCA visualisation. However, it seems the origin data must be data.frame format.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggfortify<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># TPM must be a data frame.</span>\ndf <span class=\"token operator\">&lt;-</span> TPM<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>ncol<span class=\"token punctuation\">(</span>TPM<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\npca_res <span class=\"token operator\">&lt;-</span> prcomp<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> scale. <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span>\n\nautoplot<span class=\"token punctuation\">(</span>pca_res<span class=\"token punctuation\">,</span> data <span class=\"token operator\">=</span> TPM<span class=\"token punctuation\">,</span> colour <span class=\"token operator\">=</span> <span class=\"token string\">'Mutation'</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> main<span class=\"token operator\">=</span><span class=\"token string\">\"PCA for Transcripts Per Kilobase Million (TPM Matrix)\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 652px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB+klEQVQ4y51V227CMAzt///ZnniYNCHR9QJltNAmvZcKqHecJSy9wCYqGTdNcmIfHweH8Egpabvd0n6/J8/zlO12OwrDkFzfJw8WBAFFUUSu6yory5Jutxtdr1cahoFhlHf4Q9M0aoFtVVUpX4c+VdaYPVue5ySEUN9GgPzSti2laUpZls0tjsdjvY7B2BdFMQfsuu6+aGagYzTWkb0OaBuik5+b54D8wxz+CWYsiUeA+RSQi1LX9WyjnKR6H8ucpKYih2+42gAatP2mjHTUBiv1KQ1qzIXhA2DRKaUA3n4cBjv3PWX3COS/Ui+xLgTgGgdcLheqoRQVYXw80qVrKQv8nwqeTqMol4yji7WEOvDfACNisYM6J0J3dHVFYrclUZSUuxuS6Qmc5SP+bE4LvK+SI3k4vAdgAPAPdFOEbnO4IOezTnkpsimPOl2pOS1R5Rap9lxotOJch1MOeWx9YyAXkaX6MJYNGdlwUUaA4FD6HglwYoAkqJCHLzWnhAygVZLQW5yod6PD4WGnoHeFllBmhGwO0Gs4Sh8VFkudwsLm22PUq3YRzHgi8lLPv9zLUltmFefp5fCo9XgTAx3hY/1u5p8Cpqb1NIiJWCLlFpvWqOw7tFcBKLXux0VAwyN7vtZ7tCLrkz3fzAcUSopMyeOKeQ6AL+Wlv4Bvc/H30kl5204AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PCA plot\"\n        title=\"PCA plot\"\n        src=\"/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png\"\n        srcset=\"/static/49f688c674adf0d190c84c877f5b32ca/772e8/fig2.png 200w,\n/static/49f688c674adf0d190c84c877f5b32ca/e17e5/fig2.png 400w,\n/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png 652w\"\n        sizes=\"(max-width: 652px) 100vw, 652px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"July 12, 2020","slug":"/notes/R-Tip-My-ggplot2-Plots-Code","title":"R Tip: My ggplot2 Plots Code"}}},"pageContext":{"slug":"/notes/R-Tip-My-ggplot2-Plots-Code"}}}