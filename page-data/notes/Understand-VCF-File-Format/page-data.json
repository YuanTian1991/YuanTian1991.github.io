{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Understand-VCF-File-Format",
    "result": {"data":{"markdownRemark":{"html":"<p>VCF (Variant Call Format) file is such a important file format in Bioinformatic, merely because it records the mutation information for each sample. However, I have never get chance to learn it (well...too lazy). Now it's the chance. Basically I need to understand the strucuture of <code class=\"language-text\">vcf</code> format, then find a way to read/load it into R.</p>\n<p>I am using PGP-UK project for VCF generation (with nf-core/sarek pipeline), after getting VCF files, I now need to compare the VCF files with old-generated VCF files (short for <strong>oldVCFs</strong>), which can be downloaded based on <a href=\"https://www.personalgenomes.org.uk/api/v1.3/all_variant\">this API</a>.</p>\n<p>So I quickly wrote a R script to downloaded all oldVCFs, and also gathered new VCFs generated by latest Sarek.</p>\n<h2>1. Format of Meta Data</h2>\n<p>Meta data always start with <code class=\"language-text\">##</code>. I should learn from this as it's a very good action to include all parameters/software spec into final results. Note that the Contig includes chromosome information, I saw some file is chr1, chr2... while some other VCF files are 1,2,3...</p>\n<h2>2. Format of Variant</h2>\n<p>There are many web page show this information, but I quickly learned it from <a href=\"https://samtools.github.io/hts-specs/VCFv4.2.pdf\">here</a>.</p>\n<p><strong>Firstly, I found the VCF versions are difference between two batches of files.</strong> And also the columns are slight not the same. Below is the old VCF files I downloaded from EBI's SRA.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  FR07961001\n1       54712   .       T       TTTTC   231.8   PASS    .       GT:AD:DP:FT:GQ:PL:PP    1/1:0,6:6:lowGQ:18:269,18,0:269,18,0\n1       55326   .       T       C       525.77  PASS    .       GT:AD:DP:GQ:PL:PP       1/1:0,18:18:38:554,54,0:528,38,0\n1       66160   .       TTATATA T       134     PASS    .       GT:AD:DP:FT:GQ:PL:PP    1/1:0,4:4:lowGQ:12:171,12,0:171,12,0\n1       713786  .       G       GGCT    241.73  PASS    .       GT:AD:DP:GQ:PL:PP       0/1:19,8:27:99:279,0,887:279,0,887\n1       715348  .       T       G       1062.77 PASS    .       GT:AD:DP:GQ:PL:PP       1/1:0,33:33:99:1091,99,0:1195,163,0\n1       718555  .       T       C       650.77  PASS    .       GT:AD:DP:GQ:PL:PP       1/1:0,22:22:66:679,66,0:679,66,0\n...</code></pre></div>\n<p>Below is the VCF file for my newly-generated VCF file:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  uk35C650_uk35C650\nchr1    10492   rs55998931      C       T       43.64   PASS    AC=1;AF=0.500;AN=2;BaseQRankSum=0.414;CNN_1D=-2.066;DB;DP=8;ExcessHet=0.0000;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=39.09;MQRankSum=0.619;QD=5.45;ReadPosRankSum=2.100;SOR=0.169       GT:AD:DP:GQ:PL  0/1:6,2:8:51:51,0,179\nchr1    13273   rs531730856     G       C       254.64  PASS    AC=1;AF=0.500;AN=2;BaseQRankSum=-1.726;CNN_1D=-2.270;DB;DP=24;ExcessHet=0.0000;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=37.09;MQRankSum=-0.211;QD=10.61;ReadPosRankSum=0.174;SOR=0.495   GT:AD:DP:GQ:PL  0/1:13,11:24:99:262,0,345\nchr1    13417   rs777038595     C       CGAGA   358.60  PASS    AC=1;AF=0.500;AN=2;BaseQRankSum=0.048;CNN_1D=-4.390;DB;DP=31;ExcessHet=0.0000;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=30.14;MQRankSum=-0.172;QD=12.81;ReadPosRankSum=1.512;SOR=0.512    GT:AD:DP:GQ:PL  0/1:18,10:28:99:366,0,720\nchr1    13668   .       G       A       288.64  PASS    AC=1;AF=0.500;AN=2;BaseQRankSum=2.895;CNN_1D=-3.825;DP=31;ExcessHet=0.0000;FS=3.180;MLEAC=1;MLEAF=0.500;MQ=24.69;MQRankSum=1.779;QD=9.31;ReadPosRankSum=-0.541;SOR=0.560        GT:AD:DP:GQ:PL  0/1:18,13:31:99:296,0,419\nchr1    13813   .       T       G       58.64   PASS    AC=1;AF=0.500;AN=2;BaseQRankSum=-0.674;CNN_1D=-6.022;DP=9;ExcessHet=0.0000;FS=0.000;MLEAC=1;MLEAF=0.500;MQ=26.19;MQRankSum=-2.100;QD=7.33;ReadPosRankSum=0.000;SOR=0.693        GT:AD:DP:GQ:PL  0/1:6,2:8:66:66,0,212\n...\nchr1    54712   rs568927205     T       TTTTC   210.92  PASS    AC=2;AF=1.00;AN=2;CNN_1D=-0.948;DB;DP=8;ExcessHet=0.0000;FS=0.000;MLEAC=2;MLEAF=1.00;MQ=60.00;QD=27.24;SOR=3.611        GT:AD:DP:GQ:PL  1/1:0,5:5:15:225,15,0\n...</code></pre></div>\n<blockquote>\n<p>Note that I found the same mutation detected. The first row in old VCF file is the same as the row I highlighted in new VCF file. This is great, which indicates my result is correct.</p>\n</blockquote>\n<p>Below are some key columns:</p>\n<ol>\n<li><strong>CHROM</strong>, <strong>POS</strong> indicates the position.</li>\n<li><strong>ID</strong> is mapped with <code class=\"language-text\">dbSNP</code>, if it's \"<code class=\"language-text\">.</code>\", it means it's a variant not been recorded in the DB.</li>\n<li><strong>REF</strong> indicates the sequence in reference genome. If there are multiple letters (like <code class=\"language-text\">TTATATA</code> in the third line), it means a deletion that sequence changed from <code class=\"language-text\">TTATATA</code> to <code class=\"language-text\">T</code>.</li>\n<li><strong>ALT</strong> Comma separated list of alternate non-reference alleles. Note that according to <a href=\"https://www.mun.ca/biology/scarr/Transitions_vs_Transversions.html#:~:text=DNA%20substitution%20mutations%20are%20of,ring%20%26%20two%2Dring%20structures.\">this figure</a>: <code class=\"language-text\">A&lt;->G</code>, <code class=\"language-text\">C&lt;->T</code> mutations is called Transitions, while other mutations are called as Transversions.</li>\n<li><strong>QUAL</strong> indicates quality of this mutation, it's a -10log10(false probability). The higher this value is, the less chance this mutation is wrongly detected. For example, 20 means the P value is 0.01, and this site is 99% likely to be correctly identified. <strong>This is a metrics will be used for high-quality mutation filtering.</strong></li>\n<li><strong>FILTER</strong> is a simple column indicates this mutation is PASSED or not.</li>\n<li><strong>INFO</strong>, it contains a lot of information. It seems most important three are <code class=\"language-text\">AC(allele count)</code>, <code class=\"language-text\">AF(allele frequency)</code> and <code class=\"language-text\">AN(total number of alleles in called genotypes)</code>. Apart from this, I think <code class=\"language-text\">DP</code> is an important metrics, which indicates sequence depth.</li>\n</ol>\n<blockquote>\n<p>It's vital to crystally understand those 3 attribtues. This is an example:</p>\n<p>In below example, the reference allele at that position is <code class=\"language-text\">G</code>, but the two alleles detected after alignment are <code class=\"language-text\">A</code> and <code class=\"language-text\">GA</code>. Since there is only one sample here, thus the total allele number is 2 (human have two strands, or to say, haplotypes). Thus, the AC (allele count) is 1,1. And the AF (allele frequency) is 0.5 and 0.5.</p>\n<p><strong>Thus, I know that VCF file actually can represent mutation information for a list of human samples, in that case, AN would be <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>n</mi><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi></mrow></msub><mo>∗</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">n_{sample} * 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7514em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">am</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal mtight\">e</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span></span>, AC would be count number of each mutation, and AF would be AC/AN.</strong> This triggers another idea, and yes multiple VCF files can be merged togather into a big one, with AC/AF/AN recalculated. For example <a href=\"http://vcftools.sourceforge.net/perl_module.html#vcf-merge\">vcf-merge</a>.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  uk35C650_uk35C650\nchr1    49515   .       G       A,GA    174.06  PASS    AC=1,1;AF=0.500,0.500;AN=2;CNN_1D=-0.615;DP=7;ExcessHet=0.0000;FS=0.000;MLEAC=1,1;MLEAF=0.500,0.500;MQ=32.12;QD=29.01;SOR=1.329 GT:AD:DP:GQ:PL  1/2:0,3,3:6:93:191,93,100,105,0,97</code></pre></div>\n<ol start=\"8\">\n<li><strong>FORMAT</strong> , this column will exist on if genotype information is present. Just for clarify, <strong>genotype here means combination of these two alleles in each sample.</strong> Genotype is a word that has been widely used in genomic research that could mean anything... And I found <a href=\"https://www.biostars.org/p/86321/\">this post</a> is useful to understand it.</li>\n</ol>\n<p>Basically,</p>\n<ul>\n<li>\n<p><strong>GT</strong> is an important metrics here. It means genotype, encoded as allele values separated by either of ”/” or “|”. The allele values are 0 for the reference allele (what is in the REF field), 1 for the first allele listed in ALT, 2 for the second allele list in ALT and so on. For diploid calls examples could be 0/1, 1|0, or 1/2, etc.</p>\n</li>\n<li>\n<p><strong>AD</strong> is an attribute on my VCF file but not listed on the document, it means Allele Specific Depth. i.e in above sample. REF is 'G' and ALT are 'A' and \"GA\", then AD value is is '0,3,3', I got 0 G reads, 3 A reads and 3 GA reads.</p>\n</li>\n<li>\n<p><strong>DP</strong> number of reads used to call the variant. So it is the sum is AD, 6 in my example column above.</p>\n</li>\n</ul>\n<h2>3. How to Analysis VCF file?</h2>\n<p>Then, I want to know how normally people analysis VCF file in R. For example, how to load it into R. <a href=\"https://cran.r-project.org/web/packages/vcfR/index.html\">vcfR</a> looks like a good choice. <a href=\"https://grunwaldlab.github.io/Population_Genetics_in_R/reading_vcf.html\">This is a good post</a> for the usage of vcfR package. Basically I think it's a good way to load data into R session, but for the downstream, detail coding is inevitable.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> library<span class=\"token punctuation\">(</span><span class=\"token string\">\"vcfR\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> vcf <span class=\"token operator\">&lt;-</span> read.vcfR<span class=\"token punctuation\">(</span><span class=\"token string\">\"./FR07961001.pass.recode.vcf.gz\"</span><span class=\"token punctuation\">,</span> verbose <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span> <span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>getFIX<span class=\"token punctuation\">(</span>vcf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n     CHROM POS      ID REF       ALT     QUAL      FILTER\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"1\"</span>   <span class=\"token string\">\"54712\"</span>  <span class=\"token keyword\">NA</span> <span class=\"token string\">\"T\"</span>       <span class=\"token string\">\"TTTTC\"</span> <span class=\"token string\">\"231.8\"</span>   <span class=\"token string\">\"PASS\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"1\"</span>   <span class=\"token string\">\"55326\"</span>  <span class=\"token keyword\">NA</span> <span class=\"token string\">\"T\"</span>       <span class=\"token string\">\"C\"</span>     <span class=\"token string\">\"525.77\"</span>  <span class=\"token string\">\"PASS\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"1\"</span>   <span class=\"token string\">\"66160\"</span>  <span class=\"token keyword\">NA</span> <span class=\"token string\">\"TTATATA\"</span> <span class=\"token string\">\"T\"</span>     <span class=\"token string\">\"134\"</span>     <span class=\"token string\">\"PASS\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"1\"</span>   <span class=\"token string\">\"713786\"</span> <span class=\"token keyword\">NA</span> <span class=\"token string\">\"G\"</span>       <span class=\"token string\">\"GGCT\"</span>  <span class=\"token string\">\"241.73\"</span>  <span class=\"token string\">\"PASS\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"1\"</span>   <span class=\"token string\">\"715348\"</span> <span class=\"token keyword\">NA</span> <span class=\"token string\">\"T\"</span>       <span class=\"token string\">\"G\"</span>     <span class=\"token string\">\"1062.77\"</span> <span class=\"token string\">\"PASS\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"1\"</span>   <span class=\"token string\">\"718555\"</span> <span class=\"token keyword\">NA</span> <span class=\"token string\">\"T\"</span>       <span class=\"token string\">\"C\"</span>     <span class=\"token string\">\"650.77\"</span>  <span class=\"token string\">\"PASS\"</span>\n<span class=\"token operator\">></span> vcf<span class=\"token operator\">@</span>gt<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">]</span>\n     FORMAT                 FR07961001\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"GT:AD:DP:FT:GQ:PL:PP\"</span> <span class=\"token string\">\"1/1:0,6:6:lowGQ:18:269,18,0:269,18,0\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"GT:AD:DP:GQ:PL:PP\"</span>    <span class=\"token string\">\"1/1:0,18:18:38:554,54,0:528,38,0\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"GT:AD:DP:FT:GQ:PL:PP\"</span> <span class=\"token string\">\"1/1:0,4:4:lowGQ:12:171,12,0:171,12,0\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"GT:AD:DP:GQ:PL:PP\"</span>    <span class=\"token string\">\"0/1:19,8:27:99:279,0,887:279,0,887\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"GT:AD:DP:GQ:PL:PP\"</span>    <span class=\"token string\">\"1/1:0,33:33:99:1091,99,0:1195,163,0\"</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"GT:AD:DP:GQ:PL:PP\"</span>    <span class=\"token string\">\"1/1:0,22:22:66:679,66,0:679,66,0\"</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p>I have tested that both old and new version VCF files can be loaded with vcfR package. I just don't know normally what analysis direction I should go from VCF files...</p>\n<h2>4. Downstream Analysis for VCF Files</h2>\n<p>To be continue if I have time... But I found a nice figure <a href=\"http://bioconductor.org/help/course-materials/2014/CSAMA2014/3_Wednesday/lectures/VariantCallingLecture.pdf\">here</a> shows some commonly downstream ways. It seems like VCF files can be used for annotation (like find what mutation would lead to which disease), and comparison analysis (like find mutation signals between cancer and normal).</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9ff3ae07d0577ea7495be387cba6d603/5a3c9/VCF_Downstream.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChklEQVQ4y2VTa5OaUAz1//+gzradbqdrdysrK6AuykuQlyAvX7wUPJ1kVz+0mWFyCbkn5yRhcLlcUJ5OKMsSFT1VxWeKX69X/GsU6/v+v9jNBgRwuV6x9jy8jEYwHQcdgLquOSEIfNi2DcdxkGXZ/WLXdZzTNA370+nEhRgwcxyE73PoigRHlpC7LuI4hmVZ/CTJFq7rMmie51iv1+wph2LkSRWBDqqqxnoygfJjiPl4CuHLd6ze3nA4HFh2URQMRsC73Y7Z0UWK0zvl0ZkKnM/nT8l9D3ER4OFZg6xHoI7s93tOTpIEnuchCAKWTJdvPaSCTdOyv/eQepGlKdIkQZ5n8FwXsiwzKwKgqjdr2xZpmnIBTdO4IPWPSJGn4QyoGgVOxyN0XWcwQRDg+8Fd3s2oTwSq6xrnTSYTiKLI0gmDyDFDmlSR51BVFZIkQRyPsVqtOIFAaCuoDcykqqC+v0ORFUiyDEmSURQ7xrgD1k3DDHTDwGw2w3Q+x+545Ni5re8Mb6vU4QrL1GFbBtqm/Pz2yZAqZ1GE1DThqCo2YYDFeAxfVVFsIhhOjJWXIUpPyLdb+IqCSFWh21u8Tl3IyxALu8AmzmnFMSD0yLaxePyJUDNRVQ2MP69Y/nqCo0zxe2LhcaRD0TdIowjqcAhDEGC5KcS5h2dRw3jmwg+TD0CieT432GQlr82PkYGvLwYMrwDQs5SbHY5HFGWJsusQhj58b426rVFWtJf5x5QvBNg2LOnb8xIPT1M8DFWYbgZcex7KzWgoiWnCFQTs4hiHYgdXfMNm/s7D6vruY20Ohz3COMNUCzDTPChLH46fcJxAbkYr5C4WLDkNQ+zyHJYowpZl/hGI4V9n3xr+2geZhAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"VCF Downstream Analysis\"\n        title=\"VCF Downstream Analysis\"\n        src=\"/static/9ff3ae07d0577ea7495be387cba6d603/00d43/VCF_Downstream.png\"\n        srcset=\"/static/9ff3ae07d0577ea7495be387cba6d603/63868/VCF_Downstream.png 250w,\n/static/9ff3ae07d0577ea7495be387cba6d603/0b533/VCF_Downstream.png 500w,\n/static/9ff3ae07d0577ea7495be387cba6d603/00d43/VCF_Downstream.png 1000w,\n/static/9ff3ae07d0577ea7495be387cba6d603/5a3c9/VCF_Downstream.png 1169w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"August 11, 2022","slug":"/notes/Understand-VCF-File-Format","title":"Understand VCF File Format","tags":["VCF","Mutation","Sarek"],"abstract":"it is a shame that I never look into vcf file format closely, merely because I have been working on methylation. Finally, now it is a chance for me to get some familarity with mutation pipeline and vcf files."}}},"pageContext":{"slug":"/notes/Understand-VCF-File-Format"}},
    "staticQueryHashes": ["63159454"]}