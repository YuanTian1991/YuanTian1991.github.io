{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/ChAMP-3.0:-champ.Overlap()",
    "result": {"data":{"markdownRemark":{"html":"<p>For a long time I need to do write custome code for mappping between CpGs and Transcripts, Peaks and Transcript Factor Binding Sites .etc. It's time to write a universal solution for this. The newly added <code class=\"language-text\">champ.Overlap()</code> function perform this task well. This function requires two genome coordinates based data.frame as input, then collapse the records in second data.frame into the first data.frame. The cool thing for this function is that it can:</p>\n<ol>\n<li>Allow custome function for attibutes <strong>collapse</strong>; For example <code class=\"language-text\">y</code> is genome annotation, the function can \"concat\" attibutes user like, for example calculate mean value for a numeric variable, or conact a character array into a long string as output. etc. This kind of action that \"merge\" multiple values in <code class=\"language-text\">y</code> to one sample record in <code class=\"language-text\">x</code> is defined as \"collapse\". And this kind of collapse function can be defined by user themselves.</li>\n<li>It can be done reversely, like <code class=\"language-text\">x -> y</code> and <code class=\"language-text\">y -> x</code> both work. Assuming <code class=\"language-text\">peaks</code> is a data.frame of peaks on genome, <code class=\"language-text\">promoters</code> is a data.frame of transcript promoters. You can run <code class=\"language-text\">champ.Overlap(peaks, promoter)</code> to map find all promoters that each peak related. Or you can run <code class=\"language-text\">champ.Overlap(promoter, peaks)</code> to find peaks that one promoter covered.</li>\n</ol>\n<p>The code is <a href=\"https://github.com/YuanTian1991/ChAMP-Script/blob/master/champ.overlap.R\">here</a>. To use it, simply source the script like:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">source<span class=\"token punctuation\">(</span><span class=\"token string\">\"https://raw.githubusercontent.com/YuanTian1991/ChAMP-Script/master/champ.Overlap.R\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Note that two packages are required: <code class=\"language-text\">GenomicRanges</code> and <code class=\"language-text\">data.table</code>.</p>\n<hr>\n<h2>Function Usage</h2>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">peakAnno <span class=\"token operator\">&lt;-</span> champ.Overlap<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>peaks<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>promoterAnno<span class=\"token punctuation\">,</span> \n                          yAttributes<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"feature\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"transcriptClass\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"geneSymbol\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                          collapseFunctions<span class=\"token operator\">=</span>list<span class=\"token punctuation\">(</span>ConcatCharacterArray<span class=\"token punctuation\">,</span> ConcatCharacterArray<span class=\"token punctuation\">,</span> ConcatCharacterArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ngeneMapping <span class=\"token operator\">&lt;-</span> champ.Overlap<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>promoterAnno<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>peaks<span class=\"token punctuation\">,</span> \n                             yAttributes<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"cnt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fraction\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                             collapseFunctions<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">,</span> mean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><em>Parameters:</em></p>\n<ul>\n<li><strong>x</strong>: A data frame contains at least chromosome, start, end; And some additional attributes.</li>\n<li><strong>y</strong>: A data frame contains at least chromosome, start, end; And some additional attributes.</li>\n<li><strong>yAttributes</strong>: colnames to be collapsed, they MUST be existing in y data.frame above.</li>\n<li><strong>collapseFunctions</strong>: functions to be used to collpase each yAttributes above. Note that it MUST match above yAttibutes, and it directly take a array (or single value) as input, no extra parameter can be set inside.</li>\n</ul>\n<p><em>Outputs:</em></p>\n<ul>\n<li>A data.frame with overlapped records in x data.frame, with collapsed y attributes on eachj column.</li>\n</ul>\n<p><em>Other:</em>\nWhen you source the file, one function <code class=\"language-text\">ConcatCharacterArray</code> will be created, it's a simple function as below:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">ConcatCharacterArray <span class=\"token operator\">&lt;-</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    paste<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> collapse<span class=\"token operator\">=</span><span class=\"token string\">\";\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The purpose of this function is to avoid input of collapse parameter in paste function, so that <code class=\"language-text\">ConcatCharacterArray(c(\"A\", \"B\", \"C\"))</code> can directly return <code class=\"language-text\">\"A;B;C\"</code>.</p>\n<p>That's the requirement of <code class=\"language-text\">collapseFunction</code> parameter in <code class=\"language-text\">champ.overlap()</code> function. It allow user to pass into as function, but not any other parameters, like <code class=\"language-text\">mean</code>, <code class=\"language-text\">sum</code>. If user really need some parameter, like <code class=\"language-text\">collapse=';'</code> in paste function, they can create a simple function wrap the function and parameter defined.</p>\n<h2>Example</h2>\n<p>Below is an example to show the functionality.</p>\n<h3>Two Genome Segements data frames</h3>\n<p>Below is a list of 5hmC peaks data I have. The <code class=\"language-text\">cnt</code>, <code class=\"language-text\">ocp</code>, <code class=\"language-text\">fraction</code> are values each peak holds.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>peaks<span class=\"token punctuation\">)</span>\n    seqnames  start    end      cnt ocp  fraction\n<span class=\"token number\">6</span>       chr1  <span class=\"token number\">20598</span>  <span class=\"token number\">22060</span> <span class=\"token number\">5.921950</span>   <span class=\"token number\">8</span> <span class=\"token number\">0.8888889</span>\n<span class=\"token number\">11</span>      chr1  <span class=\"token number\">29706</span>  <span class=\"token number\">30271</span> <span class=\"token number\">4.712342</span>   <span class=\"token number\">9</span> <span class=\"token number\">1.0000000</span>\n<span class=\"token number\">37</span>      chr1 <span class=\"token number\">191411</span> <span class=\"token number\">192483</span> <span class=\"token number\">5.935521</span>   <span class=\"token number\">7</span> <span class=\"token number\">0.7777778</span>\n<span class=\"token number\">42</span>      chr1 <span class=\"token number\">200117</span> <span class=\"token number\">200768</span> <span class=\"token number\">4.969351</span>   <span class=\"token number\">7</span> <span class=\"token number\">0.7777778</span>\n<span class=\"token number\">102</span>     chr1 <span class=\"token number\">812669</span> <span class=\"token number\">813322</span> <span class=\"token number\">4.704344</span>   <span class=\"token number\">7</span> <span class=\"token number\">0.7777778</span>\n<span class=\"token number\">121</span>     chr1 <span class=\"token number\">888214</span> <span class=\"token number\">888815</span> <span class=\"token number\">5.876435</span>   <span class=\"token number\">7</span> <span class=\"token number\">0.7777778</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p>Below is a list of transcript promoter I have. It contains coordinates of each transcript, and related geneSymbol, transcriptClass, feature .etc</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>promoterAnno<span class=\"token punctuation\">)</span>\n         seqnames start   end  feature  geneSymbol transcriptClass\n<span class=\"token number\">70287.1</span>      chr1  <span class=\"token number\">9868</span> <span class=\"token number\">12367</span> Promoter     DDX11L1          pseudo\n<span class=\"token number\">66063.1</span>      chr1 <span class=\"token number\">10009</span> <span class=\"token number\">12508</span> Promoter     DDX11L1          pseudo\n<span class=\"token number\">97153.25</span>     chr1 <span class=\"token number\">29071</span> <span class=\"token number\">31570</span> Promoter      WASH7P          pseudo\n<span class=\"token number\">195386.5</span>     chr1 <span class=\"token number\">16937</span> <span class=\"token number\">19436</span> Promoter   MIR6859<span class=\"token operator\">-</span><span class=\"token number\">1</span>       nonCoding\n<span class=\"token number\">84233.1</span>      chr1 <span class=\"token number\">27553</span> <span class=\"token number\">30052</span> Promoter MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG       nonCoding\n<span class=\"token number\">80682.1</span>      chr1 <span class=\"token number\">28266</span> <span class=\"token number\">30765</span> Promoter MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG       nonCoding</code></pre></div>\n<h3>Annotate peaks with Transcript Promoter</h3>\n<p>First task is annotate peaks with transcript promoter. This is a common task in Bioinformatics, we found a list of DMR/DMP/Peaks, and we want to know if these target-of-interested are located in specific genome regions like CpG Islands, Promoters .etc</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">peakAnno <span class=\"token operator\">&lt;-</span> champ.Overlap<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>peaks<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>promoterAnno<span class=\"token punctuation\">,</span> \n                          yAttributes<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"feature\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"transcriptClass\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"geneSymbol\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                          collapseFunctions<span class=\"token operator\">=</span>list<span class=\"token punctuation\">(</span>ConcatCharacterArray<span class=\"token punctuation\">,</span> ConcatCharacterArray<span class=\"token punctuation\">,</span> ConcatCharacterArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The result looks like below:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">(</span>peakAnno<span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>seqnames <span class=\"token operator\">|</span>   start<span class=\"token operator\">|</span>     end<span class=\"token operator\">|</span>      cnt<span class=\"token operator\">|</span> ocp<span class=\"token operator\">|</span>  fraction<span class=\"token operator\">|</span> xIndex<span class=\"token operator\">|</span> yOvNumber<span class=\"token operator\">|</span>yIndexList                      <span class=\"token operator\">|</span>feature                                                                 <span class=\"token operator\">|</span>transcriptClass                                                    <span class=\"token operator\">|</span>geneSymbol                                                       <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">11</span>   <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span>   <span class=\"token number\">29706</span><span class=\"token operator\">|</span>   <span class=\"token number\">30271</span><span class=\"token operator\">|</span> <span class=\"token number\">4.712342</span><span class=\"token operator\">|</span>   <span class=\"token number\">9</span><span class=\"token operator\">|</span> <span class=\"token number\">1.0000000</span><span class=\"token operator\">|</span>      <span class=\"token number\">2</span><span class=\"token operator\">|</span>         <span class=\"token number\">4</span><span class=\"token operator\">|</span><span class=\"token number\">3</span><span class=\"token punctuation\">;</span><span class=\"token number\">5</span><span class=\"token punctuation\">;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span><span class=\"token number\">7</span>                         <span class=\"token operator\">|</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter                                     <span class=\"token operator\">|</span>pseudo<span class=\"token punctuation\">;</span>nonCoding<span class=\"token punctuation\">;</span>nonCoding<span class=\"token punctuation\">;</span>nonCoding                               <span class=\"token operator\">|</span>WASH7P<span class=\"token punctuation\">;</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG<span class=\"token punctuation\">;</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG<span class=\"token punctuation\">;</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>                         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">262</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1232588</span><span class=\"token operator\">|</span> <span class=\"token number\">1234675</span><span class=\"token operator\">|</span> <span class=\"token number\">6.301465</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>      <span class=\"token number\">7</span><span class=\"token operator\">|</span>         <span class=\"token number\">6</span><span class=\"token operator\">|</span><span class=\"token number\">306</span><span class=\"token punctuation\">;</span><span class=\"token number\">307</span><span class=\"token punctuation\">;</span><span class=\"token number\">308</span><span class=\"token punctuation\">;</span><span class=\"token number\">309</span><span class=\"token punctuation\">;</span><span class=\"token number\">313</span><span class=\"token punctuation\">;</span><span class=\"token number\">314</span>         <span class=\"token operator\">|</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter                   <span class=\"token operator\">|</span>coding<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>nonCoding<span class=\"token punctuation\">;</span>coding                       <span class=\"token operator\">|</span>SDF4<span class=\"token punctuation\">;</span>SDF4<span class=\"token punctuation\">;</span>SDF4<span class=\"token punctuation\">;</span>SDF4<span class=\"token punctuation\">;</span>SDF4<span class=\"token punctuation\">;</span>B3GALT6                                 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">309</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1316821</span><span class=\"token operator\">|</span> <span class=\"token number\">1318275</span><span class=\"token operator\">|</span> <span class=\"token number\">5.682353</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>      <span class=\"token number\">8</span><span class=\"token operator\">|</span>         <span class=\"token number\">8</span><span class=\"token operator\">|</span><span class=\"token number\">370</span><span class=\"token punctuation\">;</span><span class=\"token number\">378</span><span class=\"token punctuation\">;</span><span class=\"token number\">379</span><span class=\"token punctuation\">;</span><span class=\"token number\">393</span><span class=\"token punctuation\">;</span><span class=\"token number\">395</span><span class=\"token punctuation\">;</span><span class=\"token number\">397</span><span class=\"token punctuation\">;</span><span class=\"token number\">398</span><span class=\"token punctuation\">;</span><span class=\"token number\">408</span> <span class=\"token operator\">|</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter <span class=\"token operator\">|</span>problem<span class=\"token punctuation\">;</span>nonCoding<span class=\"token punctuation\">;</span>problem<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>problem<span class=\"token punctuation\">;</span>problem<span class=\"token punctuation\">;</span>problem<span class=\"token punctuation\">;</span>nonCoding <span class=\"token operator\">|</span>INTS11<span class=\"token punctuation\">;</span>INTS11<span class=\"token punctuation\">;</span>INTS11<span class=\"token punctuation\">;</span>INTS11<span class=\"token punctuation\">;</span>INTS11<span class=\"token punctuation\">;</span>INTS11<span class=\"token punctuation\">;</span>INTS11<span class=\"token punctuation\">;</span>ENSG00000240731 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">399</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1540876</span><span class=\"token operator\">|</span> <span class=\"token number\">1542847</span><span class=\"token operator\">|</span> <span class=\"token number\">6.430392</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>      <span class=\"token number\">9</span><span class=\"token operator\">|</span>         <span class=\"token number\">3</span><span class=\"token operator\">|</span><span class=\"token number\">533</span><span class=\"token punctuation\">;</span><span class=\"token number\">534</span><span class=\"token punctuation\">;</span><span class=\"token number\">535</span>                     <span class=\"token operator\">|</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter                                              <span class=\"token operator\">|</span>coding<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>coding                                               <span class=\"token operator\">|</span>TMEM240<span class=\"token punctuation\">;</span>TMEM240<span class=\"token punctuation\">;</span>TMEM240                                          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">416</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1570375</span><span class=\"token operator\">|</span> <span class=\"token number\">1572375</span><span class=\"token operator\">|</span> <span class=\"token number\">6.333858</span><span class=\"token operator\">|</span>   <span class=\"token number\">9</span><span class=\"token operator\">|</span> <span class=\"token number\">1.0000000</span><span class=\"token operator\">|</span>     <span class=\"token number\">12</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">540</span>                             <span class=\"token operator\">|</span>Promoter                                                                <span class=\"token operator\">|</span>nonCoding                                                          <span class=\"token operator\">|</span>ENSG00000215014                                                  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">532</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1818847</span><span class=\"token operator\">|</span> <span class=\"token number\">1820437</span><span class=\"token operator\">|</span> <span class=\"token number\">5.931760</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">19</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">659</span>                             <span class=\"token operator\">|</span>Promoter                                                                <span class=\"token operator\">|</span>problem                                                            <span class=\"token operator\">|</span>GNB1                                                             <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">537</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1827081</span><span class=\"token operator\">|</span> <span class=\"token number\">1830492</span><span class=\"token operator\">|</span> <span class=\"token number\">6.625202</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">20</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">663</span>                             <span class=\"token operator\">|</span>Promoter                                                                <span class=\"token operator\">|</span>problem                                                            <span class=\"token operator\">|</span>GNB1                                                             <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">672</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">2133753</span><span class=\"token operator\">|</span> <span class=\"token number\">2135669</span><span class=\"token operator\">|</span> <span class=\"token number\">6.581739</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">29</span><span class=\"token operator\">|</span>         <span class=\"token number\">4</span><span class=\"token operator\">|</span><span class=\"token number\">729</span><span class=\"token punctuation\">;</span><span class=\"token number\">730</span><span class=\"token punctuation\">;</span><span class=\"token number\">731</span><span class=\"token punctuation\">;</span><span class=\"token number\">732</span>                 <span class=\"token operator\">|</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter                                     <span class=\"token operator\">|</span>coding<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>nonCoding                                     <span class=\"token operator\">|</span>PRKCZ<span class=\"token punctuation\">;</span>PRKCZ<span class=\"token punctuation\">;</span>PRKCZ<span class=\"token punctuation\">;</span>PRKCZ                                          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">726</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">2244867</span><span class=\"token operator\">|</span> <span class=\"token number\">2247532</span><span class=\"token operator\">|</span> <span class=\"token number\">6.418189</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">31</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">759</span>                             <span class=\"token operator\">|</span>Promoter                                                                <span class=\"token operator\">|</span>nonCoding                                                          <span class=\"token operator\">|</span>SKI                                                              <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">1457</span> <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">6236299</span><span class=\"token operator\">|</span> <span class=\"token number\">6237233</span><span class=\"token operator\">|</span> <span class=\"token number\">4.969481</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">45</span><span class=\"token operator\">|</span>         <span class=\"token number\">5</span><span class=\"token operator\">|</span><span class=\"token number\">1193</span><span class=\"token punctuation\">;</span><span class=\"token number\">1195</span><span class=\"token punctuation\">;</span><span class=\"token number\">1196</span><span class=\"token punctuation\">;</span><span class=\"token number\">1198</span><span class=\"token punctuation\">;</span><span class=\"token number\">1199</span>        <span class=\"token operator\">|</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter<span class=\"token punctuation\">;</span>Promoter                            <span class=\"token operator\">|</span>coding<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>coding<span class=\"token punctuation\">;</span>nonCoding<span class=\"token punctuation\">;</span>nonCoding                           <span class=\"token operator\">|</span>ICMT<span class=\"token punctuation\">;</span>ICMT<span class=\"token punctuation\">;</span>ICMT<span class=\"token punctuation\">;</span>LINC00337<span class=\"token punctuation\">;</span>LINC00337                               <span class=\"token operator\">|</span></code></pre></div>\n<p>The <code class=\"language-text\">xIndex</code> is the row number of this record in origin x data.frame. The <code class=\"language-text\">yOvNumber</code> is number of records in y mapped on corresponding x record. The <code class=\"language-text\">yIndexList</code> is index list of mapped y record. The following columns are features assigned in <code class=\"language-text\">yAttributes</code>, they are collapsed based on function in <code class=\"language-text\">collapseFunctions</code>. In above example, the function it used is <code class=\"language-text\">ConcatCharacterArray</code>, which will concat character arraies.</p>\n<h3>Use self-defined Collapse Function</h3>\n<p>We can define our function as well, like:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">ConcatUnique <span class=\"token operator\">&lt;-</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    paste<span class=\"token punctuation\">(</span>unique<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> collapse<span class=\"token operator\">=</span><span class=\"token string\">\";\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\npeakUniqueFeature <span class=\"token operator\">&lt;-</span> champ.Overlap<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>peaks<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>promoterAnno<span class=\"token punctuation\">,</span> \n                          yAttributes<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"feature\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"transcriptClass\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                          collapseFunctions<span class=\"token operator\">=</span>list<span class=\"token punctuation\">(</span>ConcatUnique<span class=\"token punctuation\">,</span> ConcatUnique<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The result looks like:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">(</span>peakUniqueFeature<span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>seqnames <span class=\"token operator\">|</span>   start<span class=\"token operator\">|</span>     end<span class=\"token operator\">|</span>      cnt<span class=\"token operator\">|</span> ocp<span class=\"token operator\">|</span>  fraction<span class=\"token operator\">|</span> xIndex<span class=\"token operator\">|</span> yOvNumber<span class=\"token operator\">|</span>yIndexList                      <span class=\"token operator\">|</span>feature  <span class=\"token operator\">|</span>transcriptClass          <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">11</span>   <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span>   <span class=\"token number\">29706</span><span class=\"token operator\">|</span>   <span class=\"token number\">30271</span><span class=\"token operator\">|</span> <span class=\"token number\">4.712342</span><span class=\"token operator\">|</span>   <span class=\"token number\">9</span><span class=\"token operator\">|</span> <span class=\"token number\">1.0000000</span><span class=\"token operator\">|</span>      <span class=\"token number\">2</span><span class=\"token operator\">|</span>         <span class=\"token number\">4</span><span class=\"token operator\">|</span><span class=\"token number\">3</span><span class=\"token punctuation\">;</span><span class=\"token number\">5</span><span class=\"token punctuation\">;</span><span class=\"token number\">6</span><span class=\"token punctuation\">;</span><span class=\"token number\">7</span>                         <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>pseudo<span class=\"token punctuation\">;</span>nonCoding         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">262</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1232588</span><span class=\"token operator\">|</span> <span class=\"token number\">1234675</span><span class=\"token operator\">|</span> <span class=\"token number\">6.301465</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>      <span class=\"token number\">7</span><span class=\"token operator\">|</span>         <span class=\"token number\">6</span><span class=\"token operator\">|</span><span class=\"token number\">306</span><span class=\"token punctuation\">;</span><span class=\"token number\">307</span><span class=\"token punctuation\">;</span><span class=\"token number\">308</span><span class=\"token punctuation\">;</span><span class=\"token number\">309</span><span class=\"token punctuation\">;</span><span class=\"token number\">313</span><span class=\"token punctuation\">;</span><span class=\"token number\">314</span>         <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>coding<span class=\"token punctuation\">;</span>nonCoding         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">309</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1316821</span><span class=\"token operator\">|</span> <span class=\"token number\">1318275</span><span class=\"token operator\">|</span> <span class=\"token number\">5.682353</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>      <span class=\"token number\">8</span><span class=\"token operator\">|</span>         <span class=\"token number\">8</span><span class=\"token operator\">|</span><span class=\"token number\">370</span><span class=\"token punctuation\">;</span><span class=\"token number\">378</span><span class=\"token punctuation\">;</span><span class=\"token number\">379</span><span class=\"token punctuation\">;</span><span class=\"token number\">393</span><span class=\"token punctuation\">;</span><span class=\"token number\">395</span><span class=\"token punctuation\">;</span><span class=\"token number\">397</span><span class=\"token punctuation\">;</span><span class=\"token number\">398</span><span class=\"token punctuation\">;</span><span class=\"token number\">408</span> <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>problem<span class=\"token punctuation\">;</span>nonCoding<span class=\"token punctuation\">;</span>coding <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">399</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1540876</span><span class=\"token operator\">|</span> <span class=\"token number\">1542847</span><span class=\"token operator\">|</span> <span class=\"token number\">6.430392</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>      <span class=\"token number\">9</span><span class=\"token operator\">|</span>         <span class=\"token number\">3</span><span class=\"token operator\">|</span><span class=\"token number\">533</span><span class=\"token punctuation\">;</span><span class=\"token number\">534</span><span class=\"token punctuation\">;</span><span class=\"token number\">535</span>                     <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>coding                   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">416</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1570375</span><span class=\"token operator\">|</span> <span class=\"token number\">1572375</span><span class=\"token operator\">|</span> <span class=\"token number\">6.333858</span><span class=\"token operator\">|</span>   <span class=\"token number\">9</span><span class=\"token operator\">|</span> <span class=\"token number\">1.0000000</span><span class=\"token operator\">|</span>     <span class=\"token number\">12</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">540</span>                             <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>nonCoding                <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">532</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1818847</span><span class=\"token operator\">|</span> <span class=\"token number\">1820437</span><span class=\"token operator\">|</span> <span class=\"token number\">5.931760</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">19</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">659</span>                             <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>problem                  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">537</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1827081</span><span class=\"token operator\">|</span> <span class=\"token number\">1830492</span><span class=\"token operator\">|</span> <span class=\"token number\">6.625202</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">20</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">663</span>                             <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>problem                  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">672</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">2133753</span><span class=\"token operator\">|</span> <span class=\"token number\">2135669</span><span class=\"token operator\">|</span> <span class=\"token number\">6.581739</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">29</span><span class=\"token operator\">|</span>         <span class=\"token number\">4</span><span class=\"token operator\">|</span><span class=\"token number\">729</span><span class=\"token punctuation\">;</span><span class=\"token number\">730</span><span class=\"token punctuation\">;</span><span class=\"token number\">731</span><span class=\"token punctuation\">;</span><span class=\"token number\">732</span>                 <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>coding<span class=\"token punctuation\">;</span>nonCoding         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">726</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">2244867</span><span class=\"token operator\">|</span> <span class=\"token number\">2247532</span><span class=\"token operator\">|</span> <span class=\"token number\">6.418189</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">31</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">759</span>                             <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>nonCoding                <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">1457</span> <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">6236299</span><span class=\"token operator\">|</span> <span class=\"token number\">6237233</span><span class=\"token operator\">|</span> <span class=\"token number\">4.969481</span><span class=\"token operator\">|</span>   <span class=\"token number\">7</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>     <span class=\"token number\">45</span><span class=\"token operator\">|</span>         <span class=\"token number\">5</span><span class=\"token operator\">|</span><span class=\"token number\">1193</span><span class=\"token punctuation\">;</span><span class=\"token number\">1195</span><span class=\"token punctuation\">;</span><span class=\"token number\">1196</span><span class=\"token punctuation\">;</span><span class=\"token number\">1198</span><span class=\"token punctuation\">;</span><span class=\"token number\">1199</span>        <span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>coding<span class=\"token punctuation\">;</span>nonCoding         <span class=\"token operator\">|</span></code></pre></div>\n<p>Note that in above example, after collaping, the value in feature/transcriptClass does NOT match y IndexList anymore, and they don't match each other either. Thus use should be careful about the \"collapseFunctions\".</p>\n<h3>Annotate Transcript Factors with Peaks</h3>\n<p>This is also a popular task in Bioinformatics, when we get a list of Differential Methylated Signals, we want to know what genes are overlapped by these DMPs, and how many DMPs are located in each gene promoter.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">geneMapping <span class=\"token operator\">&lt;-</span> champ.Overlap<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>promoterAnno<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>peaks<span class=\"token punctuation\">,</span> \n                             yAttributes<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"cnt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fraction\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                             collapseFunctions<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span>mean<span class=\"token punctuation\">,</span> mean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">(</span>geneMapping<span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">|</span>          <span class=\"token operator\">|</span>seqnames <span class=\"token operator\">|</span>   start<span class=\"token operator\">|</span>     end<span class=\"token operator\">|</span>feature  <span class=\"token operator\">|</span>geneSymbol  <span class=\"token operator\">|</span>transcriptClass <span class=\"token operator\">|</span> xIndex<span class=\"token operator\">|</span> yOvNumber<span class=\"token operator\">|</span>yIndexList <span class=\"token operator\">|</span>      cnt<span class=\"token operator\">|</span>  fraction<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">97153.25</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span>   <span class=\"token number\">29071</span><span class=\"token operator\">|</span>   <span class=\"token number\">31570</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>WASH7P      <span class=\"token operator\">|</span>pseudo          <span class=\"token operator\">|</span>      <span class=\"token number\">3</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">2</span>          <span class=\"token operator\">|</span> <span class=\"token number\">4.712342</span><span class=\"token operator\">|</span> <span class=\"token number\">1.0000000</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">84233.1</span>   <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span>   <span class=\"token number\">27553</span><span class=\"token operator\">|</span>   <span class=\"token number\">30052</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG <span class=\"token operator\">|</span>nonCoding       <span class=\"token operator\">|</span>      <span class=\"token number\">5</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">2</span>          <span class=\"token operator\">|</span> <span class=\"token number\">4.712342</span><span class=\"token operator\">|</span> <span class=\"token number\">1.0000000</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">80682.1</span>   <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span>   <span class=\"token number\">28266</span><span class=\"token operator\">|</span>   <span class=\"token number\">30765</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>HG <span class=\"token operator\">|</span>nonCoding       <span class=\"token operator\">|</span>      <span class=\"token number\">6</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">2</span>          <span class=\"token operator\">|</span> <span class=\"token number\">4.712342</span><span class=\"token operator\">|</span> <span class=\"token number\">1.0000000</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">186707.1</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span>   <span class=\"token number\">28365</span><span class=\"token operator\">|</span>   <span class=\"token number\">30864</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>MIR1302<span class=\"token operator\">-</span><span class=\"token number\">2</span>   <span class=\"token operator\">|</span>nonCoding       <span class=\"token operator\">|</span>      <span class=\"token number\">7</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">2</span>          <span class=\"token operator\">|</span> <span class=\"token number\">4.712342</span><span class=\"token operator\">|</span> <span class=\"token number\">1.0000000</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">233417.17</span> <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1231568</span><span class=\"token operator\">|</span> <span class=\"token number\">1234067</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>SDF4        <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>    <span class=\"token number\">306</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">7</span>          <span class=\"token operator\">|</span> <span class=\"token number\">6.301465</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">17356.17</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1231502</span><span class=\"token operator\">|</span> <span class=\"token number\">1234001</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>SDF4        <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>    <span class=\"token number\">307</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">7</span>          <span class=\"token operator\">|</span> <span class=\"token number\">6.301465</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">3866.17</span>   <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1231532</span><span class=\"token operator\">|</span> <span class=\"token number\">1234031</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>SDF4        <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>    <span class=\"token number\">308</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">7</span>          <span class=\"token operator\">|</span> <span class=\"token number\">6.301465</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">77565.17</span>  <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1231532</span><span class=\"token operator\">|</span> <span class=\"token number\">1234031</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>SDF4        <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>    <span class=\"token number\">309</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">7</span>          <span class=\"token operator\">|</span> <span class=\"token number\">6.301465</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">72549.9</span>   <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1231469</span><span class=\"token operator\">|</span> <span class=\"token number\">1233968</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>SDF4        <span class=\"token operator\">|</span>nonCoding       <span class=\"token operator\">|</span>    <span class=\"token number\">313</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">7</span>          <span class=\"token operator\">|</span> <span class=\"token number\">6.301465</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">26428.1</span>   <span class=\"token operator\">|</span>chr1     <span class=\"token operator\">|</span> <span class=\"token number\">1230236</span><span class=\"token operator\">|</span> <span class=\"token number\">1232735</span><span class=\"token operator\">|</span>Promoter <span class=\"token operator\">|</span>B3GALT6     <span class=\"token operator\">|</span>coding          <span class=\"token operator\">|</span>    <span class=\"token number\">314</span><span class=\"token operator\">|</span>         <span class=\"token number\">1</span><span class=\"token operator\">|</span><span class=\"token number\">7</span>          <span class=\"token operator\">|</span> <span class=\"token number\">6.301465</span><span class=\"token operator\">|</span> <span class=\"token number\">0.7777778</span><span class=\"token operator\">|</span></code></pre></div>\n<p>That's it, an genome overlap function works for both ways. And can costumly collapse features.</p>","frontmatter":{"date":"April 12, 2022","slug":"/notes/ChAMP-3.0:-champ.Overlap()","title":"ChAMP 3.0: champ.Overlap()","tags":["ChAMP","annotation"],"abstract":"A new function added to ChAMP for general mapping between two segments on genome. Like mapping CpGs, Peaks .etc to Genes, CpGIslands .etc"}}},"pageContext":{"slug":"/notes/ChAMP-3.0:-champ.Overlap()"}},
    "staticQueryHashes": ["63159454"]}