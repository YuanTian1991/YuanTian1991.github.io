{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/My-ggplot2-Plots-Code",
    "result": {"data":{"markdownRemark":{"html":"<p>I used to only use pure R code to draw plots, it's not bad, but ggplot2 indeed do much better than I do. But it's not very easy to remember code from ggplot2. So here I record a bit code I used. Or better, form them into functions or even a small personal use R visualisation package in the future.</p>\n<h3>Histogram</h3>\n<p>For example, histogram could be used to check p value quickly.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">'ggplot2'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#head(DEG$pvalue)</span>\n\n<span class=\"token comment\">#[1] 7.459678e-33 5.611091e-31 5.081911e-23 4.894006e-21 1.068582e-20</span>\n<span class=\"token comment\">#[6] 1.921252e-20</span>\n\nggplot<span class=\"token punctuation\">(</span>DEG<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>pvalue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> geom_histogram<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> theme_minimal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span><span class=\"token string\">\"p value histogram\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 652px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAABv0lEQVQ4y61US8tBURQ9f1Ikj5AkA2MmpgYmZkZMGUgeAzHwC5SSdwkxkZLk/Vhfe3/t+1035MOpfc/a55y79l7nsRUAbLdbzOdztul0itlshsvlQlO4Xq9aL1g/bvTVbrfD6XRiMiLWLyBSISJs9AXrfXU+n5mgXC5jOBwyNi7+jylJtVqtYjwef054PB41wtFo9Dnhfr9/i/DhHuolfyVDOmEj4btkTyXfuyav+Gq5XDJJpVL5juT1eq0RfuXa6CXrL/arEmVMkyyHks1mkUwmGdPreSUb4zvmDKUIpNNpxOPxm0VELHYva1InPtWEG8n5fB4+nw/tdhur1Qrygu5VFEmC3j8VFRonfDgcoOhDrVgswmw2IxAIIBgMIhKJcJBarYZms4lGo8E/1+t1LUCpVIIcaiaT+SWUaIVCATabDV6vFy6XCw6HA1arFRaLhX2/349wOIxQKIRoNIpUKoVYLIZcLodEIsGY66GUL8qGMvR4PEzgdrsZi+90Ojmg3W7XApFPvclkYlWTyeQvQ5LTarXQ6/XYOp0OW7fbZev3+xgMBjxHmHr9OG3LYrGAkv2Q6/Oo0UFtNpuna0jtD2tzz48rhKhiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"P value Histogram\"\n        title=\"P value Histogram\"\n        src=\"/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png\"\n        srcset=\"/static/1f4f01f1614a299e4bd9a71f6932d750/63868/fig1.png 250w,\n/static/1f4f01f1614a299e4bd9a71f6932d750/0b533/fig1.png 500w,\n/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png 652w\"\n        sizes=\"(max-width: 652px) 100vw, 652px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>PCA plot</h2>\n<p>The <a href=\"https://cran.r-project.org/web/packages/ggfortify/vignettes/plot_pca.html\">ggfortify</a> is a easy to use and beautiful tool for PCA visualisation. However, it seems the origin data must be data.frame format.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggfortify<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># TPM must be a data frame.</span>\ndf <span class=\"token operator\">&lt;-</span> TPM<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>ncol<span class=\"token punctuation\">(</span>TPM<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\npca_res <span class=\"token operator\">&lt;-</span> prcomp<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> scale. <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span>\n\nautoplot<span class=\"token punctuation\">(</span>pca_res<span class=\"token punctuation\">,</span> data <span class=\"token operator\">=</span> TPM<span class=\"token punctuation\">,</span> colour <span class=\"token operator\">=</span> <span class=\"token string\">'Mutation'</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> main<span class=\"token operator\">=</span><span class=\"token string\">\"PCA for Transcripts Per Kilobase Million (TPM Matrix)\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 652px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8ElEQVQ4y51U3W6zMAzt+z/aLnb3SZXGt9EfaCEkJgQo9O9MdgNNoaumVbJqh+TExz7OAgCMMUiSBGmaYrVaibG/2WwQr9cSs89rcRyL1XWN8/ksdr1eGUb+F6fTCU3TwForVlXV3coS9dcnKuckDr8TEbTW4j8AssOARVHIhpnl+WPs9zGrHwHbth03zYzoMS7L0f8bYAisclD0MV7yFPByuUiBX4KNpmHy/AHQVhUj3QG5S865XwLeMiXvl8agdU6ABrtTLorbgZC6fgLIjfFgK6UQG0L4WxwOBxy6Dnoo/rQJP5gjQqwUPonQ90dUdS3UF0prHJ2Djr9uHcyzW61egDHlxEuoa1u4XYpNFIleF7v9Hm1VwaQJjLUoow+Q1iLcEYDrFsQlEd6zXCgfmwaR1ljydG23nvKhQzHUb0p5Iift6ZaDbKxFD+A81HCuQ5rrb3LJMldjAqNsuMszQL75fwSj1AhEqxi020l9OTtrDN6zDG/7THzrhf0gG57lMUNuSkgzy2AGSQVNWfOaz3D22vD4TClSICOaUOa44tfGmL/Pcukz02GDXj0OM60F88pAqdbYef9XgMWkTtprsbRWdPovV1gqJZIpAjZPAbmO/OLwy8OLfd/LJV3XyaFtksDSbWZ5D2uXv/He4cwA+A0xaPg7QLZp6QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PCA plot\"\n        title=\"PCA plot\"\n        src=\"/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png\"\n        srcset=\"/static/49f688c674adf0d190c84c877f5b32ca/63868/fig2.png 250w,\n/static/49f688c674adf0d190c84c877f5b32ca/0b533/fig2.png 500w,\n/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png 652w\"\n        sizes=\"(max-width: 652px) 100vw, 652px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Simple Boxplot</h2>\n<p>This is non-group boxplot, like showing values across various groups.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\n\ndf <span class=\"token operator\">&lt;-</span> data.frame<span class=\"token punctuation\">(</span>CF<span class=\"token operator\">=</span>CF<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> pheno<span class=\"token operator\">=</span>RF<span class=\"token operator\">$</span>cohort<span class=\"token punctuation\">)</span>\ndf<span class=\"token operator\">$</span>Label<span class=\"token operator\">&lt;-</span>factor<span class=\"token punctuation\">(</span>df<span class=\"token operator\">$</span>pheno<span class=\"token punctuation\">,</span> levels<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"TC\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AC\"</span><span class=\"token punctuation\">,</span>  <span class=\"token string\">\"LCNEC\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># Reorder x axis by specify value</span>\n\np <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>Label<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>CF<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>Label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    geom_boxplot<span class=\"token punctuation\">(</span>notch<span class=\"token operator\">=</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    geom_jitter<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> position<span class=\"token operator\">=</span>position_jitter<span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    scale_color_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#6c6c6c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#ff0200\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#4ab7ff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    labs<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span><span class=\"token string\">\"Epithelial\"</span><span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token string\">\"Cell Type Fraction\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme<span class=\"token punctuation\">(</span>plot.margin<span class=\"token operator\">=</span>unit<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"cm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> plot.title <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>hjust <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme_light<span class=\"token punctuation\">(</span>base_size <span class=\"token operator\">=</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The <code class=\"language-text\">df</code> object looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\n             CF pheno Label\nUCL61 <span class=\"token number\">0.6014421</span>    TC    TC\nUCL03 <span class=\"token number\">0.6345701</span>    AC    AC\nUCL04 <span class=\"token number\">0.4571514</span>    TC    TC\nUCL06 <span class=\"token number\">0.5656207</span>    TC    TC\nUCL07 <span class=\"token number\">0.7100541</span> LCNEC LCNEC\nUCL39 <span class=\"token number\">0.7085020</span> LCNEC LCNEC\n<span class=\"token operator\">></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 694px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7c33479b8deb8b5dbcd026b1f18672bc/31198/figure3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJklEQVQ4y41UyY7rIBD0//9aLnPJJVIO8WS1J/ESbPBC11OBIWSZp0Ei0O1OUb1mAHA+n/H19YXVaoWqqqiCtRYi8qfNFc6MP9M0YZ5nB6K1djLv1LmdyDbokv0GSOOwhmGIH90aR0CpKEryZ66PgFQG+saYhzs07HuI0e4OEcxW0A6CyYqXf2MYFASM8aNhdYM0jftGkH4SVEZQG4GZxYUgZZ0xXiPdAtD3vUuKCwEBuw44nSBFAag7htFitIB1HgB6+sCQYEwEQW63GzabjZenCXK/e5f5gO5hlMbPAJRa0AxAPSwMk2w7QApkt91usV6vURQFRmOAuobkOwiTcm8x9AbVCJQ93QbakeGaHwkTQXY8HqO7ZHg4HNC2rQcsS8jxAPn+dm4L40vbSTAwftYza9s7rterZ1iWJUIt8r7b7Rw4XUbT+ISw2OuaNeUfnxYXF1eLywX7/d4zPJ1OMbDMcF3XsS4ZO7le/ZYHiBp9+VBmgvT+iEueQ3UdsjzPY2fwbJrmUZcE1RrCYg8PPAFal5RGC4qfGy6XMzK1dAENCdh1XWSyBBdg+YTCFu/ya6eE9dYpoa+fOoV7edS6bnkMDm+LKGefJkvoWVDPWmSCYvEmbfmp9agIneIYpODAx3FlXxg+AXK6sDPejHmSpFKwL0mxyfnf8RWM0iWM0asuGV/pf5+SEsqGjHn/6/6VYQBkGQVDGrGMOqUie9qwGdieqUcB8B+0fyUS4KUY6wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Boxplot plot\"\n        title=\"Boxplot plot\"\n        src=\"/static/7c33479b8deb8b5dbcd026b1f18672bc/31198/figure3.png\"\n        srcset=\"/static/7c33479b8deb8b5dbcd026b1f18672bc/63868/figure3.png 250w,\n/static/7c33479b8deb8b5dbcd026b1f18672bc/0b533/figure3.png 500w,\n/static/7c33479b8deb8b5dbcd026b1f18672bc/31198/figure3.png 694w\"\n        sizes=\"(max-width: 694px) 100vw, 694px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Group Boxplot</h2>\n<p>This is a nice way to show a groups of boxplot, for example in my case, I have 4 cell types to show. And for each cell type, there is a list of phenotype to show boxplot.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">\"ggplot2\"</span><span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span><span class=\"token string\">\"ggpubr\"</span><span class=\"token punctuation\">)</span>\n\ndf <span class=\"token operator\">&lt;-</span> list<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token keyword\">in</span> colnames<span class=\"token punctuation\">(</span>CF<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    df<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;-</span> data.frame<span class=\"token punctuation\">(</span>CF<span class=\"token operator\">=</span>CF<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> pheno<span class=\"token operator\">=</span>RF<span class=\"token operator\">$</span>cohort<span class=\"token punctuation\">,</span> Label<span class=\"token operator\">=</span>factor<span class=\"token punctuation\">(</span>RF<span class=\"token operator\">$</span>cohort<span class=\"token punctuation\">,</span> levels<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"TC\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AC\"</span><span class=\"token punctuation\">,</span>  <span class=\"token string\">\"LCNEC\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> CellType<span class=\"token operator\">=</span>i<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\ndf <span class=\"token operator\">&lt;-</span> do.call<span class=\"token punctuation\">(</span><span class=\"token string\">\"rbind\"</span><span class=\"token punctuation\">,</span> df<span class=\"token punctuation\">)</span>\n\np <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>Label<span class=\"token punctuation\">,</span> CF<span class=\"token punctuation\">,</span>color<span class=\"token operator\">=</span>Label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    geom_boxplot<span class=\"token punctuation\">(</span>notch<span class=\"token operator\">=</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n    geom_jitter<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> position<span class=\"token operator\">=</span>position_jitter<span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    facet_wrap<span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>CellType<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    scale_color_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#6c6c6c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#ff0200\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#4ab7ff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    labs<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span><span class=\"token string\">\"Cell Fraction from EpiSCORE\"</span><span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token string\">\"Cell Type Fraction\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme<span class=\"token punctuation\">(</span>plot.margin<span class=\"token operator\">=</span>unit<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"cm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> plot.title <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>hjust <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    stat_compare_means<span class=\"token punctuation\">(</span>method <span class=\"token operator\">=</span> <span class=\"token string\">\"anova\"</span><span class=\"token punctuation\">,</span> label.y <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">\"p.format\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Below is how the <code class=\"language-text\">df</code> looks like:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> dim<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">508</span>   <span class=\"token number\">4</span>\n<span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\n                        CF pheno Label   CellType\nEpithelial.UCL61 <span class=\"token number\">0.6014421</span>    TC    TC Epithelial\nEpithelial.UCL03 <span class=\"token number\">0.6345701</span>    AC    AC Epithelial\nEpithelial.UCL04 <span class=\"token number\">0.4571514</span>    TC    TC Epithelial\nEpithelial.UCL06 <span class=\"token number\">0.5656207</span>    TC    TC Epithelial\nEpithelial.UCL07 <span class=\"token number\">0.7100541</span> LCNEC LCNEC Epithelial\nEpithelial.UCL39 <span class=\"token number\">0.7085020</span> LCNEC LCNEC Epithelial\n<span class=\"token operator\">></span></code></pre></div>\n<p>Note that here the <code class=\"language-text\">stat_compare_means()</code> function is using Anova method.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 788px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/844793a1b1a619b928ee788cb99331a4/ea7fb/figure4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC1klEQVQ4y31U23KbMBD1/39IZ9K0k0z7nPahmfQh4ySlaWuDDTY3CSQBBt+A2Kez65DaiV1mlhVCe3R290g9ANhut2/sf8+xtZ3vnQouioKtLEv2WZYhTVM8te3RDbqnR6+6rpEkCVsYhhgMBmyO48B1XYzHY9i2zTYYDhGEIVJaLyXHHjCkV9M0DCalfDFio5SCMYbZRQSiNaTnIfGnCGWCKBanASmQAAiIxlpr/iYw8v1+H1IILO/vkY9GGJVbeNkazSlAAnI9D8PBAFopBiHL8xxBEODd2RkcywJub7GgMmQrTFV1nCFNdgDMjlh1DPOcS2BZFs8Vj48oPBehyiCTFG3TvAXcbDYc5Ps+szPEMkmQEqAxvIkQAorKMplACYFEG8hUHU+ZAH9aFj5cXCCzbeDzJxRjF3/SCkLlyJ/rSAx1EEBJCW12GTR7DMl6q9UKi8UC0+kU/bs7GCFRfr+BimLcyTXctEKRGQgC0RqGMiDgZ1sslyir+T+G8/mcJcPyMLtAX4gX+RALCuxkRRqMooi/qSQzoyEnk07hO0AKoMW0kDrq2Db7OI5ZvBRMYxL9yHHgeR5EHENIgZnOENouyqraMaQOEyjprTOSSqfF/XnKgLpusmyXvtZYNS2oLZunJ2xf65AY0O5qT4fdSaEa+2EIHcfcZaV3B6Hr8kvK5Nu2ZUCSzWQyORB2B0gloA1JTjyvFbRKD4S93Rc2BdGtwqk+H0NO2RgugWSpGBjbholCOGkJW+RomyM6JIZUdLpdiClrjbqXpDBZzhfD2fk5PNvG5usXVL9/45dpMJAVmteA3eDHwwM+Xl5COzaa8/cwrodxXkPmFV8K366vEfg+Zjc3yIYDxCbnzZvmxOUQRxGGjoNCSsyvrmAiASutEWQLVOWM06fUNasgQ5xqpEpzdm8Auwk6ghsAa5IBgOW8Qts2/I82ZV/XvG69WqFerw+OHQH+BVxT7S/Vd0U6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Grouped Boxplot plot\"\n        title=\"Grouped Boxplot plot\"\n        src=\"/static/844793a1b1a619b928ee788cb99331a4/ea7fb/figure4.png\"\n        srcset=\"/static/844793a1b1a619b928ee788cb99331a4/63868/figure4.png 250w,\n/static/844793a1b1a619b928ee788cb99331a4/0b533/figure4.png 500w,\n/static/844793a1b1a619b928ee788cb99331a4/ea7fb/figure4.png 788w\"\n        sizes=\"(max-width: 788px) 100vw, 788px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Boxplot with ggarange, alpha, margin twisted.</h2>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">    oneDMR<span class=\"token operator\">$</span>middleMethylated <span class=\"token operator\">&lt;-</span> as.numeric<span class=\"token punctuation\">(</span>oneDMR<span class=\"token operator\">$</span>y1 <span class=\"token operator\">>=</span> <span class=\"token number\">0.4</span> <span class=\"token operator\">&amp;</span> oneDMR<span class=\"token operator\">$</span>y1 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">)</span>\n\n    pScatter <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>oneDMR<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>x0<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>y1<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>cellline<span class=\"token punctuation\">,</span> alpha<span class=\"token operator\">=</span>middleMethylated<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        geom_point<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        labs<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span>qdapRegex<span class=\"token operator\">::</span>ex_between<span class=\"token punctuation\">(</span>oneDMR<span class=\"token operator\">$</span>chr<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\":\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        scale_color_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#6c6c6c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#ff0200\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#4ab7ff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        scale_alpha<span class=\"token punctuation\">(</span>guide <span class=\"token operator\">=</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        theme_bw<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        theme<span class=\"token punctuation\">(</span>plot.margin<span class=\"token operator\">=</span>unit<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"cm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    pBoxplot <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>oneDMR<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>cellline<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>y1<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>cellline<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        geom_boxplot<span class=\"token punctuation\">(</span>notch<span class=\"token operator\">=</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>\n        geom_jitter<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> position<span class=\"token operator\">=</span>position_jitter<span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>alpha <span class=\"token operator\">=</span> middleMethylated<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        scale_color_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#6c6c6c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#ff0200\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#4ab7ff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        scale_alpha<span class=\"token punctuation\">(</span>guide <span class=\"token operator\">=</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        labs<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span>i<span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token string\">\"Methylation Status\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        theme_bw<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        theme<span class=\"token punctuation\">(</span>plot.margin<span class=\"token operator\">=</span>unit<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"cm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> plot.title <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>hjust <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n        stat_compare_means<span class=\"token punctuation\">(</span>method <span class=\"token operator\">=</span> <span class=\"token string\">\"anova\"</span><span class=\"token punctuation\">,</span> label.x <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> label.y <span class=\"token operator\">=</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> label <span class=\"token operator\">=</span> <span class=\"token string\">\"p.format\"</span><span class=\"token punctuation\">)</span>\n\n    A <span class=\"token operator\">&lt;-</span> ggarrange<span class=\"token punctuation\">(</span>pBoxplot<span class=\"token punctuation\">,</span> pScatter<span class=\"token punctuation\">,</span>\n              ncol <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> nrow <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n              heights <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              common.legend <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> legend <span class=\"token operator\">=</span> <span class=\"token string\">\"bottom\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The oneDMR object is below:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>oneDMR<span class=\"token punctuation\">)</span>\n                                               chr        x0        x1\n<span class=\"token number\">377</span> MEG3_Upstream_Merge\\nchr14<span class=\"token operator\">:</span><span class=\"token number\">100824186</span><span class=\"token operator\">-</span><span class=\"token number\">100828287</span> <span class=\"token number\">100824186</span> <span class=\"token number\">100824186</span>\n<span class=\"token number\">379</span> MEG3_Upstream_Merge\\nchr14<span class=\"token operator\">:</span><span class=\"token number\">100824186</span><span class=\"token operator\">-</span><span class=\"token number\">100828287</span> <span class=\"token number\">100824187</span> <span class=\"token number\">100824187</span>\n<span class=\"token number\">381</span> MEG3_Upstream_Merge\\nchr14<span class=\"token operator\">:</span><span class=\"token number\">100824186</span><span class=\"token operator\">-</span><span class=\"token number\">100828287</span> <span class=\"token number\">100824188</span> <span class=\"token number\">100824188</span>\n<span class=\"token number\">383</span> MEG3_Upstream_Merge\\nchr14<span class=\"token operator\">:</span><span class=\"token number\">100824186</span><span class=\"token operator\">-</span><span class=\"token number\">100828287</span> <span class=\"token number\">100824189</span> <span class=\"token number\">100824189</span>\n<span class=\"token number\">385</span> MEG3_Upstream_Merge\\nchr14<span class=\"token operator\">:</span><span class=\"token number\">100824186</span><span class=\"token operator\">-</span><span class=\"token number\">100828287</span> <span class=\"token number\">100824207</span> <span class=\"token number\">100824207</span>\n<span class=\"token number\">387</span> MEG3_Upstream_Merge\\nchr14<span class=\"token operator\">:</span><span class=\"token number\">100824186</span><span class=\"token operator\">-</span><span class=\"token number\">100828287</span> <span class=\"token number\">100824208</span> <span class=\"token number\">100824208</span>\n           y1 strand cellline                 dmr middleMethylated\n<span class=\"token number\">377</span> <span class=\"token number\">0.3000000</span>      <span class=\"token operator\">+</span>  GM12878 MEG3_Upstream_Merge                <span class=\"token number\">0</span>\n<span class=\"token number\">379</span> <span class=\"token number\">0.7058824</span>      <span class=\"token operator\">-</span>  GM12878 MEG3_Upstream_Merge                <span class=\"token number\">0</span>\n<span class=\"token number\">381</span> <span class=\"token number\">0.7000000</span>      <span class=\"token operator\">+</span>  GM12878 MEG3_Upstream_Merge                <span class=\"token number\">0</span>\n<span class=\"token number\">383</span> <span class=\"token number\">0.7058824</span>      <span class=\"token operator\">-</span>  GM12878 MEG3_Upstream_Merge                <span class=\"token number\">0</span>\n<span class=\"token number\">385</span> <span class=\"token number\">0.3333333</span>      <span class=\"token operator\">+</span>  GM12878 MEG3_Upstream_Merge                <span class=\"token number\">0</span>\n<span class=\"token number\">387</span> <span class=\"token number\">0.7857143</span>      <span class=\"token operator\">-</span>  GM12878 MEG3_Upstream_Merge                <span class=\"token number\">0</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c765cc8a1941535d57f701fc720dcdd8/5bb38/figure5.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 142.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe/ENIBDSD//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAEFAk//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ak//xAAZEAADAQEBAAAAAAAAAAAAAAAAEBEBQXH/2gAIAQEAAT8hIo+l9W6Vf//aAAwDAQACAAMAAAAQUMAM/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAIRAAAwABAgcBAAAAAAAAAAAAAAERITFhEEFRcYGRocH/2gAIAQEAAT8QecCRNvONyj79SWq8uglEkN6M+iFfxwgruK/Pwp//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"complex boxplot plot\"\n        title=\"complex boxplot plot\"\n        src=\"/static/c765cc8a1941535d57f701fc720dcdd8/a2510/figure5.jpg\"\n        srcset=\"/static/c765cc8a1941535d57f701fc720dcdd8/0479a/figure5.jpg 250w,\n/static/c765cc8a1941535d57f701fc720dcdd8/41099/figure5.jpg 500w,\n/static/c765cc8a1941535d57f701fc720dcdd8/a2510/figure5.jpg 1000w,\n/static/c765cc8a1941535d57f701fc720dcdd8/c58a3/figure5.jpg 1500w,\n/static/c765cc8a1941535d57f701fc720dcdd8/3acf0/figure5.jpg 2000w,\n/static/c765cc8a1941535d57f701fc720dcdd8/5bb38/figure5.jpg 4200w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"July 12, 2020","slug":"/notes/My-ggplot2-Plots-Code","title":"My ggplot2 Plots Code","tags":["R","ggplot2","visualisation"],"abstract":"This is a note to record my quick code to draw comparaibily nice figure with ggplot2."}}},"pageContext":{"slug":"/notes/My-ggplot2-Plots-Code"}},
    "staticQueryHashes": ["63159454"]}