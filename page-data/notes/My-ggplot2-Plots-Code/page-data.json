{"componentChunkName":"component---src-templates-note-template-js","path":"/notes/My-ggplot2-Plots-Code","result":{"data":{"markdownRemark":{"html":"<p>I used to only use pure R code to draw plots, it's not bad, but ggplot2 indeed do much better than I do. But it's not very easy to remember code from ggplot2. So here I record a bit code I used. Or better, form them into functions or even a small personal use R visualisation package in the future.</p>\n<h3>Histogram</h3>\n<p>For example, histogram could be used to check p value quickly.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">'ggplot2'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#head(DEG$pvalue)</span>\n\n<span class=\"token comment\">#[1] 7.459678e-33 5.611091e-31 5.081911e-23 4.894006e-21 1.068582e-20</span>\n<span class=\"token comment\">#[6] 1.921252e-20</span>\n\nggplot<span class=\"token punctuation\">(</span>DEG<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>pvalue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> geom_histogram<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> theme_minimal<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> labs<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span><span class=\"token string\">\"p value histogram\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 652px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAByUlEQVQ4y61UuaoCQRDcbxQvvANFDDQ0FTQxFkz8BA0VFG9DRbwCTxAEQUw0EO+j3uuGWdeTt49tKLZnZ7a6q3ZmJPzGfr/HYrFgzGYzxvl8pincbjeoCelwOOB0OmG9XmO328kTRHS9XvkpoBx/mpNEJ+VyGcPhkPPL5fKwWA0kIalarWI8HnP+XF0VIcnVlJA8FISj0eiB8JuHz5A91Fyy+CmaER6PRyap1WpfJVP+l7G0Wq2YpFKpvBD+q0Pa0JoSKiUrPfyrxBfJ4qdks1kkEglVHSqPqXhK9DFFOp1GNBp9WERHUOBd19SMGNMB4Q6F5EKhAK/Xi8FgANrsopAyRCdCFfk+n885LxaL2G63d8JSqQSTyQS/349gMIhIJIJcLod6vY7JZIJ+v883Uq/XkwuQTcvlkvNkMonNZnOXTBXsdjs8Hg9cLhccDgdsNhssFgvcbjcCgQDC4TBCoRBisRgTxONxZDIZpFIp2S6J/KHI5/MwGAxM5nQ6GZQLcqvVygqoAK3T6/Uwm80wGo3Q6XTw+XyYTqf3Dqn1ZrOJTqeDdruNVqvFoJzQ7XZZLs1TThA5vW80GnzjS89GfwoyXHmjvwtS+wPj9M8UbimrTwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"P value Histogram\"\n        title=\"P value Histogram\"\n        src=\"/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png\"\n        srcset=\"/static/1f4f01f1614a299e4bd9a71f6932d750/63868/fig1.png 250w,\n/static/1f4f01f1614a299e4bd9a71f6932d750/0b533/fig1.png 500w,\n/static/1f4f01f1614a299e4bd9a71f6932d750/dba9a/fig1.png 652w\"\n        sizes=\"(max-width: 652px) 100vw, 652px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>PCA plot</h3>\n<p>The <a href=\"https://cran.r-project.org/web/packages/ggfortify/vignettes/plot_pca.html\">ggfortify</a> is a easy to use and beautiful tool for PCA visualisation. However, it seems the origin data must be data.frame format.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggfortify<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># TPM must be a data frame.</span>\ndf <span class=\"token operator\">&lt;-</span> TPM<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token punctuation\">(</span>ncol<span class=\"token punctuation\">(</span>TPM<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\npca_res <span class=\"token operator\">&lt;-</span> prcomp<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> scale. <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">)</span>\n\nautoplot<span class=\"token punctuation\">(</span>pca_res<span class=\"token punctuation\">,</span> data <span class=\"token operator\">=</span> TPM<span class=\"token punctuation\">,</span> colour <span class=\"token operator\">=</span> <span class=\"token string\">'Mutation'</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> main<span class=\"token operator\">=</span><span class=\"token string\">\"PCA for Transcripts Per Kilobase Million (TPM Matrix)\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 652px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAB+klEQVQ4y51V227CMAzt///ZnniYNCHR9QJltNAmvZcKqHecJSy9wCYqGTdNcmIfHweH8Egpabvd0n6/J8/zlO12OwrDkFzfJw8WBAFFUUSu6yory5Jutxtdr1cahoFhlHf4Q9M0aoFtVVUpX4c+VdaYPVue5ySEUN9GgPzSti2laUpZls0tjsdjvY7B2BdFMQfsuu6+aGagYzTWkb0OaBuik5+b54D8wxz+CWYsiUeA+RSQi1LX9WyjnKR6H8ucpKYih2+42gAatP2mjHTUBiv1KQ1qzIXhA2DRKaUA3n4cBjv3PWX3COS/Ui+xLgTgGgdcLheqoRQVYXw80qVrKQv8nwqeTqMol4yji7WEOvDfACNisYM6J0J3dHVFYrclUZSUuxuS6Qmc5SP+bE4LvK+SI3k4vAdgAPAPdFOEbnO4IOezTnkpsimPOl2pOS1R5Rap9lxotOJch1MOeWx9YyAXkaX6MJYNGdlwUUaA4FD6HglwYoAkqJCHLzWnhAygVZLQW5yod6PD4WGnoHeFllBmhGwO0Gs4Sh8VFkudwsLm22PUq3YRzHgi8lLPv9zLUltmFefp5fCo9XgTAx3hY/1u5p8Cpqb1NIiJWCLlFpvWqOw7tFcBKLXux0VAwyN7vtZ7tCLrkz3fzAcUSopMyeOKeQ6AL+Wlv4Bvc/H30kl5204AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PCA plot\"\n        title=\"PCA plot\"\n        src=\"/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png\"\n        srcset=\"/static/49f688c674adf0d190c84c877f5b32ca/63868/fig2.png 250w,\n/static/49f688c674adf0d190c84c877f5b32ca/0b533/fig2.png 500w,\n/static/49f688c674adf0d190c84c877f5b32ca/dba9a/fig2.png 652w\"\n        sizes=\"(max-width: 652px) 100vw, 652px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Simple Boxplot</h3>\n<p>This is non-group boxplot, like showing values across various groups.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\n\ndf <span class=\"token operator\">&lt;-</span> data.frame<span class=\"token punctuation\">(</span>CF<span class=\"token operator\">=</span>CF<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> pheno<span class=\"token operator\">=</span>RF<span class=\"token operator\">$</span>cohort<span class=\"token punctuation\">)</span>\ndf<span class=\"token operator\">$</span>Label<span class=\"token operator\">&lt;-</span>factor<span class=\"token punctuation\">(</span>df<span class=\"token operator\">$</span>pheno<span class=\"token punctuation\">,</span> levels<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"TC\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AC\"</span><span class=\"token punctuation\">,</span>  <span class=\"token string\">\"LCNEC\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># Reorder x axis by specify value</span>\n\np <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>Label<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>CF<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>Label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    geom_boxplot<span class=\"token punctuation\">(</span>notch<span class=\"token operator\">=</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    geom_jitter<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> position<span class=\"token operator\">=</span>position_jitter<span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    scale_color_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#6c6c6c\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#ff0200\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#4ab7ff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    labs<span class=\"token punctuation\">(</span>title<span class=\"token operator\">=</span><span class=\"token string\">\"Epithelial\"</span><span class=\"token punctuation\">,</span> x<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> <span class=\"token string\">\"Cell Type Fraction\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme<span class=\"token punctuation\">(</span>plot.margin<span class=\"token operator\">=</span>unit<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"cm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> plot.title <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>hjust <span class=\"token operator\">=</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme_light<span class=\"token punctuation\">(</span>base_size <span class=\"token operator\">=</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The <code class=\"language-text\">df</code> object looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\n             CF pheno Label\nUCL61 <span class=\"token number\">0.6014421</span>    TC    TC\nUCL03 <span class=\"token number\">0.6345701</span>    AC    AC\nUCL04 <span class=\"token number\">0.4571514</span>    TC    TC\nUCL06 <span class=\"token number\">0.5656207</span>    TC    TC\nUCL07 <span class=\"token number\">0.7100541</span> LCNEC LCNEC\nUCL39 <span class=\"token number\">0.7085020</span> LCNEC LCNEC\n<span class=\"token operator\">></span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 694px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7c33479b8deb8b5dbcd026b1f18672bc/31198/figure3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACIklEQVQ4y41Ui6rqMBDs/3+dIIIgHhUVrdra1tY+k7k7SZMTe1TuQmmy2czOvhJB5H6/Y7FYYDabIY5jqqCUgtb6vz6KW0fcDMNgACht26LrOrPnx7OBe/5D3Xin7/sX0ChkQ3FgXuQiHg+Eokbb6d2PDH24NGoa6Kqya60MWNFqNL2mwtz9yrARABrBAQo7fb1asqJ49hbw3mhZ4y8gFQRxYLfbzYRtDISZVAn6fAaKHH3boVX4dS5++9G5ByS75/NpPBVFgeVyaf7Gc1lC1zU00yHJ7x4lbq34qCzDtPkN2VeZYJRaLu73e8znc5xOJ7MnK73ZQKeprAv0ZYVcwkxqAoqqsyGHEq3Xaw9IZsfjEXmeo5HiQIA0Qz4eoC8XX5xa8thKQtXIqhT9WdLCaKPD4QBX6SzLsN1uUUqopuriQIsOSQI5NOFjBLStYwuXpQn2u53JZ7SThSsCQcmOzeq7n6DXi10rC1IJYDfYtmGztfEV8c8GaZ4hWq1WvpkdIPe+D7mWPOuxvQhSdRaQNpygUvgkeYlLfEb0YJ+NueCFSvLxMinMpTgZKZsOYS+6YRkGZVj7okwnxc2pbwVOCtsneADCh+NP27ybRy80IhhZBmfhK/NxUt55d3lUk+fqHcMXQPbgW0CCSUHUWBQ9nn0FDEOYGviwwyJN0vL1+WL/udfGPbCunaZ7p/vI0BlzSpwx9XTAkQxtOGaJTI/ThVH+AwkwJLtGhSX3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PCA plot\"\n        title=\"PCA plot\"\n        src=\"/static/7c33479b8deb8b5dbcd026b1f18672bc/31198/figure3.png\"\n        srcset=\"/static/7c33479b8deb8b5dbcd026b1f18672bc/63868/figure3.png 250w,\n/static/7c33479b8deb8b5dbcd026b1f18672bc/0b533/figure3.png 500w,\n/static/7c33479b8deb8b5dbcd026b1f18672bc/31198/figure3.png 694w\"\n        sizes=\"(max-width: 694px) 100vw, 694px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"July 12, 2020","slug":"/notes/My-ggplot2-Plots-Code","title":"My ggplot2 Plots Code","abstract":"This is a note to record my quick code to draw comparaibily nice figure with ggplot2."}}},"pageContext":{"slug":"/notes/My-ggplot2-Plots-Code"}}}