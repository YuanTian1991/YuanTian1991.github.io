{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Learning-Machine-Learning-2:-Model-Selection",
    "result": {"data":{"markdownRemark":{"html":"<p>This is the second chapter of this <a href=\"https://github.com/Mikoto10032/DeepLearning/blob/master/books/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%91%A8%E5%BF%97%E5%8D%8E.pdf\">\"watermelon book\"</a>. It's about <strong>Model Selection</strong>, which means critiral we should follow to judge if a model is good or not after we trained the machine learning model.</p>\n<h2>1. Overfit and Underfit</h2>\n<p>Overfit means the model captured <strong>too detail features</strong> from training samples, that it perform well on training data, but not well on test data. We hope a good model have the capability of <strong>generalization</strong>, which means it should be able to learn \"general\" features from training data. then apply these feature on future test data.</p>\n<p>Another issue is underfit, it directly means the model is good enough, and can't capture correact (or enough) feature for model creation. Generally, underfit is easiler to deal with, can be improved by actions like: expend more in decision tree; increase iteration number in neual network .etc</p>\n<h2>2. Estimate Approach</h2>\n<h3>2.1. Cross Validation</h3>\n<p>Cross Validation is a common way to separate whole sampls into multiple training and testing sets. For example, divide whole samples into 10 groups, then each time select one group as testing, and the other 9 as training. Then, we need to train 10 models and test 10 times on each group. The final result is the mean value among 10 test data. Above sample is 10-fold cross validation.</p>\n<p>I have used leave-one-out in my research, which can be used to <strong>reclassify samples</strong>, for example, test if histopathology classification is correct enough. However, if there are too many samples, leave-one-out apprently is not suitable.</p>\n<h3>2.2. Performance Measure</h3>\n<p>For regression tasks, the most common measurement is <code class=\"language-text\">mean squared error</code>: <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi><mo stretchy=\"false\">(</mo><mi>f</mi><mo separator=\"true\">;</mo><mi>D</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>m</mi><mo>∗</mo><mo>∑</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">E(f;D) = 1/m * \\sum(f(x_i) - y_i)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><code class=\"language-text\">Error Rate</code> is <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi><mo>=</mo><mi>a</mi><mi mathvariant=\"normal\">/</mi><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">E=a/m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">m</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span></span> is total samples, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span></span> is number of wrongly identifed samples among <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span></span>.</p>\n<p><code class=\"language-text\">Accuracy</code> is <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>−</mo><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">1 - Error Rate</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">rror</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span></span></span></span></span>.</p>\n<p>There are two kinds of error. Error happen on training data is called \"training error\", while error happen on new samples is called \"generalization error\"</p>\n<p><code class=\"language-text\">Precision</code> means among all samples estimated TRUE, how many of them are really TRUE.</p>\n<p><code class=\"language-text\">Recall</code> means among all samples are really TRUE, how many of them are identified TRUE.</p>\n<p>Normally, you can't each both high Precision and high recall at the same time. Based on precision and recall, a plot called P-R plot can be generated as below. The way to judge a model good or not is to see if this model's P-R curve and \"cover\" other curves. There are many packages in R to draw this curve, for example <a href=\"https://cran.r-project.org/web/packages/PRROC/vignettes/PRROC.pdf\">PRROC</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 870px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/10a2e8058eabe2efdbfaf207179f4c3a/3f3b9/figure1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.80000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0klEQVQ4y3VTa6+iMBD1//+1zX5xc1fFRERA4MpLHn23ZzNFCOLeSRomQ+f0zDntDgCcc5i/QgiIYYBknAq+brWBcdbnxlqMjMEYgznmfordXJiLTdPgfDzi8nVA+PeAIrqhTFKMVQ3HBXjXIYkiMCFgjYG19g10twajeD6fGMfR54yNKMsSeZbhdrmgzAv0j290UYQxiqGUhNsCbkeu6xrPpoERAlpIOK0hGUOWpijyHFl8Q/LrN9pDAKv11PsiRWthOC9i2LUtrFJQUkARsBQwSoGzEfmfL3Rphqos0WQ5tpLt1uyqqvIjDsMw1axdNhutoQSHHAY8vgsMXYdHmoK95PlgSHG/3z1DzvmbLgTsWRoDLaVnTQf3ZYkkDOGmzZ+AWmuv4WwKVclJGnfZIyYZlJTe/TovfjZl67LRyi+3GomMkpx5Q9qmQR5efx55dpkxNo3wuhLrILNofEfjK43kGEBptfTvtred2DVVBSmE11KRu5x7OSgfaIK+86ZopRAeT5BSvgOuWVIzudy2LZIk8Xmapojj2C/K6R99+75HURT+oA/ArZbboCdJQP97v25rypblfr/H6XTyemZZhvP57BnRtbper55VEATLAeuH8Q8ObUG75dKMFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"P-R curve\"\n        title=\"P-R curve\"\n        src=\"/static/10a2e8058eabe2efdbfaf207179f4c3a/3f3b9/figure1.png\"\n        srcset=\"/static/10a2e8058eabe2efdbfaf207179f4c3a/63868/figure1.png 250w,\n/static/10a2e8058eabe2efdbfaf207179f4c3a/0b533/figure1.png 500w,\n/static/10a2e8058eabe2efdbfaf207179f4c3a/3f3b9/figure1.png 870w\"\n        sizes=\"(max-width: 870px) 100vw, 870px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>After drawing P-R curve, we may need to find some ways to \"compare\" different curves (models). There are couple options here.</p>\n<ul>\n<li><strong>Break-Even Point (BEP)</strong>. The point P == R. So we can compare different curves by comparing this point.</li>\n<li><strong><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">F1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord\">1</span></span></span></span></span> and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>β</mi></msub></mrow><annotation encoding=\"application/x-tex\">F_\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span></strong>. <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>β</mi></msub></mrow><annotation encoding=\"application/x-tex\">F_{\\beta}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span> is important as it can adjust peference between P and R. For example, higher P is vital for advertisement, while higher R is vital for criminal searching.</li>\n</ul>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>F</mi><mi>β</mi></msub><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><msup><mi>β</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo>×</mo><mi>P</mi><mo>×</mo><mi>R</mi></mrow><mrow><mo stretchy=\"false\">(</mo><msup><mi>β</mi><mn>2</mn></msup><mo>×</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>R</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">F_ {\\beta } = \\frac{(1+\\beta ^ {2})\\times P\\times R}{(\\beta ^ {2}\\times P)+R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4271em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n<p>In the future, when I train a model, it's good to use <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>F</mi><mi>β</mi></msub></mrow><annotation encoding=\"application/x-tex\">F_\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05278em;\">β</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span> to select a poper model.</p>\n<h3>2.3. ROC and AUC</h3>\n<p>Another quite important figure for machine learning model estimation is ROC (Receiver Operating Characteristic) curve. To me this plot is quite similar to P-R curve. AUC means area under curve.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9032f2a5b06863a9d8fe9f464695938f/78612/figure2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.199999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqUlEQVQoz01SaevxURD1/T+C7GTfU94oQniBvEChCMm+78J5Ouff1TM1v/ubuXPPnFks3+8Xx+MR+/0ep9MJ6/Va9mq1QrvdRqFQwGazwe1203m5XPB8PhXb6XSQzWYRCoWwXC5BsfCz3W5xPp/lmE6nyOVyCIfDcLvdcDgcmM/nAmQiymQyQSKRgMvlktpsNsxmsz/A1+sl9MfjgcPhILB4PC4waiAQwHA4xG63Ezuyttvt8Pl8YmYS/wBZ6mAwwPV6RbVaRTKZRCqVUmY+dDqd6Ha7Ykf2Xq8XwWBQSiDaPH8lkyGD+/2++pHJZKTMHo1GFcyEjCuXywKIRCLw+/1qh0nAnv96yAaTGYNisZgYsmyefExmLNdqtYqxx+OR8p+lp9NpLBaLP0BOmQNhuaVSCZVKBfl8XtOt1Wrymx43m000Gg3U63XdF4tFtFot9ZXbIcD3+43P5yPDrAtLZJMJQmFSMuRguBG86/V6OmnTTwzqD9D0kkPitAlM5vf7Xcq2cA/JZDQaKSl9jKEaHAs//7Ok0OYjZuYOjsdjlc1E9JudJXMjBucfRbnCY2C8yWEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ROC\"\n        title=\"ROC\"\n        src=\"/static/9032f2a5b06863a9d8fe9f464695938f/00d43/figure2.png\"\n        srcset=\"/static/9032f2a5b06863a9d8fe9f464695938f/63868/figure2.png 250w,\n/static/9032f2a5b06863a9d8fe9f464695938f/0b533/figure2.png 500w,\n/static/9032f2a5b06863a9d8fe9f464695938f/00d43/figure2.png 1000w,\n/static/9032f2a5b06863a9d8fe9f464695938f/78612/figure2.png 1260w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>In theory, we hope the model to reach left-top coordinate, which means false rate is 0, but true rate is 100%. Again there are many packages to draw ROC and AUC.</p>\n<h3>2.4. Cost Sensitive Error Rate and Cost Line</h3>\n<p>In reality, different \"mistake\" have different cost. For example, one mis-diagnose may lead to death of patient. In this case, we should focus on Recall instead of Precision. The way to prevent this mistake is apply cost function. The idea is simple, which is more likely to add \"penalty\" on each kind of mistake. Then when we calculate Cost Sensitive Error Rate, include these cost/penalty. In this case, troditional ROC curve is not working here, instead we can draw Cost Line plot as below:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 804px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6aba95de2773938320e822802b07c764/27b7a/figure3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABo0lEQVQ4y3VT2+txURA9f79/gHhSlIQHL8iLvChFFCJE7vf7/ba+1qpdx/b9pqY5czlrz5o92/l8PqAYe7vdMB6Pv2K2uON2jWOCJjEcDlGpVLDdbrFer7FarWSN0meOdfy2QR07wA5ZfDwe8Xg84D7Q1J3PZ4HvdrsvQFrHOM/nUyC0i8VCsf1+rwPccjgccL1ecb/fVW8zdNynNhoNFbZaLVwuF7xeL/1kQAlGn7WTyQTtdhuz2Qzv9/u3Q0O13+8LeD6fo9PpYLPZYLlcKj6dTgU0Go3Eotvtyv8T0FAlMLVWq+mCotEoAoEA8vm8uqRwvn9SNg5pDgYDdUjAbDaLUCgEn8+HYDCISCSCTCYjmuzcNPDVob2DpNlsNlGtVhEOh9WZx+OB1+uF3++XplIp0TW37MZw7MWmFAoFxONxxGIxJBIJ2WQyKaB0Oi1lnkzYKffya4Zu2lwJzoa3TWVxqVRCsVjUZRCA8zudTuqS+8jvn0uxl9v4BOz1evqZ8yVN5rhS/3uOP4A8PZfLiQ5PJxBnSuV+lstl5er1umL2a/oHDHXTHv0s4W0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Cost Line\"\n        title=\"Cost Line\"\n        src=\"/static/6aba95de2773938320e822802b07c764/27b7a/figure3.png\"\n        srcset=\"/static/6aba95de2773938320e822802b07c764/63868/figure3.png 250w,\n/static/6aba95de2773938320e822802b07c764/0b533/figure3.png 500w,\n/static/6aba95de2773938320e822802b07c764/27b7a/figure3.png 804w\"\n        sizes=\"(max-width: 804px) 100vw, 804px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>The x axis and y axis for above plot is called Positive Probability (正概率代价) and Normalised Cost (归一化代价). The fomular is not complex. I did not found any tool in R to draw this plot.</p>\n<h2>Summary</h2>\n<p>These are some commonly used plot and measurement for machine learning model selection. In the future, for example champ.MachineLearning(), I will try draw these plot for people to estimate the performance.</p>","frontmatter":{"date":"February 06, 2022","slug":"/notes/Learning-Machine-Learning-2:-Model-Selection","title":"Learning Machine Learning-2: Model Selection","tags":["machine learning"],"abstract":"For a long time I did not systemically study machine learning, which was named as pattern reconginsation when I was in University. Now I am reading the 《机器学习》, written by a famous Chinese machine learning expert. This is the second chapter of this book, a quick introduction of Model Selection."}}},"pageContext":{"slug":"/notes/Learning-Machine-Learning-2:-Model-Selection"}},
    "staticQueryHashes": ["63159454"]}