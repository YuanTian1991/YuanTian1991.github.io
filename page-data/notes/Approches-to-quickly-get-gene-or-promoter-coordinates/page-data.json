{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Approches-to-quickly-get-gene-or-promoter-coordinates",
    "result": {"data":{"markdownRemark":{"html":"<p>Here I want to record some ways to fetch gene coordinates, annotated promoters' coordinates for Bioinformatic analysis.</p>\n<h2>1. ChIPpeakAnno with GenomicRanges</h2>\n<p>I found this package when I was working on ChIP-seq data. It works well to extract gene coordinates across whole genome. After loading <code class=\"language-text\">ChIPpeakAnno</code> and <code class=\"language-text\">TxDb.Hsapiens.UCSC.hg38.knownGene</code> packages, all gene's location could be fetched. Note you may want to use org.Hs.eg.db to re-name these genes after mapping.</p>\n<p>After fetching the gene coordinates, GenomicRanges package's nice function promoters could be used to calcualte promoter coordinates. Note that 1) There are possibily more than one promoters function in your R session (like defined by other packages), be careful that you need to use the GenomicRanges one. 2) The default promoter is defined as upstream 2000 to downsteam 200 around TSS, you can adjust the parameter.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>TxDb.Hsapiens.UCSC.hg38.knownGene<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>ChIPpeakAnno<span class=\"token punctuation\">)</span>\n\nannoData <span class=\"token operator\">&lt;-</span> toGRanges<span class=\"token punctuation\">(</span>TxDb.Hsapiens.UCSC.hg38.knownGene<span class=\"token punctuation\">,</span> feature<span class=\"token operator\">=</span><span class=\"token string\">\"gene\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># KEY CODE for gene coordicate extraction.</span>\nannoPromoter <span class=\"token operator\">&lt;-</span> GenomicRanges<span class=\"token operator\">::</span>promoters<span class=\"token punctuation\">(</span>annoData<span class=\"token punctuation\">)</span>                       <span class=\"token comment\"># Using promoters() function to get promoter regions based on last code.</span>\n\n<span class=\"token comment\"># Below is an easy way to annotate your peaks (regions) with your prepared annoData or annoPromoter.</span>\n<span class=\"token comment\"># I used peaks returned from DiffBind, but I though any GRange format data should work.</span>\nmyPeaks <span class=\"token operator\">&lt;-</span> annotatePeakInBatch<span class=\"token punctuation\">(</span>myPeaks<span class=\"token punctuation\">,</span> AnnotationData<span class=\"token operator\">=</span>annoPromoter<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Below code could help to add other gene names. For example in below example, I added entrez_id and symbol.</span>\nlibrary<span class=\"token punctuation\">(</span>org.Hs.eg.db<span class=\"token punctuation\">)</span>\nmyPeaks <span class=\"token operator\">&lt;-</span> addGeneIDs<span class=\"token punctuation\">(</span>myPeaks<span class=\"token punctuation\">,</span> <span class=\"token string\">\"org.Hs.eg.db\"</span><span class=\"token punctuation\">,</span> IDs2Add <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"entrez_id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'symbol'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Below is the annotated results, it looks good. Note that the <strong>insideFeature</strong> will indicates the relationship between these peaks with related gene promoter location, which means maybe the peaks is NOT actually overlapped with promoters. It includes mapping results like \"upstream\", \"downsteam\", indicates this peak is located at the upstream or downsteam of promoter. You can filtering this column to get \"overlapped peaks in promoters.\"</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token operator\">:</span><span class=\"token number\">33</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n                           seqnames     start       end width strand\nX132751.<span class=\"token number\">27242.27242</span>            chr6  <span class=\"token number\">47362760</span>  <span class=\"token number\">47363260</span>   <span class=\"token number\">501</span>      <span class=\"token operator\">*</span>\nX96556.<span class=\"token number\">100500813.100500813</span>    chr20  <span class=\"token number\">44410059</span>  <span class=\"token number\">44410559</span>   <span class=\"token number\">501</span>      <span class=\"token operator\">*</span>\nX159552.<span class=\"token number\">8328.8328</span>              chr9 <span class=\"token number\">132937303</span> <span class=\"token number\">132937803</span>   <span class=\"token number\">501</span>      <span class=\"token operator\">*</span>\nX6292.<span class=\"token number\">1718.1718</span>                chr1  <span class=\"token number\">54856281</span>  <span class=\"token number\">54856781</span>   <span class=\"token number\">501</span>      <span class=\"token operator\">*</span>\nX99797.<span class=\"token number\">2114.2114</span>              chr21  <span class=\"token number\">38824108</span>  <span class=\"token number\">38824608</span>   <span class=\"token number\">501</span>      <span class=\"token operator\">*</span>\nX155442.<span class=\"token number\">10507.10507</span>            chr9  <span class=\"token number\">89525654</span>  <span class=\"token number\">89526154</span>   <span class=\"token number\">501</span>      <span class=\"token operator\">*</span>\n                                       peak   feature start_position\nX132751.<span class=\"token number\">27242.27242</span>           X132751.<span class=\"token number\">27242</span>     <span class=\"token number\">27242</span>       <span class=\"token number\">47309706</span>\nX96556.<span class=\"token number\">100500813.100500813</span> X96556.<span class=\"token number\">100500813</span> <span class=\"token number\">100500813</span>       <span class=\"token number\">44406120</span>\nX159552.<span class=\"token number\">8328.8328</span>              X159552.<span class=\"token number\">8328</span>      <span class=\"token number\">8328</span>      <span class=\"token number\">132943551</span>\nX6292.<span class=\"token number\">1718.1718</span>                  X6292.<span class=\"token number\">1718</span>      <span class=\"token number\">1718</span>       <span class=\"token number\">54886996</span>\nX99797.<span class=\"token number\">2114.2114</span>                X99797.<span class=\"token number\">2114</span>      <span class=\"token number\">2114</span>       <span class=\"token number\">38803183</span>\nX155442.<span class=\"token number\">10507.10507</span>           X155442.<span class=\"token number\">10507</span>     <span class=\"token number\">10507</span>       <span class=\"token number\">89497931</span>\n                           end_position feature_strand insideFeature\nX132751.<span class=\"token number\">27242.27242</span>            <span class=\"token number\">47311905</span>              <span class=\"token operator\">-</span>      upstream\nX96556.<span class=\"token number\">100500813.100500813</span>     <span class=\"token number\">44408319</span>              <span class=\"token operator\">+</span>    downstream\nX159552.<span class=\"token number\">8328.8328</span>             <span class=\"token number\">132945750</span>              <span class=\"token operator\">+</span>      upstream\nX6292.<span class=\"token number\">1718.1718</span>                <span class=\"token number\">54889195</span>              <span class=\"token operator\">-</span>    downstream\nX99797.<span class=\"token number\">2114.2114</span>               <span class=\"token number\">38805382</span>              <span class=\"token operator\">+</span>    downstream\nX155442.<span class=\"token number\">10507.10507</span>            <span class=\"token number\">89500130</span>              <span class=\"token operator\">-</span>      upstream\n                           distancetoFeature shortestDistance\nX132751.<span class=\"token number\">27242.27242</span>                   <span class=\"token operator\">-</span><span class=\"token number\">50855</span>            <span class=\"token number\">50855</span>\nX96556.<span class=\"token number\">100500813.100500813</span>              <span class=\"token number\">3939</span>             <span class=\"token number\">1740</span>\nX159552.<span class=\"token number\">8328.8328</span>                      <span class=\"token operator\">-</span><span class=\"token number\">6248</span>             <span class=\"token number\">5748</span>\nX6292.<span class=\"token number\">1718.1718</span>                        <span class=\"token number\">32914</span>            <span class=\"token number\">30215</span>\nX99797.<span class=\"token number\">2114.2114</span>                       <span class=\"token number\">20925</span>            <span class=\"token number\">18726</span>\nX155442.<span class=\"token number\">10507.10507</span>                   <span class=\"token operator\">-</span><span class=\"token number\">25524</span>            <span class=\"token number\">25524</span>\n                           fromOverlappingOrNearest   symbol\nX132751.<span class=\"token number\">27242.27242</span>                 NearestLocation TNFRSF21\nX96556.<span class=\"token number\">100500813.100500813</span>          NearestLocation  MIR3646\nX159552.<span class=\"token number\">8328.8328</span>                   NearestLocation    GFI1B\nX6292.<span class=\"token number\">1718.1718</span>                     NearestLocation   DHCR24\nX99797.<span class=\"token number\">2114.2114</span>                    NearestLocation     ETS2\nX155442.<span class=\"token number\">10507.10507</span>                 NearestLocation   SEMA4D\n<span class=\"token operator\">></span></code></pre></div>\n<h2>2. ChIPpeakAnno provided TSS Annotation</h2>\n<p>I found that ChIPpeakAnno provided a set of <a href=\"https://www.rdocumentation.org/packages/ChIPpeakAnno/versions/3.6.5/topics/TSS.human.GRCh38\">TSS annotation</a>. I checked that these TSS.xxx actually means the whole gene ranges, so it can be seen as whole gene coordinates.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>org.Hs.eg.db<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>ChIPpeakAnno<span class=\"token punctuation\">)</span>\n\ndata<span class=\"token punctuation\">(</span>TSS.human.GRCh38<span class=\"token punctuation\">)</span>\n\nannoPromoter <span class=\"token operator\">&lt;-</span> GenomicRanges<span class=\"token operator\">::</span>promoters<span class=\"token punctuation\">(</span>TSS.human.GRCh38<span class=\"token punctuation\">)</span>\n\nmyPeaks <span class=\"token operator\">&lt;-</span> annotatePeakInBatch<span class=\"token punctuation\">(</span>myPeaks<span class=\"token punctuation\">,</span> AnnotationData<span class=\"token operator\">=</span>annoPromoter<span class=\"token punctuation\">)</span>\nmyPeaks <span class=\"token operator\">&lt;-</span> addGeneIDs<span class=\"token punctuation\">(</span>myPeaks<span class=\"token punctuation\">,</span> <span class=\"token string\">\"org.Hs.eg.db\"</span><span class=\"token punctuation\">,</span> IDs2Add <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"entrez_id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'symbol'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>However, after above code annotation, I found a lot of difference between TSS annotate and the first annotation way.</strong> I chekced the matching, the ensembl_gene_id are similar between two annotation, but after addGeneIDs, the gene symbol varis a lot...</p>","frontmatter":{"date":"May 03, 2021","slug":"/notes/Approches-to-quickly-get-gene-or-promoter-coordinates","title":"Approches to quickly get gene or promoter coordinates","tags":["R","Annotation"],"abstract":"It is such a common requirement in Bioinformatic that we need to get gene coordinates, or promoter region location across whole genome. Here I want to record ways to do it."}}},"pageContext":{"slug":"/notes/Approches-to-quickly-get-gene-or-promoter-coordinates"}},
    "staticQueryHashes": ["63159454"]}