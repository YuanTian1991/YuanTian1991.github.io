{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Complex-ggplot2:-boxplot",
    "result": {"data":{"markdownRemark":{"html":"<h2>1. Boxplot with text above</h2>\n<p>A basic version of boxplot with ggplot2.</p>\n<ul>\n<li>This plot use <code class=\"language-text\">wesanderson</code> R package, which contains a color I really like: <code class=\"language-text\">Darjeeling1</code>.</li>\n<li>This plot shows an exmple for <code class=\"language-text\">geom_text</code>.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>wesanderson<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># df is the data.frame above</span>\n\nIQR <span class=\"token operator\">&lt;-</span> aggregate<span class=\"token punctuation\">(</span>df<span class=\"token operator\">$</span>beta<span class=\"token punctuation\">,</span> by<span class=\"token operator\">=</span>list<span class=\"token punctuation\">(</span>df<span class=\"token operator\">$</span>pheno<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> IQR<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ncolnames<span class=\"token punctuation\">(</span>IQR<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;-</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Pheno\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"IQR\"</span><span class=\"token punctuation\">)</span>\nIQR<span class=\"token operator\">$</span>colour <span class=\"token operator\">&lt;-</span> <span class=\"token string\">\"#424242\"</span>\nIQR<span class=\"token operator\">$</span>colour<span class=\"token punctuation\">[</span>IQR<span class=\"token operator\">$</span>IQR <span class=\"token operator\">>=</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;-</span> <span class=\"token string\">\"red\"</span>\n\np <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>pheno<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>beta<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>group<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    geom_boxplot<span class=\"token punctuation\">(</span>outlier.shape <span class=\"token operator\">=</span> <span class=\"token keyword\">NA</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    geom_jitter<span class=\"token punctuation\">(</span>width<span class=\"token operator\">=</span><span class=\"token number\">0.15</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    scale_color_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>wes_palette<span class=\"token punctuation\">(</span>n<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Darjeeling1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    geom_text<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span>IQR<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>Pheno<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span><span class=\"token number\">0.9</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span>round<span class=\"token punctuation\">(</span>IQR<span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> col<span class=\"token operator\">=</span>IQR<span class=\"token operator\">$</span>colour<span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">3.5</span><span class=\"token punctuation\">,</span> fontface <span class=\"token operator\">=</span> <span class=\"token string\">\"bold\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    ggtitle<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme_bw<span class=\"token punctuation\">(</span>base_size<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    theme<span class=\"token punctuation\">(</span>axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>angle <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> vjust <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> hjust <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nprint<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></code></pre></div>\n<p>The input df is looks like below:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\n           beta          pheno group\nS0008 <span class=\"token number\">0.2386364</span> Metastasis<span class=\"token operator\">-</span>All   All\nS0011 <span class=\"token number\">0.5057471</span> Metastasis<span class=\"token operator\">-</span>All   All\nS0012 <span class=\"token number\">0.5000000</span> Metastasis<span class=\"token operator\">-</span>All   All\nS0013 <span class=\"token number\">0.5178571</span> Metastasis<span class=\"token operator\">-</span>All   All\nS0014 <span class=\"token number\">0.4415584</span> Metastasis<span class=\"token operator\">-</span>All   All\nS0015 <span class=\"token number\">0.3586957</span> Metastasis<span class=\"token operator\">-</span>All   All</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 676px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c69e74bcefedca3b15594d0e7ab25470/9bb7a/figure1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACb0lEQVQ4y22US29TMRCF89MRf4E9YovYsQAWCLZICFVIFaVNRZqStMnN4z59/faHxskNSZuRfG3Ptc8cH894BBBjpG1bZrMZdV1TFEVuTdOwXq+x1rLdbnNflSWtUri6wcwfMM4JBCml3I+Gifeevu/z2DmX5xJIfGJaa1mIMQbnPVhHrBvsOUBhkjfsf5w08cVIkgBH/pg8gYg19mTfSD7CQo5zWBxjbsNYAKPWGTz/S5C8IroWaz3HNhoGcsxn7DKTRAqBtFjs5wNgSzQF1nmCSCZrhKEAdV2XtTnLcAC8m2amoiMDQzXHRWiKgsn1TdZzNB6PqapqBzgcbwAc+hBJFz9B9fQxoEMCsyTUv3DB063WTMe3tF3HaLjFkyNndnuGInjbwdU1cVsxM4q5VuA2RP2IN4bOrZnOxzzMH3caOmux3pOaRlTHxoAVoYImEknLFbx9h18UfK/XXDY1dDfE4jPGCCGRIhBiZCRsNpsNvVLw8ROpqniwPSu5PTUllj9INpK+fIWyonCarQjX/iZWF7vsYCft7pb3ueb+zuDFS+zdPfemY24jbvGB9OcVKQXS5SVYixb2skE/EporrMui/M9DQRWqtm7g9RvSYsm3es21MFa3sHi/C12VDMGzRQtBYe2TSpGB1GmvNV1Z5qvXkui9zovbtsE5T9srjLW5CJRSGGPpuj5nxzNAMclFeQhCCPlhEG3KsjwAbDebXN+r1SqvERKy57jsDpUiuSZg4pReosqrI80aky9NQJbLZU4vCST1/xTsoOGxQ8DFhKGYbJanTZr48hNWVWfBTo489E/Hwm4ymTzT6hyYMPwHO2csEezg6fMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Basic ggplot boxplot with text above\"\n        title=\"Basic ggplot boxplot with text above\"\n        src=\"/static/c69e74bcefedca3b15594d0e7ab25470/9bb7a/figure1.png\"\n        srcset=\"/static/c69e74bcefedca3b15594d0e7ab25470/63868/figure1.png 250w,\n/static/c69e74bcefedca3b15594d0e7ab25470/0b533/figure1.png 500w,\n/static/c69e74bcefedca3b15594d0e7ab25470/9bb7a/figure1.png 676w\"\n        sizes=\"(max-width: 676px) 100vw, 676px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"September 27, 2022","slug":"/notes/Complex-ggplot2:-boxplot","title":"Complex ggplot2: boxplot","tags":["ggplot2"],"abstract":"My collection of code for ggplot2 boxplot"}}},"pageContext":{"slug":"/notes/Complex-ggplot2:-boxplot"}},
    "staticQueryHashes": ["63159454"]}