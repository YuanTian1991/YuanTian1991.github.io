{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Use-TFregulomeR-to-get-Transcript-Factor-Binding-Peaks",
    "result": {"data":{"markdownRemark":{"html":"<p>Transcript factor (<code class=\"language-text\">TF</code>) are gene regulators, more specifically they are proteins that would bind on DNA sequence, and influence gene's expresion pattern. For some important transcript factors (like CTCF), they have thousands of sites to bind on DNA sequence. Since many years ago, scientists try to get these binding sites. By using ChIP-seq, scientists get use anti-body to capture all binding sequence of certain TF. Then, these sequence could be mapped to genome, so we know their locations on genome, these location cooridates are Transcript Factor Binding Sites (<code class=\"language-text\">TFBS</code>).</p>\n<h2>1. Transcript Factor Binding Sites Enrichment Analysis (TFEA)</h2>\n<p>After getting the position, many things are easier after that. From Bioniformatic point of view, if we are analying RNA-seq or DNA methylation, after comparing analysis, we get differential expression genes(DEG) and differential methylated regions(DMR). Then natually we want to know if these regions are highly targeted by some TFs. At this time, if we have certain TF's peaks (it's binding locaion on whole genome), then mapping it with our DMR/DEG. We could see the overlap status.</p>\n<p>Surely some statistic method need to be applied here to decided \"to what degree\" the enrichment of a TF in these regions could be seens as \"significantly enriched\". Among them, fisher exact test is a popular, which compare the enrichment status of ROI (regions of interest) and random regions. If the ratio varis a lot, it indicates that this TF is highly enriched in these regions.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/92235a895bf527b2fd572b534ba3c4dc/b490f/figure4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVQoz21Q226CQBDl/3+jadOHvtc+9cGmaUwThdqGSwyXiqBcBGEX3AVOM2s0SjrJZK45c85owzDg2jhjOBwOEMcGnRQY+v5mXrY9fosj/LxFzju0cgA7dmASICSNlqKkwsPExt2zjbdFBCE6PL6YmHysEXgulsYXOOdI9hz3zzbe9RDR2sfCsPD06uPzZ4uV9Y04ik6AZVnCdlZI0gyy69H3PZI0R804mqZBXdc4lCU4b5DmBeqandTwBq2QIJG0Q2o1xhiyLEOWpkiSBLvdToGMres65Tfv4Vx5VVWXmUaoYycTQpx+KYTq0eE4jpHnuSJA0fd9eJ4H13VVj5RpYyZnwLZtEYahegcZSTIMA/P5XPlyucRsNsN0OoWu67AsSx3XzgBjhiSBpBATAt/v9wiCQLHcbDbYbrdwHAemaaqc9v5leM2SIjEksKIo1AsoUk35uZZSXvb/AH/+YwMaWRVqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"FisherExact\"\n        title=\"FisherExact\"\n        src=\"/static/92235a895bf527b2fd572b534ba3c4dc/00d43/figure4.png\"\n        srcset=\"/static/92235a895bf527b2fd572b534ba3c4dc/63868/figure4.png 250w,\n/static/92235a895bf527b2fd572b534ba3c4dc/0b533/figure4.png 500w,\n/static/92235a895bf527b2fd572b534ba3c4dc/00d43/figure4.png 1000w,\n/static/92235a895bf527b2fd572b534ba3c4dc/b490f/figure4.png 1142w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>For example, below I draw two TF enrichment status. Apparently, the second one is not significant because the TF peaks are \"too avereagly distributed\" across ROI and random regions.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7ccd2fe09a5f02dbe22bd1dfebd6399d/b490f/figure5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaklEQVQoz52Q227TUBBF/f+fwiuoPCBCQaENpBJK6qSNLXyPL/Hx7Tj2iZ3Yq1JSIVr1AbGkeZnZWtIebRxH/qZTDU2zh6GD4chrRNvjlQfsvKdQJ9RpQHYD++eodg5VHXebgh/rDHtb0rQHpouIjVuQJjGBHzCOA4Xs+H4vsLYVcRRh+Sk3eoYd5ASeS13XF+FvN+bDZMH7yYI4a+mOAx+/6ehGSByFZ2FZloRJwburOauNy14WPBgOV19XOIEg2ga0TYumlKKqSsQuIhcJ+7qi73tgfJ7XXHbVSWG1MQP9i6vWtgqlGsajOv+tbWoY3xL9G+fKmeyZP+bM1hmhOHDoT9zqKaZfkYmUJE4Yh4EolUyXKV5UIdIEJ8q5fShwYkkUBkgpL0Lb33E9t7i+c1gZAXGS8nlmMvtl4nsuju0ghMD2Yj7dmKxMH0tfspj+ZPLlnselgbHWybIcbfzfel0PYgdNCbL8U/kJlxJfvKKPCWcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"EnrichmentExample\"\n        title=\"EnrichmentExample\"\n        src=\"/static/7ccd2fe09a5f02dbe22bd1dfebd6399d/00d43/figure5.png\"\n        srcset=\"/static/7ccd2fe09a5f02dbe22bd1dfebd6399d/63868/figure5.png 250w,\n/static/7ccd2fe09a5f02dbe22bd1dfebd6399d/0b533/figure5.png 500w,\n/static/7ccd2fe09a5f02dbe22bd1dfebd6399d/00d43/figure5.png 1000w,\n/static/7ccd2fe09a5f02dbe22bd1dfebd6399d/b490f/figure5.png 1142w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Above is an explaination of algorithm of TF enrichment analysis for one TF, now comes the qustion, <strong>how to get a list of TF's peak information</strong>? Without data, I can do nothing.</p>\n<h2>2. TF Database</h2>\n<p>ENCODE is a very good project that get Peaks of a lot of histones and TFs for both <a href=\"https://www.encodeproject.org/chip-seq-matrix/?type=Experiment&#x26;replicates.library.biosample.donor.organism.scientific_name=Homo%20sapiens&#x26;assay_title=Histone%20ChIP-seq&#x26;assay_title=Mint-ChIP-seq&#x26;status=released\">Human and Mouse</a>. For example, in below figure, each column is a cell type, and each row is a histone. The peaks of this histone/TF could be get by click the green block.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6f88130e70c794ca3fe18a72aacb3513/a303f/figure1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0UlEQVQoz42R/UtTcRTG798bRqVZICKbJhhac6KBrUDC6A0qhrSa29TNWrgy7WXEdGsvbdztrtbuXu7b9+4T9zus8AfpwMP3eZ7zcA6cr1JWi+hGh1/tNp1uF13v0Gq16Pa6tPW25L1eD9M0z4RhGNi2jVL8WaRcrlDMl2jUVVS1ilqrDrnUKpqm0Ww2z4SX0XUdxbRsjE4fo2NiWwbC6eNYfSzTwHEcCW/zCSzbwva8U/5JVuGfEo7AMiwYDLXR6yNsZ9izHQbCldwyLUzDxBUC4Q2yHanlQK2pkcykeZmME9mJEY5HiKYSvEoliL3eln48neTF9qb0ortbMhdNbZHe32Pv4D2H2U/sZtLkCsco7w4/cHV5losBH2PBaa4szzK66Ofy0gz+OwF8oZvM3VthZGGS8wuTMjNxa072Aw9ChJ7f59FmmM/5r1TqNW/gPqMBPyPzk5y7PsF4cIZLAR/jS9e4cGOKscVpwskomS8HfDzKkisVKNYq5MoFst9y1H9o1Boq3X5PnkPJHR8RfbvD6tN1NlIx1jYeM7U6z8qTNYIP7xJ5kyD/vcj/lHAFSrOhcfvZOoVq6U/DO65Xg8HgrycchPcJp+C6LsJ15evhN1Z6glP6krx0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ENCODE\"\n        title=\"ENCODE\"\n        src=\"/static/6f88130e70c794ca3fe18a72aacb3513/00d43/figure1.png\"\n        srcset=\"/static/6f88130e70c794ca3fe18a72aacb3513/63868/figure1.png 250w,\n/static/6f88130e70c794ca3fe18a72aacb3513/0b533/figure1.png 500w,\n/static/6f88130e70c794ca3fe18a72aacb3513/00d43/figure1.png 1000w,\n/static/6f88130e70c794ca3fe18a72aacb3513/aa440/figure1.png 1500w,\n/static/6f88130e70c794ca3fe18a72aacb3513/a303f/figure1.png 1733w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><strong>However, <a href=\"https://www.encodeproject.org/chip-seq-matrix/?type=Experiment&#x26;replicates.library.biosample.donor.organism.scientific_name=Mus%20musculus&#x26;assay_title=TF%20ChIP-seq&#x26;status=released\">ENCODE database did not contain too many TFs for Mouse.</a></strong> So I searched a bit. I found some really nice tools: <a href=\"https://academic.oup.com/nar/article/47/D1/D100/5184717\">GTRD</a>, <a href=\"https://bioinfo-csi.nus.edu.sg/methmotif/index.php\">MethMotif</a> and <a href=\"https://github.com/benoukraflab/TFregulomeR\">TFregulomeR</a>. Both GTRD and MethMotif contains a bigger database than ENCODE. They contains a lot of result processed by themself from public, not like ENCODE who generated and processed all the data itself. So in my idea, I think ENCODE database is still the gold standard, but I want to know if other database is good to use.</p>\n<h2>3. Use TFregulomeR to get TF Peaks</h2>\n<p>More importantly, I found a very nice R pacakge <a href=\"https://github.com/benoukraflab/TFregulomeR\">TFregulomeR</a>, which could automatically download a lot of TF's Peaks, and as user, we can select cell lines, tissues, species we like from a huge database. Below is a simple way to check of TF I am looking for are in the database.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> library<span class=\"token punctuation\">(</span>TFregulomeR<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> all_record <span class=\"token operator\">&lt;-</span> dataBrowser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">(</span>all_record<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"species\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"organ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cell_tissue_name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TF\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token operator\">|</span>species <span class=\"token operator\">|</span>organ             <span class=\"token operator\">|</span>cell_tissue_name                                 <span class=\"token operator\">|</span>TF     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>brain             <span class=\"token operator\">|</span>embryonic<span class=\"token operator\">-</span>stem<span class=\"token operator\">-</span>cell<span class=\"token operator\">-</span>derived<span class=\"token operator\">-</span>neural<span class=\"token operator\">-</span>progenitors   <span class=\"token operator\">|</span>Sox3   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>stem_cell         <span class=\"token operator\">|</span>embryonic<span class=\"token operator\">-</span>stem<span class=\"token operator\">-</span>cells                             <span class=\"token operator\">|</span>Tcf7l1 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>blood_and_lymph   <span class=\"token operator\">|</span>embryonic<span class=\"token operator\">-</span>stem<span class=\"token operator\">-</span>cell<span class=\"token operator\">-</span>derived<span class=\"token operator\">-</span>haematopoietic<span class=\"token operator\">-</span>cells <span class=\"token operator\">|</span>Tal1   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>blood_and_lymph   <span class=\"token operator\">|</span>bone<span class=\"token operator\">-</span>marrow<span class=\"token operator\">-</span>drived<span class=\"token operator\">-</span>macrophages                   <span class=\"token operator\">|</span>Bcl6   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>connective_tissue <span class=\"token operator\">|</span><span class=\"token number\">3</span>T3<span class=\"token operator\">-</span>L1<span class=\"token operator\">-</span>derived<span class=\"token operator\">-</span>adipocytes                        <span class=\"token operator\">|</span>Pparg  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>connective_tissue <span class=\"token operator\">|</span><span class=\"token number\">3</span>T3<span class=\"token operator\">-</span>L1<span class=\"token operator\">-</span>derived<span class=\"token operator\">-</span>adipocytes                        <span class=\"token operator\">|</span>Ctcf   <span class=\"token operator\">|</span></code></pre></div>\n<p>We can quickly check how many TF in certain organ or cell. For example, there are 88 TFs you can use if you research human stem cell. Or like me, who is researching mouse intestine, there are 11 TFs I can use.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> length<span class=\"token punctuation\">(</span>which<span class=\"token punctuation\">(</span>all_record<span class=\"token operator\">$</span>species <span class=\"token operator\">==</span> <span class=\"token string\">\"human\"</span> <span class=\"token operator\">&amp;</span> all_record<span class=\"token operator\">$</span>organ <span class=\"token operator\">==</span> <span class=\"token string\">\"stem_cell\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">88</span>\n<span class=\"token operator\">></span> length<span class=\"token punctuation\">(</span>which<span class=\"token punctuation\">(</span>all_record<span class=\"token operator\">$</span>species <span class=\"token operator\">==</span> <span class=\"token string\">\"mouse\"</span> <span class=\"token operator\">&amp;</span> all_record<span class=\"token operator\">$</span>organ <span class=\"token operator\">==</span> <span class=\"token string\">\"intestine\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">11</span></code></pre></div>\n<p><strong>However, I noticed that even the <code class=\"language-text\">organ</code> is the same, the <code class=\"language-text\">cell_tissue_name</code> maybe not.</strong> For example in below table, all of them are from \"mouse intestine\", but some cell is villus, some are distal-small-intestine .etc.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> index <span class=\"token operator\">&lt;-</span> which<span class=\"token punctuation\">(</span>all_record<span class=\"token operator\">$</span>species <span class=\"token operator\">==</span> <span class=\"token string\">\"mouse\"</span> <span class=\"token operator\">&amp;</span> all_record<span class=\"token operator\">$</span>organ <span class=\"token operator\">==</span> <span class=\"token string\">\"intestine\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>all_record<span class=\"token punctuation\">[</span>index <span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"species\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"organ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cell_tissue_name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TF\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token operator\">|</span>     <span class=\"token operator\">|</span>species <span class=\"token operator\">|</span>organ     <span class=\"token operator\">|</span>cell_tissue_name                          <span class=\"token operator\">|</span>TF     <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">115</span>  <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>intestinal<span class=\"token operator\">-</span>villus                         <span class=\"token operator\">|</span>Cdx2   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">261</span>  <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>small<span class=\"token operator\">-</span>intestine                           <span class=\"token operator\">|</span>Ctcf   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">456</span>  <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>intestine                                 <span class=\"token operator\">|</span>Ctcf   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">483</span>  <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>villus                                    <span class=\"token operator\">|</span>Cdx2   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">484</span>  <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>villus                                    <span class=\"token operator\">|</span>Hnf4a  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">724</span>  <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>jejunal<span class=\"token operator\">-</span>crypt<span class=\"token operator\">-</span>intestinal<span class=\"token operator\">-</span>epithelial<span class=\"token operator\">-</span>cells <span class=\"token operator\">|</span>Yy1    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">842</span>  <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>intestinal<span class=\"token operator\">-</span>crypt<span class=\"token operator\">-</span>cells                    <span class=\"token operator\">|</span>E2f3   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">843</span>  <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>intestinal<span class=\"token operator\">-</span>villus                         <span class=\"token operator\">|</span>E2f3   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">1006</span> <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>crypt<span class=\"token operator\">-</span>cells                               <span class=\"token operator\">|</span>Tcf7l2 <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">1076</span> <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>duodenum<span class=\"token operator\">-</span>and<span class=\"token operator\">-</span>jejunum                      <span class=\"token operator\">|</span>Vdr    <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token number\">1345</span> <span class=\"token operator\">|</span>mouse   <span class=\"token operator\">|</span>intestine <span class=\"token operator\">|</span>distal<span class=\"token operator\">-</span>small<span class=\"token operator\">-</span>intestine                    <span class=\"token operator\">|</span>Atoh1  <span class=\"token operator\">|</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p>So eventually I can get peaks by using <code class=\"language-text\">loadPeaks()</code> function, like below the full code. After below for loop, all above 11 TF's peaks will be saved in TFPeaks object. Note that the parameter <code class=\"language-text\">includeMotifOnly</code> I would prefer to set FLASE, other wise it will only get Motif binding avaliable peaks. The number of peaks would be much less.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>TFregulomeR<span class=\"token punctuation\">)</span>\n\nall_record <span class=\"token operator\">&lt;-</span> dataBrowser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nindex <span class=\"token operator\">&lt;-</span> which<span class=\"token punctuation\">(</span>all_record<span class=\"token operator\">$</span>species <span class=\"token operator\">==</span> <span class=\"token string\">\"mouse\"</span> <span class=\"token operator\">&amp;</span> all_record<span class=\"token operator\">$</span>organ <span class=\"token operator\">==</span> <span class=\"token string\">\"intestine\"</span><span class=\"token punctuation\">)</span>\nmm10Intestine <span class=\"token operator\">&lt;-</span> all_record<span class=\"token punctuation\">[</span>index <span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"species\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"organ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cell_tissue_name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TF\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\nTFPeaks <span class=\"token operator\">&lt;-</span> list<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i <span class=\"token keyword\">in</span> mm10Intestine<span class=\"token operator\">$</span>ID<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    TFPeaks<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;-</span> loadPeaks<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> i<span class=\"token punctuation\">,</span> includeMotifOnly <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then we can check how many peaks each TF have (CTCF seems quite popular here):</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>cbind<span class=\"token punctuation\">(</span>mm10Intestine<span class=\"token operator\">$</span>ID<span class=\"token punctuation\">,</span> matrix<span class=\"token punctuation\">(</span>unlist<span class=\"token punctuation\">(</span>lapply<span class=\"token punctuation\">(</span>TFPeaks<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> nrow<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token operator\">|</span>                                                                 <span class=\"token operator\">|</span>      <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP000895_MMU_intestinal<span class=\"token operator\">-</span>villus_CDX2                        <span class=\"token operator\">|</span><span class=\"token number\">7733</span>  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP011053_MMU_small<span class=\"token operator\">-</span>intestine_CTCF                          <span class=\"token operator\">|</span><span class=\"token number\">39894</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP031037_MMU_intestine_CTCF                                <span class=\"token operator\">|</span><span class=\"token number\">39760</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP031180_MMU_villus_CDX2                                   <span class=\"token operator\">|</span><span class=\"token number\">3544</span>  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP031181_MMU_villus_HNF4A                                  <span class=\"token operator\">|</span><span class=\"token number\">18151</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP032837_MMU_jejunal<span class=\"token operator\">-</span>crypt<span class=\"token operator\">-</span>intestinal<span class=\"token operator\">-</span>epithelial<span class=\"token operator\">-</span>cells_YY1 <span class=\"token operator\">|</span><span class=\"token number\">1024</span>  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP033438_MMU_intestinal<span class=\"token operator\">-</span>crypt<span class=\"token operator\">-</span>cells_E2F3                   <span class=\"token operator\">|</span><span class=\"token number\">14899</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP033440_MMU_intestinal<span class=\"token operator\">-</span>villus_E2F3                        <span class=\"token operator\">|</span><span class=\"token number\">2976</span>  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP034520_MMU_crypt<span class=\"token operator\">-</span>cells_TCF7L2                            <span class=\"token operator\">|</span><span class=\"token number\">3042</span>  <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP035023_MMU_duodenum<span class=\"token operator\">-</span>and<span class=\"token operator\">-</span>jejunum_VDR                      <span class=\"token operator\">|</span><span class=\"token number\">15384</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP037469_MMU_distal<span class=\"token operator\">-</span>small<span class=\"token operator\">-</span>intestine_ATOH1                  <span class=\"token operator\">|</span><span class=\"token number\">8826</span>  <span class=\"token operator\">|</span></code></pre></div>\n<p>The format of these peaks are very nice, easy for downstream use. The <code class=\"language-text\">tag_fold_change</code>, according to the pacakge vignette, is:</p>\n<blockquote>\n<p>\"For each peak region, we also provide its tag (read) fold change (fifth column of returned peaks). This read enrichment value is obtained from MACS2 and denotes the fold change of reads in TF ChIP-seq compared to input ChIP-seq.\"</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> knitr<span class=\"token operator\">::</span>kable<span class=\"token punctuation\">(</span>head<span class=\"token punctuation\">(</span>TFPeaks<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token operator\">|</span>chr  <span class=\"token operator\">|</span>    start<span class=\"token operator\">|</span>      end<span class=\"token operator\">|</span>id                                                           <span class=\"token operator\">|</span> tag_fold_change<span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span><span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">|</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">:</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr1 <span class=\"token operator\">|</span>  <span class=\"token number\">4801643</span><span class=\"token operator\">|</span>  <span class=\"token number\">4801644</span><span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP000895_MMU_intestinal<span class=\"token operator\">-</span>villus_CDX2_peaks_with_motif_1 <span class=\"token operator\">|</span>            <span class=\"token number\">9.78</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr1 <span class=\"token operator\">|</span>  <span class=\"token number\">5108863</span><span class=\"token operator\">|</span>  <span class=\"token number\">5108864</span><span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP000895_MMU_intestinal<span class=\"token operator\">-</span>villus_CDX2_peaks_with_motif_2 <span class=\"token operator\">|</span>           <span class=\"token number\">45.83</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr1 <span class=\"token operator\">|</span>  <span class=\"token number\">6906544</span><span class=\"token operator\">|</span>  <span class=\"token number\">6906545</span><span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP000895_MMU_intestinal<span class=\"token operator\">-</span>villus_CDX2_peaks_with_motif_3 <span class=\"token operator\">|</span>           <span class=\"token number\">12.22</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr1 <span class=\"token operator\">|</span>  <span class=\"token number\">7311316</span><span class=\"token operator\">|</span>  <span class=\"token number\">7311317</span><span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP000895_MMU_intestinal<span class=\"token operator\">-</span>villus_CDX2_peaks_with_motif_4 <span class=\"token operator\">|</span>           <span class=\"token number\">13.44</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr1 <span class=\"token operator\">|</span>  <span class=\"token number\">9127956</span><span class=\"token operator\">|</span>  <span class=\"token number\">9127957</span><span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP000895_MMU_intestinal<span class=\"token operator\">-</span>villus_CDX2_peaks_with_motif_5 <span class=\"token operator\">|</span>           <span class=\"token number\">13.75</span><span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>chr1 <span class=\"token operator\">|</span> <span class=\"token number\">10124232</span><span class=\"token operator\">|</span> <span class=\"token number\">10124233</span><span class=\"token operator\">|</span>GTRD<span class=\"token operator\">-</span>EXP000895_MMU_intestinal<span class=\"token operator\">-</span>villus_CDX2_peaks_with_motif_6 <span class=\"token operator\">|</span>           <span class=\"token number\">19.55</span><span class=\"token operator\">|</span></code></pre></div>\n<p>A very important final word, the TFregulomeR's TF peaks are for <code class=\"language-text\">hg38</code> and <code class=\"language-text\">mm10</code> genome.</p>","frontmatter":{"date":"January 16, 2021","slug":"/notes/Use-TFregulomeR-to-get-Transcript-Factor-Binding-Peaks","title":"Use TFregulomeR to get Transcript Factor Binding Peaks","tags":["TFBS","TFEA"],"abstract":"Recently I am trying to do a set of Transcript Factor Enrichment Analysis for my 5hmC (hMeDIP-seq). I used to use ENCODE to do this, but eventually I found ENCODE data has very few TFs for my cell line (Mouse Intestine). So I started seeking other potential database and tools, and I found a lot indeed. Among them TFregulomeR is a new but quite powerful tool."}}},"pageContext":{"slug":"/notes/Use-TFregulomeR-to-get-Transcript-Factor-Binding-Peaks"}},
    "staticQueryHashes": []}