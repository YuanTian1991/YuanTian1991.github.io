{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/RRBS-Analysis-3:-Differential-Methylated-Probes",
    "result": {"data":{"markdownRemark":{"html":"<p>Then here comes to an important point: Differential calling, it's a very common but vital step for nearly all EWAS (Epigenome-wide association study).</p>\n<h2>1. Differential Methylated Probe Calling</h2>\n<p>Initially I directly applied the methylKit for DMP calling.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">myDiff <span class=\"token operator\">&lt;-</span> calculateDiffMeth<span class=\"token punctuation\">(</span>meth<span class=\"token punctuation\">,</span> overdispersion<span class=\"token operator\">=</span><span class=\"token string\">\"MN\"</span><span class=\"token punctuation\">,</span> mc.cores<span class=\"token operator\">=</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>A very serious problem is the P-value distribution is quite weird. It shows a clear Bimodal Pattern.</strong> This is a very good <a href=\"http://varianceexplained.org/statistics/interpreting-pvalue-histogram/\">post</a> to explain this kind of situation. In another word, this situation happens because maybe there are some low-quality data, or sometimes there are no read counts enriched at all.</p>\n<p>So I first try to use <code class=\"language-text\">filterCoverage</code> function provided by methylKit to remove more low-quality probes.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 664px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4ed8b67eb8ae1b6d20eb52027abc0663/31493/figure1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAABxUlEQVQ4y5WUZ6tCMQxA/f//yL39oIILXCCCiOLee+Rx+ui1vdbnfYHQdOQ0bdKGns+nILRakev1KrvdTg6Hg5xOJzkej7Jarbyx2+3m9AuZA+YEzpVKRarVqvR6Pel2u6pfq9WkXq/Ler32gFqwQybEnAgieh3RPh6PV4QIOw4GA+sYLEJN2xzTvp1OR51IAc/ns4LNZjNpNpuBIzSBrVZLlsvlL/ByuSjYeDxWOyFmBP67dQHb7fYLqBeMRiN18S4nsxK+AolwOp2qCBuNhtDnCigTF9gVtQXc7/cyn88VNBKJSCqVkng8rtpSqeRd9l9iAbk/ZDKZSDQalUQioRQoGySTSen3+8LGFDRJpOh1+wbk7ogONYF+MHY6nZZsNiv5fF5yuZwUCgV1ikwmI5vN5lU2i8XCCQRm2mgsFrMUH3S73dpZ/hShH+xSwB6Qh6+P/Qn4TS0g75DzA2SCJPwXyAnejkyWw+GwdS9BlaR5SeGZUcSkvVgsqqyVy2WlQW38KCnvt9FQBnkphK9t80OlFulTf9isY42uT+v7YqH+hbUTQtJwZFNa+ggAoMj9fn9F6Hr0ps3i4XCofm3eu//n8f/YPycRyd0CAQVNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Bimodal P value Distribution\"\n        title=\"Bimodal P value Distribution\"\n        src=\"/static/4ed8b67eb8ae1b6d20eb52027abc0663/31493/figure1.png\"\n        srcset=\"/static/4ed8b67eb8ae1b6d20eb52027abc0663/63868/figure1.png 250w,\n/static/4ed8b67eb8ae1b6d20eb52027abc0663/0b533/figure1.png 500w,\n/static/4ed8b67eb8ae1b6d20eb52027abc0663/31493/figure1.png 664w\"\n        sizes=\"(max-width: 664px) 100vw, 664px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>2. P value Fix 1: Increase Coverage Filtering Threshold</h2>\n<p>Then I wrote a function to dynamically filter CpGs' coverage, from 10 to 55, as I expected, as the threshold goes up, the P-value distribution turns to normal: the Anti-conservative p-values shape we are expecting.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2f13ceac835622432874f7319c005e88/764d0/figure2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRElEQVQoz02Q2QrCQBAE9/8/SYmKCPEkKhFfvEWNovG+j5YaWHFBTO9M986U+3w+ut1uer/fejwe4lyvV9Ov10vU7/e7ns+n1bhH4/Ga2uVyMe1ms5kZCdlut5pMJmbgbr/fm6YZI//z+Vyn08nM9C0WC/P6cJfJZJTL5VSpVLTb7ew7CAKVSiXT5XJZ2WxWhUJBq9VKcRwLD3Ue6/V61l+v19Vut+V4cTgcKkkSGx3TYDAQk4Ngs9loNBppPB7bmsfj0TQeJj2fzxaMhwzHqJ4dvPwq/8ez9D2sxs/XOJ6xg5M/vL5er38aNv8a83K5/IUQjvYDWWA+n1e1WlWn0zFmxWLReLZaLR0OB9VqNYVhqGazqTRNjRM9jUbDwvr9vvGNokjdblcONlxOp1N7CXaAhhHMMMGHO3gRSj+a7diKXp/xBQVNVxSxlKmgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Filter Coverage P value plots\"\n        title=\"Filter Coverage P value plots\"\n        src=\"/static/2f13ceac835622432874f7319c005e88/00d43/figure2.png\"\n        srcset=\"/static/2f13ceac835622432874f7319c005e88/63868/figure2.png 250w,\n/static/2f13ceac835622432874f7319c005e88/0b533/figure2.png 500w,\n/static/2f13ceac835622432874f7319c005e88/00d43/figure2.png 1000w,\n/static/2f13ceac835622432874f7319c005e88/aa440/figure2.png 1500w,\n/static/2f13ceac835622432874f7319c005e88/764d0/figure2.png 1898w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>The second thing I want to make sure is: <strong>How many DMPs will be removed if I took a large coverage threshold like 55</strong>? This is an important question, because if after removing improper CpGs I can only receive a very small amount of DMPs, which would be hard for future research. So sad that the below plot shows that if I apply high coverage threshold, only very few DMP I will get... So I basically this solution is not working, at least not working in my scenario.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 661px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/23790cc37b93c29abc55591ac7dbfd90/0012b/figure3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqElEQVQ4y5WU144CMQxF+f8v4gEhEL2K/gC8UETvvQju6lgKGtiBZSNFEyWe42vHTuB+v+t1MjabjRaLhXa7nabTqcbjsZbLpebzufb7va23263Zun8YAb0Z3W5XlUpFnU5HzWZTjUZD7XZb9Xpd/X5frVZLw+HwN/B6vep4POp8PttPeP/P8MIMCGgymVgIwWDQwmTcbjebLg1u7d1zsCeFl8vFgIDC4bCB/Tx/OwxIogGFQqEnoJ+CP4GEPBqNTGEkElG5XFa1Wn2CeuFfKZzNZqYyGo0qk8kolUo9DLw5e1X+MWQHzOVyBqVEyO3rjfqp9q4tZArXC0RhLBZTrVazfWz8VPndutWh6wovkG8+n7e9UqlkcC6MzgHy8VKcQi4lm80qmUxa2EBRmk6nlUgkHo6woQnooF6vZ2IOh4M5CiATKMB4PK5CoWAw1BWLRYOw5xQznUMcMTlnD04A6ul0EqGvVitreFKwXq9tzZcwWTNpTc6dnVuj0nLojZ+eBownQsARhg6MQwB8seEcOyoFp5bDT4WLemqU8hkMBvaE8cKw9+6h+AEecMREcEKsjAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DMP number\"\n        title=\"DMP number\"\n        src=\"/static/23790cc37b93c29abc55591ac7dbfd90/0012b/figure3.png\"\n        srcset=\"/static/23790cc37b93c29abc55591ac7dbfd90/63868/figure3.png 250w,\n/static/23790cc37b93c29abc55591ac7dbfd90/0b533/figure3.png 500w,\n/static/23790cc37b93c29abc55591ac7dbfd90/0012b/figure3.png 661w\"\n        sizes=\"(max-width: 661px) 100vw, 661px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>I personally think this solution should work in one of these 2 situations: (1). The high-bar close to 1 is not too high, thus you may adjust it down by increase the coverage threshold. (2). The data format is something like RNA-seq, which the coverage itself indeed represent the expression value, not like CpG, that matrix value is actually the divide between two coverage value because, in RNA-seq scenario, the null distribution hypothesis assumption should stands.</p>\n<h2>3. P-value Fix 2: Remove all-zero or all-one CpG</h2>\n<p>The second thought crosses my mind is to find these close-to-1 CpGs, see why they are acting so wired. Then maybe just removed them (after all they are contributed to our DMP right?) Below is my checking code, so across all 554917 CpGs (filtered based on 10 reads coverage), there are 24628 CpG's p-value is completely 1, and among them, nearly all are have totally <strong>0 OR 1</strong> methylation status across all samples.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> index <span class=\"token operator\">&lt;-</span> which<span class=\"token punctuation\">(</span>myDiff<span class=\"token operator\">$</span>pvalue <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> length<span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">24628</span>\n<span class=\"token operator\">></span> sum<span class=\"token punctuation\">(</span>rowSums<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%in%</span> c<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">24351</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p><strong>According to the discussion in this <a href=\"https://support.bioconductor.org/p/116411/\">post</a></strong>. I decided to remove all these probes. And more importantly, I decided to apply a smaller threshold, like 7, to gain more DMPs eventually. A tricky thing here is that <strong>there are 3 functions in methylKit are all using 10 as default coverage threshold,</strong> so if I want loose the threshold, I need to adjust all of them:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\">## Firstly is the processBismarkAln function</span>\nmy.methRaw<span class=\"token operator\">=</span>processBismarkAln<span class=\"token punctuation\">(</span>location<span class=\"token operator\">=</span>files<span class=\"token punctuation\">,</span>\n                             sample.id<span class=\"token operator\">=</span>file.name<span class=\"token punctuation\">,</span>\n                             assembly<span class=\"token operator\">=</span><span class=\"token string\">\"danRer11\"</span><span class=\"token punctuation\">,</span>\n                             save.context<span class=\"token operator\">=</span><span class=\"token keyword\">NULL</span><span class=\"token punctuation\">,</span>\n                             read.context<span class=\"token operator\">=</span><span class=\"token string\">\"CpG\"</span><span class=\"token punctuation\">,</span>\n                             mincov<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># Position 1</span>\n                             minqual<span class=\"token operator\">=</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n                             treatment<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                             save.folder<span class=\"token operator\">=</span><span class=\"token string\">\"./\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ...</span>\n<span class=\"token comment\">## sceond is the methRead function</span>\nmyobj <span class=\"token operator\">&lt;-</span> methRead<span class=\"token punctuation\">(</span>CpGFiles<span class=\"token punctuation\">,</span>\n                  sample.id<span class=\"token operator\">=</span> as.list<span class=\"token punctuation\">(</span>sampleName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                  assembly<span class=\"token operator\">=</span><span class=\"token string\">\"danRer11\"</span><span class=\"token punctuation\">,</span>\n                  treatment<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                  context<span class=\"token operator\">=</span><span class=\"token string\">\"CpG\"</span><span class=\"token punctuation\">,</span>\n                  mincov<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># Position 2</span>\n<span class=\"token comment\"># ...</span>\n<span class=\"token comment\"># Thirdly is the filterByCoverage function, as I tested before</span>\nfiltered.myobj <span class=\"token operator\">&lt;-</span> filterByCoverage<span class=\"token punctuation\">(</span>myobj<span class=\"token punctuation\">,</span>lo.count<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span>lo.perc<span class=\"token operator\">=</span><span class=\"token keyword\">NULL</span><span class=\"token punctuation\">,</span> hi.count<span class=\"token operator\">=</span><span class=\"token keyword\">NULL</span><span class=\"token punctuation\">,</span>hi.perc<span class=\"token operator\">=</span><span class=\"token number\">99.9</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>After the above work (basically redo the work in the <a href=\"https://yuantian1991.github.io/notes/RRBS-Analysis-2:-MethylKit\">last step</a>), I eventually get 746647 CpGs left. Then below is the code for DMP calling, as I said I removed all totally 1 and totally 0 CpGs:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">index <span class=\"token operator\">&lt;-</span> which<span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>rowSums<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">)</span> <span class=\"token percent-operator operator\">%in%</span> c<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>ncol<span class=\"token punctuation\">(</span>beta<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nmeth.dmp <span class=\"token operator\">&lt;-</span> meth<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span>\nmyDiff <span class=\"token operator\">&lt;-</span> calculateDiffMeth<span class=\"token punctuation\">(</span>meth.dmp<span class=\"token punctuation\">,</span> overdispersion<span class=\"token operator\">=</span><span class=\"token string\">\"MN\"</span><span class=\"token punctuation\">,</span> mc.cores<span class=\"token operator\">=</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>Now, we get a very good p-value distribution and an even bigger number of CpG.</strong> The sacrifice here is a comparably low Coverage Threshold and roughly 30000+ CpGs who was supposed to be close to 1 and contribute to ebayes estimation adjustment.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f3b0343309ae92603f341a0f1334afba/a6d36/figure4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoklEQVQ4y5WUia6CMBBF+///5orGlbgbJTFu4K5jziTFCtTHa3JDreX0zkLN6/USVwz7vN1uEkWRrNdrmU6nMplM9Hk8Hr/2ucNkF1zw/X5X2Hw+l9lsJuPxWEajkez3ez+QxcfjIc/nU06nUw7qG77/zeVy0TAOh4OG5G62YA5zlU3NF5AN5GS32ym4rEPfMCR+uVzKdrvNAbNOSwFJPO4QiS8q0K8Qc0AKQmsADMNQyOn5fNZnEfiXFEj+ANIKzWZTgiBQtVotGQ6HWqy/qv0FpMeSJFGHgIBa1et1XWNPHMdyvV612UmTW20XbijIarVShxZoXdrfgBuNhrTbbel0OtLtdqXX68lgMNAo+v2+RpkWBYeElgUWwRFwV5VKJS2oIQw+KZ9D35qbayJYLBafxiY/RQ7LqlarfYA4JOk45LT/wgod0nc4zOamjIioWq2qqfS2oYkJm4pRubJiP6LqaZUBUmlCB4pbmh3Zg+yc641I2MOcNPFEdEoKZNiXGEDs3Ugj0/QM1uycVHGhuO9jzGQ/+qL5ZrPRHCF7qO8megNzPutJRLZLjgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Final P value Distribution\"\n        title=\"Final P value Distribution\"\n        src=\"/static/f3b0343309ae92603f341a0f1334afba/a6d36/figure4.png\"\n        srcset=\"/static/f3b0343309ae92603f341a0f1334afba/63868/figure4.png 250w,\n/static/f3b0343309ae92603f341a0f1334afba/0b533/figure4.png 500w,\n/static/f3b0343309ae92603f341a0f1334afba/a6d36/figure4.png 650w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Finally, I filtering the DMPs based on mean meth different at 15, and q value 0.05, eventually I get 3424 CpGs. These 3424 CpGs will be used across nearly the whole project.</p>\n<h2>4. Annotated DMPs</h2>\n<p>Following the DMP calling, one important step here is to get annotation on this CpGs, like their related genes (if there are any), are they located in the promoter. Here I just want to quickly use <code class=\"language-text\">genomation</code> package to load the .gtf file for annotation.</p>\n<p>I eventually choose this package because it has a function to quickly load <strong><a href=\"ftp://ftp.ensembl.org/pub/release-98/gtf\">gtf file downloaded from Ensemble</a></strong>. This is important because I previously used the Ensemble genome (fasta format) for preprocessing mapping (with Bismark), so I decided to download the same Ensemble annotation across the whole project.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">message<span class=\"token punctuation\">(</span><span class=\"token string\">\"Annotate DMPs\"</span><span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span><span class=\"token string\">\"GenomicRanges\"</span><span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span><span class=\"token string\">\"genomation\"</span><span class=\"token punctuation\">)</span>\nsystem<span class=\"token punctuation\">(</span><span class=\"token string\">\"wget ftp://ftp.ensembl.org/pub/release-98/gtf/danio_rerio/Danio_rerio.GRCz11.98.gtf.gz\"</span><span class=\"token punctuation\">)</span>\ngff <span class=\"token operator\">&lt;-</span> gffToGRanges<span class=\"token punctuation\">(</span><span class=\"token string\">\"./Danio_rerio.GRCz11.98.gtf.gz\"</span><span class=\"token punctuation\">)</span>\ngrl <span class=\"token operator\">&lt;-</span> as<span class=\"token punctuation\">(</span>split<span class=\"token punctuation\">(</span>gff<span class=\"token punctuation\">,</span> gff<span class=\"token operator\">$</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"GRangesList\"</span><span class=\"token punctuation\">)</span>\n\nPairs <span class=\"token operator\">&lt;-</span> findOverlapPairs<span class=\"token punctuation\">(</span>as<span class=\"token punctuation\">(</span>myDiff<span class=\"token punctuation\">,</span><span class=\"token string\">\"GRanges\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> grl<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'gene'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Below is an example how the Pairs looks like, so it joined two GRanges, one is my myDiff, and the other is the gene annotation, in theory they are both generated by Ensembl annotation so should be matching well. In the future I may need to find ways to get TSS, but for now I think this should be good enough as DMP annotation.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/457fcf60fc935f0bbcb4e912ed0d72ce/1843f/figure5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.4%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKElEQVQ4y31Ux47iUBD0jyCBBBjbYJNNzlGYjIgiCQSCCxf+v0bVu17BsDOH1ouuV13VbaXT6aDf70twXqvVkEwmkU6nkc1mEY1GZc0xHo8jEonA7/cjGAwiEAh8hJJKpeQyAVRVRbPZRLFYFODhcCgABI7FYgJI8HA4LPvvEZZ9xbZtGIYhoKFQCOVyGblcDpVKBd1uF5qmIZFIwDRN+ZDA7pzB+WsoZLNcLiXlQqEgcwKWSiXs93uRYbFYoN1uYzQaYTKZyCMuoMv2HyAZHo9HuciUttutHJDJ7XZDq9XC6XQSYAKu12sBtCzrg50AksnhcMB4PBZWLkOmTCCmTaa9Xg/T6RTz+VxYUaZXDbkngDSFL5MZX3ZfZ5AdI5PJyB2ekWk+nxe9XSA3uFYo+Gw2w263g9frhc/nk8u6rovjjUYD7qMsCwJSa56b5rvTXEvKFJymVKtV1Ot1+YClMhgMBLRUKsJxeshkbEmdZ4bBFD91FFPcciAAHWXpkAHX8VgMlmWiUi1DNzQBJ7Cua1J730M0JDJHFvJms5E0qQlN4IN0nyapahD5fA62nYKmq39B3tNW6Nr9fsf1ehVmbjdQeHYL06N+BKSzlvn/cmHwTDmfz3g+n3g8HtJ+Ho9HzPkjuikmUWM2APuXoL+FQs0ulwsITBZkxzIhQ9YjGbN0aBjLhk7/9GOQnwPNcBxH6pAj1yzy1WolWkYiprCl+wyCvvby9xb8Ar2K82uid81oAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Annotated DMP\"\n        title=\"Annotated DMP\"\n        src=\"/static/457fcf60fc935f0bbcb4e912ed0d72ce/00d43/figure5.png\"\n        srcset=\"/static/457fcf60fc935f0bbcb4e912ed0d72ce/63868/figure5.png 250w,\n/static/457fcf60fc935f0bbcb4e912ed0d72ce/0b533/figure5.png 500w,\n/static/457fcf60fc935f0bbcb4e912ed0d72ce/00d43/figure5.png 1000w,\n/static/457fcf60fc935f0bbcb4e912ed0d72ce/1843f/figure5.png 1186w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"September 16, 2020","slug":"/notes/RRBS-Analysis-3:-Differential-Methylated-Probes","title":"RRBS Analysis 3: Differential Methylated Probes","tags":["RRBS","methylKit"],"abstract":"Continuing my RRBS analysis, now the key point is to get Differential Methylated Probes out. I encountered a serious issue about P-value distribution, it shows bimodal pattern, which is not a good sign in most case, so I tried to solved it in this post."}}},"pageContext":{"slug":"/notes/RRBS-Analysis-3:-Differential-Methylated-Probes"}},
    "staticQueryHashes": []}