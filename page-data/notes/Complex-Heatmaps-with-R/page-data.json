{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Complex-Heatmaps-with-R",
    "result": {"data":{"markdownRemark":{"html":"<h2>1. Pheatmap</h2>\n<p>Pheatmap is such a wonderful R package, and easy to use, it can be used to generate middle-complex level heatmap, like Heatmap with <strong>annotation bars</strong>.</p>\n<p>In below code, data must be matching with SampleSheet, and SampleSheet is a dataframe with each row is one sample, and each column is one attributes.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">\"pheatmap\"</span><span class=\"token punctuation\">)</span>\n\ncol_anno <span class=\"token operator\">&lt;-</span> SampleSheet<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"targetPheno\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Batch\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\ncol_anno<span class=\"token punctuation\">[</span>is.na<span class=\"token punctuation\">(</span>col_anno<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;-</span> <span class=\"token string\">\"NA\"</span>\nrownames<span class=\"token punctuation\">(</span>col_anno<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;-</span> SampleSheet<span class=\"token operator\">$</span>ID\n\nmy_colour <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span><span class=\"token string\">\"targetPheno\"</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span>Control<span class=\"token operator\">=</span><span class=\"token string\">\"#F9F2ED\"</span><span class=\"token punctuation\">,</span> Healthy<span class=\"token operator\">=</span><span class=\"token string\">\"#3AB0FF\"</span><span class=\"token punctuation\">,</span> Localise<span class=\"token operator\">=</span><span class=\"token string\">\"#FFB562\"</span><span class=\"token punctuation\">,</span> Metastasis<span class=\"token operator\">=</span><span class=\"token string\">\"#F87474\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                 <span class=\"token string\">\"Batch\"</span> <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span>Run1<span class=\"token operator\">=</span><span class=\"token string\">\"#EF476F\"</span><span class=\"token punctuation\">,</span> Run2<span class=\"token operator\">=</span><span class=\"token string\">\"#F78C6B\"</span><span class=\"token punctuation\">,</span> Run3<span class=\"token operator\">=</span><span class=\"token string\">\"#ffd166\"</span><span class=\"token punctuation\">,</span>\n                             Run4<span class=\"token operator\">=</span><span class=\"token string\">\"#06D6A0\"</span><span class=\"token punctuation\">,</span> Run5<span class=\"token operator\">=</span><span class=\"token string\">\"#0cb0a9\"</span><span class=\"token punctuation\">,</span> Run6<span class=\"token operator\">=</span><span class=\"token string\">\"#118ab2\"</span><span class=\"token punctuation\">,</span> Run7<span class=\"token operator\">=</span><span class=\"token string\">\"#073b4c\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncolfunc <span class=\"token operator\">&lt;-</span> colorRampPalette<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#420039\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nph <span class=\"token operator\">&lt;-</span> pheatmap<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         <span class=\"token comment\"># color = colfunc(100),</span>\n         annotation<span class=\"token operator\">=</span>col_anno<span class=\"token punctuation\">,</span>\n         cluster_rows<span class=\"token operator\">=</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">,</span>\n         show_rownames<span class=\"token operator\">=</span>T<span class=\"token punctuation\">,</span>\n         show_colnames<span class=\"token operator\">=</span>T<span class=\"token punctuation\">,</span>\n         annotation_legend<span class=\"token operator\">=</span><span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span>\n         row_annotation_legend<span class=\"token operator\">=</span><span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">,</span>\n         col_anno<span class=\"token operator\">=</span>col_anno<span class=\"token punctuation\">,</span>\n         annotation_colors <span class=\"token operator\">=</span> my_colour<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b746761bb365c5c5f8e2f813edfa73fe/fc651/figure.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAACDUlEQVQozzXMbU8SAQDA8ft4va7WF+ltW+WmmYaAIYmiydYydWu2wFwWKQGBohBiBN7xcDwcd8eJHPIUHP+WW78P8BMYmBhKBb1WpK03KFUbiJUaUlGmVFGQKhVk8RJNrqDqCleNKvWaTFOro2oN2rrKn16PcbePNbIQXNsh3od+sPk9xoY/SObISTKzQ0YMkP29SUQMkU7FkFLfiElRjpNJwhdpwukUWyfn7EdTlHN5jPMQWrWMcGcuguesge1E5Yk/hZWbBnMXiyiMt2kPs5RGA/RJncKNSlQf8qsz5LjZ54PYYlc00NsmSaXAaamI8MARwZes4k7UmA2c0U88ZqS9ZTg6YGL6MMw4clfD6GcpmiV+Gl3ypkmq2SYgGnyWNOpGC6lukBcLCPfsEdbPqrhOasz8C0+fMtK3GFhBJp036J0k5a6O3s8jtWVO9S7Z6w4JzcQvNvFfatSMa+h1uFIVhPuOKO8uVLxpjfn9JOPwQ1DXgU/QXuamE8IYK/QmGZSBzOVND7lvku/0OKy2CcotqlqT/4S7L46wBXNMf8nzaCdOOb5BSdojWw9TlANcyDEOC3ni5RRfpTwfsxUOJJm9XBVfoow3JlFUtNvMsiyE585lZhZcTM05mLUv4Vr14Xjlxe5eY37Rg+3lEosrr3F5fUzNO3F61rAteVhwr/DM7sLmXsW4at2Gk8mEv85TJlES2AewAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Pheatmap\"\n        title=\"Pheatmap\"\n        src=\"/static/b746761bb365c5c5f8e2f813edfa73fe/00d43/figure.png\"\n        srcset=\"/static/b746761bb365c5c5f8e2f813edfa73fe/63868/figure.png 250w,\n/static/b746761bb365c5c5f8e2f813edfa73fe/0b533/figure.png 500w,\n/static/b746761bb365c5c5f8e2f813edfa73fe/00d43/figure.png 1000w,\n/static/b746761bb365c5c5f8e2f813edfa73fe/aa440/figure.png 1500w,\n/static/b746761bb365c5c5f8e2f813edfa73fe/e8950/figure.png 2000w,\n/static/b746761bb365c5c5f8e2f813edfa73fe/fc651/figure.png 3016w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"July 01, 2022","slug":"/notes/Complex-Heatmaps-with-R","title":"Complex Heatmaps with R","tags":["R","Heatmap","Visualisation"],"abstract":"My code records on how to generated nice and complex heatmap."}}},"pageContext":{"slug":"/notes/Complex-Heatmaps-with-R"}},
    "staticQueryHashes": ["63159454"]}