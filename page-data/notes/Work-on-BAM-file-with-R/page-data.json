{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Work-on-BAM-file-with-R",
    "result": {"data":{"markdownRemark":{"html":"<h2>Read BAM into R</h2>\n<p>I previously use samtools/sambamba to do it, but now I found a pretty good tool <a href=\"https://bioconductor.org/packages/release/bioc/html/GenomicAlignments.html\">GenomicAlignments</a>. Below are some useful key code I mostly copy-paste.</p>\n<p>The below code will extract all <code class=\"language-text\">mated</code> reads from BAM file. Defaultly there is no \"seq\" included.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">ga_pairs <span class=\"token operator\">&lt;-</span> readGAlignmentPairs<span class=\"token punctuation\">(</span>bam_path<span class=\"token punctuation\">,</span> \n                                use.names <span class=\"token operator\">=</span> <span class=\"token boolean\">TRUE</span><span class=\"token punctuation\">,</span> \n                                param <span class=\"token operator\">=</span> ScanBamParam<span class=\"token punctuation\">(</span>which<span class=\"token operator\">=</span>bedToGrange<span class=\"token punctuation\">,</span> what<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"qname\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mapq\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cigar\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rname\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pos\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"isize\"</span><span class=\"token punctuation\">,</span>\n                                                            <span class=\"token string\">\"seq\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"mate_status\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"qual\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>The bedToGrange object is very useful and can define what area of Genome I want to extract. The <code class=\"language-text\">ScanBamParam</code> can be used even more to do detailed filtering. To find out \"what\" attributes from bam are importable, use function <code class=\"language-text\">scanBamWhat</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> scanBamWhat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"qname\"</span>       <span class=\"token string\">\"flag\"</span>        <span class=\"token string\">\"rname\"</span>       <span class=\"token string\">\"strand\"</span>      <span class=\"token string\">\"pos\"</span>         <span class=\"token string\">\"qwidth\"</span>      <span class=\"token string\">\"mapq\"</span>       \n <span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"cigar\"</span>       <span class=\"token string\">\"mrnm\"</span>        <span class=\"token string\">\"mpos\"</span>        <span class=\"token string\">\"isize\"</span>       <span class=\"token string\">\"seq\"</span>         <span class=\"token string\">\"qual\"</span>        <span class=\"token string\">\"groupid\"</span>    \n<span class=\"token punctuation\">[</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token string\">\"mate_status\"</span>\n<span class=\"token operator\">></span> </code></pre></div>\n<p>If want to extract all reads, use function <code class=\"language-text\">readGAlignments</code></p>","frontmatter":{"date":"April 06, 2023","slug":"/notes/Work-on-BAM-file-with-R","title":"Work on BAM file with R","tags":["R","BAM"],"abstract":"BAM is large, which normally works only with low-level languages like C/C++. Since I mostly only use R, here are some collections of my code to read/modify BAM file."}}},"pageContext":{"slug":"/notes/Work-on-BAM-file-with-R"}},
    "staticQueryHashes": ["63159454"]}