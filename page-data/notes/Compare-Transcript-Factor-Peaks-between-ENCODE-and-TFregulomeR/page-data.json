{"componentChunkName":"component---src-templates-note-template-js","path":"/notes/Compare-Transcript-Factor-Peaks-between-ENCODE-and-TFregulomeR","result":{"data":{"markdownRemark":{"html":"<p>TFregulomeR is a new R package to provide quick TF peak and motif browser. It generated it's data from GTRD and MethMotif. Compared with troditional ENCODE project, this package has a larger database. But like GTRD, I think it contains many public data's ChIP-seq result, so I don't know how well it match ENCODE. Also, since ENCODE is constructed based on hg19/mm10, but TFregulomeR is based on hg38/mm10. It's worth to check if they match each other.</p>\n<h2>1. Compare TAF1 Peaks between ENCODE and TFregulomeR</h2>\n<p>So I randomly select a TF TAF1 on H1-ESC, which exist in both ENCODE and TFregulomeR. First I get TAF1's peak from TFregulomeR. <strong>Note that all TFregulomeR's peak are just one summit coordinates, which mean it is just one position. However ENCODE TFBS is a peak range, with mean value as 422.25. So I expended the TFregulomeR's peak from both sides of the summit to 250 bp.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>TFregulomeR<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>GenomicRanges<span class=\"token punctuation\">)</span>\n\nall_record <span class=\"token operator\">&lt;-</span> dataBrowser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nTAF1.index <span class=\"token operator\">&lt;-</span> which<span class=\"token punctuation\">(</span>all_record<span class=\"token operator\">$</span>species <span class=\"token operator\">==</span> <span class=\"token string\">\"human\"</span> <span class=\"token operator\">&amp;</span>\n                    all_record<span class=\"token operator\">$</span><span class=\"token string\">\"cell_tissue_name\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"H1-hESC\"</span> <span class=\"token operator\">&amp;</span>\n                    all_record<span class=\"token operator\">$</span><span class=\"token string\">\"TF\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"TAF1\"</span><span class=\"token punctuation\">)</span>\n\nRegulome <span class=\"token operator\">&lt;-</span> loadPeaks<span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> all_record<span class=\"token punctuation\">[</span>TAF1.index<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ID\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> includeMotifOnly <span class=\"token operator\">=</span> <span class=\"token boolean\">FALSE</span><span class=\"token punctuation\">)</span>\nRegulome.gr <span class=\"token operator\">&lt;-</span> makeGRangesFromDataFrame<span class=\"token punctuation\">(</span>Regulome<span class=\"token punctuation\">)</span>\nRegulome.gr <span class=\"token operator\">&lt;-</span> GenomicRanges<span class=\"token operator\">::</span>promoters<span class=\"token punctuation\">(</span>Regulome.gr<span class=\"token punctuation\">,</span> <span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token number\">250</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># Expend TFBS from the summit to upstream and downstream.</span></code></pre></div>\n<p>Then, I tried to get TAF1's ENCODE peaks. I downloaded it from <a href=\"http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeAwgTfbsUniform/\">this link</a>. The file I downloaded is \"wgEncodeAwgTfbsHaibH1hescTaf1V0416102UniPk.narrowPeak\". Then load it into R.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">ENCODE <span class=\"token operator\">&lt;-</span> read.csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"wgEncodeAwgTfbsHaibH1hescTaf1V0416102UniPk.narrowPeak\"</span><span class=\"token punctuation\">,</span> header<span class=\"token operator\">=</span>F<span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\ncolnames<span class=\"token punctuation\">(</span>ENCODE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;-</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"seqnames\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"end\"</span><span class=\"token punctuation\">)</span>\nENCODE.gr <span class=\"token operator\">&lt;-</span> makeGRangesFromDataFrame<span class=\"token punctuation\">(</span>ENCODE<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>There are 16855 peaks in Regulome. 20547 peaks in ENCODE, there are about 400 peaks in number difference. By checking each chromosome's result, the number is similar.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> table<span class=\"token punctuation\">(</span>Regulome<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n chr1 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19  chr2 chr20\n <span class=\"token number\">1732</span>   <span class=\"token number\">671</span>   <span class=\"token number\">909</span>   <span class=\"token number\">907</span>   <span class=\"token number\">336</span>   <span class=\"token number\">558</span>   <span class=\"token number\">547</span>   <span class=\"token number\">672</span>   <span class=\"token number\">947</span>   <span class=\"token number\">261</span>  <span class=\"token number\">1242</span>  <span class=\"token number\">1104</span>   <span class=\"token number\">442</span>\nchr21 chr22  chr3  chr4  chr5  chr6  chr7  chr8  chr9  chrX  chrY\n  <span class=\"token number\">141</span>   <span class=\"token number\">378</span>   <span class=\"token number\">942</span>   <span class=\"token number\">657</span>   <span class=\"token number\">791</span>   <span class=\"token number\">986</span>   <span class=\"token number\">818</span>   <span class=\"token number\">606</span>   <span class=\"token number\">682</span>   <span class=\"token number\">505</span>    <span class=\"token number\">21</span>\n<span class=\"token operator\">></span> table<span class=\"token punctuation\">(</span>ENCODE<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n chr1 chr10 chr11 chr12 chr13 chr14 chr15 chr16 chr17 chr18 chr19  chr2 chr20\n <span class=\"token number\">2146</span>   <span class=\"token number\">799</span>  <span class=\"token number\">1109</span>  <span class=\"token number\">1108</span>   <span class=\"token number\">414</span>   <span class=\"token number\">705</span>   <span class=\"token number\">656</span>   <span class=\"token number\">806</span>  <span class=\"token number\">1119</span>   <span class=\"token number\">339</span>  <span class=\"token number\">1497</span>  <span class=\"token number\">1372</span>   <span class=\"token number\">557</span>\nchr21 chr22  chr3  chr4  chr5  chr6  chr7  chr8  chr9  chrX  chrY\n  <span class=\"token number\">176</span>   <span class=\"token number\">461</span>  <span class=\"token number\">1187</span>   <span class=\"token number\">782</span>  <span class=\"token number\">1014</span>  <span class=\"token number\">1258</span>   <span class=\"token number\">993</span>   <span class=\"token number\">698</span>   <span class=\"token number\">792</span>   <span class=\"token number\">538</span>    <span class=\"token number\">21</span>\n<span class=\"token operator\">></span></code></pre></div>\n<h2>2. Mapping for hg38 and hg19</h2>\n<p>Top check the mapping difference between hg38 and hg19, I used latest release <a href=\"https://emea.support.illumina.com/array/array_kits/infinium-methylationepic-beadchip-kit/downloads.html\">Ilumina Human Methylation EPIC array's annotation</a>. <strong>This Annotation provided both hg19 and hg38 annotation for each CpG sites.</strong> So the solution is, use the hg19 version EPIC annotation to map the ENCODE version TFBS, and use hg38 version EPIC annotation to map the TFregulomeR version TFBS.</p>\n<p>Below is the code.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token comment\">## Read EPIC B5 manifest.</span>\nB5_Annotation <span class=\"token operator\">&lt;-</span> <span class=\"token string\">\"../../../../ChAMP_3.0/Manifests/infinium-methylationepic-v-1-0-b5-manifest-file.csv\"</span>\nskipline <span class=\"token operator\">&lt;-</span> which<span class=\"token punctuation\">(</span>substr<span class=\"token punctuation\">(</span>readLines<span class=\"token punctuation\">(</span>B5_Annotation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"[Assay]\"</span><span class=\"token punctuation\">)</span>\nManifest <span class=\"token operator\">&lt;-</span> read.csv<span class=\"token punctuation\">(</span>B5_Annotation<span class=\"token punctuation\">,</span> head<span class=\"token operator\">=</span>T<span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">,</span> skip<span class=\"token operator\">=</span>skipline<span class=\"token punctuation\">,</span> as.is<span class=\"token operator\">=</span>T<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## Prepare hg19 CpG annotation.</span>\nhg19EPIC <span class=\"token operator\">&lt;-</span> Manifest<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"CHR\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MAPINFO\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"MAPINFO\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\ncolnames<span class=\"token punctuation\">(</span>hg19EPIC<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;-</span>  c<span class=\"token punctuation\">(</span><span class=\"token string\">\"seqnames\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"end\"</span><span class=\"token punctuation\">)</span>\nhg19EPIC <span class=\"token operator\">&lt;-</span> hg19EPIC<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span>unique<span class=\"token punctuation\">(</span>which<span class=\"token punctuation\">(</span>is.na<span class=\"token punctuation\">(</span>hg19EPIC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> arr.ind<span class=\"token operator\">=</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span>\nhg19EPIC<span class=\"token operator\">$</span>seqnames <span class=\"token operator\">&lt;-</span> paste0<span class=\"token punctuation\">(</span><span class=\"token string\">\"chr\"</span><span class=\"token punctuation\">,</span> hg19EPIC<span class=\"token operator\">$</span>seqnames<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">## Prepare hg38 CpG annotation.</span>\nhg38EPIC <span class=\"token operator\">&lt;-</span> Manifest<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"CHR_hg38\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Start_hg38\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"End_hg38\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\ncolnames<span class=\"token punctuation\">(</span>hg38EPIC<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;-</span>  c<span class=\"token punctuation\">(</span><span class=\"token string\">\"seqnames\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"end\"</span><span class=\"token punctuation\">)</span>\nhg38EPIC<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"end\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;-</span> hg38EPIC<span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"start\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;-</span> hg38EPIC<span class=\"token operator\">$</span>start <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\nhg38EPIC <span class=\"token operator\">&lt;-</span> hg38EPIC<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span>unique<span class=\"token punctuation\">(</span>which<span class=\"token punctuation\">(</span>is.na<span class=\"token punctuation\">(</span>hg38EPIC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> arr.ind<span class=\"token operator\">=</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># Find overlap between hg19 with ENCODE</span>\novhg19 <span class=\"token operator\">&lt;-</span> data.frame<span class=\"token punctuation\">(</span>findOverlaps<span class=\"token punctuation\">(</span>ENCODE.gr<span class=\"token punctuation\">,</span> makeGRangesFromDataFrame<span class=\"token punctuation\">(</span>hg19EPIC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Find overlap between hg38 with TFregulome</span>\novhg38 <span class=\"token operator\">&lt;-</span> data.frame<span class=\"token punctuation\">(</span>findOverlaps<span class=\"token punctuation\">(</span>Regulome.gr<span class=\"token punctuation\">,</span> makeGRangesFromDataFrame<span class=\"token punctuation\">(</span>hg38EPIC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Finally I checked the mapping status, the total number is similar. In short, by mapping ENCODE's hg19 version TAF1 Peaks with hg19 version EPIC annotation, there are 0.08005176 CpGs are located in TAF1 Peaks range. By mapping TFregulomeR's hg38 version TAF1 Peaks with hg38 version EPIC annotation, there are 0.08544353 CpGs are located in TAF1 peaks.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> dim<span class=\"token punctuation\">(</span>ovhg19<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">77044</span>     <span class=\"token number\">2</span>\n<span class=\"token operator\">></span> dim<span class=\"token punctuation\">(</span>ovhg38<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">73370</span>     <span class=\"token number\">2</span>\n<span class=\"token operator\">></span></code></pre></div>\n<p>What if we mismatched genome version? <strong>So, don't mismatch genome version.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> ovMisMatch <span class=\"token operator\">&lt;-</span> data.frame<span class=\"token punctuation\">(</span>findOverlaps<span class=\"token punctuation\">(</span>ENCODE.gr<span class=\"token punctuation\">,</span> makeGRangesFromDataFrame<span class=\"token punctuation\">(</span>hg38EPIC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> dim<span class=\"token punctuation\">(</span>ovMisMatch<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">7252</span>    <span class=\"token number\">2</span>\n<span class=\"token operator\">></span> ovMisMatch <span class=\"token operator\">&lt;-</span> data.frame<span class=\"token punctuation\">(</span>findOverlaps<span class=\"token punctuation\">(</span>Regulome.gr<span class=\"token punctuation\">,</span> makeGRangesFromDataFrame<span class=\"token punctuation\">(</span>hg19EPIC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">></span> dim<span class=\"token punctuation\">(</span>ovMisMatch<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token number\">6968</span>    <span class=\"token number\">2</span>\n<span class=\"token operator\">></span></code></pre></div>","frontmatter":{"date":"January 17, 2021","slug":"/notes/Compare-Transcript-Factor-Peaks-between-ENCODE-and-TFregulomeR","title":"Compare Transcript Factor Peaks between ENCODE and TFregulomeR","abstract":"Previously I found a very good database TFregulomeR. However, before I move one, I want check the quality of TFregulomeR by comparing the peaks to ENCODE."}}},"pageContext":{"slug":"/notes/Compare-Transcript-Factor-Peaks-between-ENCODE-and-TFregulomeR"}}}