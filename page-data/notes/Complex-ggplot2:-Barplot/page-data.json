{
    "componentChunkName": "component---src-templates-note-template-js",
    "path": "/notes/Complex-ggplot2:-Barplot",
    "result": {"data":{"markdownRemark":{"html":"<p>Here are some nice figure I draw with ggplot2, I collect them here for future copy-paste.</p>\n<h2>Basic Barplot</h2>\n<p>Below is an example of quick and simply barplot, which:</p>\n<p>A good example for me to copy-paste in the future.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> df\n           V1           V2      V3 Genes\n<span class=\"token number\">1</span> <span class=\"token number\">0.038144115</span> <span class=\"token number\">0.0015615045</span> GM12878  IGF2\n<span class=\"token number\">2</span> <span class=\"token number\">0.063070041</span> <span class=\"token number\">0.0076605731</span> GM12878   H19\n<span class=\"token number\">3</span> <span class=\"token number\">1.032926070</span> <span class=\"token number\">0.0630352717</span>  IMR<span class=\"token operator\">-</span><span class=\"token number\">90</span>  IGF2\n<span class=\"token number\">4</span> <span class=\"token number\">0.003074519</span> <span class=\"token number\">0.0004062534</span>  IMR<span class=\"token operator\">-</span><span class=\"token number\">90</span>   H19\n<span class=\"token number\">5</span> <span class=\"token number\">1.215367031</span> <span class=\"token number\">0.0874954574</span>     HB2  IGF2\n<span class=\"token number\">6</span> <span class=\"token number\">2.305351688</span> <span class=\"token number\">0.1178677524</span>     HB2   H19\n<span class=\"token number\">7</span> <span class=\"token number\">0.538315946</span> <span class=\"token number\">0.0097037059</span> H1<span class=\"token operator\">-</span>hESC  IGF2\n<span class=\"token number\">8</span> <span class=\"token number\">0.350083002</span> <span class=\"token number\">0.1079638997</span> H1<span class=\"token operator\">-</span>hESC   H19\n<span class=\"token operator\">></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">\"ggplot2\"</span><span class=\"token punctuation\">)</span>\n\ndf <span class=\"token operator\">&lt;-</span> read.csv<span class=\"token punctuation\">(</span><span class=\"token string\">\"./data1.csv\"</span><span class=\"token punctuation\">,</span> head<span class=\"token operator\">=</span>F<span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token operator\">$</span>V1 <span class=\"token operator\">&lt;-</span> df<span class=\"token operator\">$</span>V1 <span class=\"token operator\">*</span> <span class=\"token number\">10000</span>\ndf<span class=\"token operator\">$</span>V2 <span class=\"token operator\">&lt;-</span> df<span class=\"token operator\">$</span>V2 <span class=\"token operator\">*</span> <span class=\"token number\">10000</span>\ndf<span class=\"token operator\">$</span>V3 <span class=\"token operator\">&lt;-</span> factor<span class=\"token punctuation\">(</span>df<span class=\"token operator\">$</span>V3 <span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"GM12878\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"IMR-90\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"HB2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"H1-hESC\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token operator\">$</span>V4 <span class=\"token operator\">&lt;-</span> factor<span class=\"token punctuation\">(</span>df<span class=\"token operator\">$</span>V4<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"IGF2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"H19\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ncolnames<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;-</span> <span class=\"token string\">\"Genes\"</span>\n\np <span class=\"token operator\">&lt;-</span> ggplot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>V3<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>V1<span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span>Genes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     geom_bar<span class=\"token punctuation\">(</span>stat<span class=\"token operator\">=</span><span class=\"token string\">\"identity\"</span><span class=\"token punctuation\">,</span> position<span class=\"token operator\">=</span>position_dodge<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     geom_errorbar<span class=\"token punctuation\">(</span>aes<span class=\"token punctuation\">(</span>ymin<span class=\"token operator\">=</span>V1<span class=\"token operator\">-</span>V2<span class=\"token punctuation\">,</span> ymax<span class=\"token operator\">=</span>V1<span class=\"token operator\">+</span>V2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">.2</span><span class=\"token punctuation\">,</span> position<span class=\"token operator\">=</span>position_dodge<span class=\"token punctuation\">(</span><span class=\"token number\">.9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     xlab<span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> ylab<span class=\"token punctuation\">(</span><span class=\"token string\">\"Relative Expression (x10^4)\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     theme<span class=\"token punctuation\">(</span>strip.text.x <span class=\"token operator\">=</span> element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     theme_bw<span class=\"token punctuation\">(</span>base_size<span class=\"token operator\">=</span><span class=\"token number\">22</span><span class=\"token punctuation\">)</span>\n\npdf<span class=\"token punctuation\">(</span><span class=\"token string\">\"BaiscBarplot.pdf\"</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> height<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\nprint<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span>\ndev.off<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f186f9545e864deed35f6b1769dbd78c/229ad/figure2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACIElEQVQoz2WTwW7TQBCGfeDAE/BEPAmqxKU5FCGEeioSCAmpEgdOVVUVKE3aooKA9gDNBdpDaC9FIHBEqqaJE8exk3jtrO214x/NxDYJrLRajXf28z//7mie58F1XSilEIYhoij6b9KekBKXts3rbC6t+UjTFJrv+wiCgD9MJpO5TZpxmnK8b3Rw/eAjPnRMjlWSTFelOK8A2rYNglKQJAlDZ2d+8PlVG9rhESrtDsdRHPMZUpn/nIFCCEgpCyBvECyDq0z1FgOr2DMyYJZLwNmh9fv9eeBM2QSMs/hFx2SFu4XC6Q/jJIFtmqjrOsbj8bRk8rAAUrJwIYw2H4iUgny2irX1NWifPmO3ZRQlsy1pirNaDdVqFd1uF9pgMPirkJIAuPs7sO8uQnkCYRwDS7ex+XAF2tEX7BldBgaZHYlSuBACluMgVmqqkIAsXykoAH7lJcalBUSuy0qwvITNJ4+hVY9Rqf8GjBYg5VTpvx5aljX3lmiMd7bgLd5ihXzL90rYePQA2vEpNt6+AUoLKB8eYL1lIAwCLnuS3zIZOXQcyJ6Jhmni62AI+3UZYvkOfMeBTw955T62n67i2skZXr1/x4pvbpdx4+QUnuvOvVtNBgHEaIQrXUft/By1xgW84RCXP76j2WyCOkn2LdR//YRu9TEcjWBdNPBN19Ho9fhhzwHzMkNqJ/KFPKOyg6DoIL4EsiXrCHqDs7l5p5CHfwDwN3uG2hMofwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"BasicBarplot\"\n        title=\"BasicBarplot\"\n        src=\"/static/f186f9545e864deed35f6b1769dbd78c/00d43/figure2.png\"\n        srcset=\"/static/f186f9545e864deed35f6b1769dbd78c/63868/figure2.png 250w,\n/static/f186f9545e864deed35f6b1769dbd78c/0b533/figure2.png 500w,\n/static/f186f9545e864deed35f6b1769dbd78c/00d43/figure2.png 1000w,\n/static/f186f9545e864deed35f6b1769dbd78c/229ad/figure2.png 1356w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Barplot with both Stack and Besides</h2>\n<p>In my project, I need to draw a barplot with both Stack and Besides bars. I never thought it's so hard but eventually I made it work. And also I added pattern on it.</p>\n<p>The input is a data frame <code class=\"language-text\">df</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\n     TranscriptType      Feature Count PhenoType\nNC.<span class=\"token number\">1</span>         coding         Exon    <span class=\"token number\">77</span>        NC\nNC.<span class=\"token number\">2</span>      nonCoding         Exon     <span class=\"token number\">0</span>        NC\nNC.<span class=\"token number\">3</span>           none         Exon     <span class=\"token number\">0</span>        NC\nNC.<span class=\"token number\">4</span>         pseudo         Exon     <span class=\"token number\">0</span>        NC\nNC.<span class=\"token number\">5</span>         coding Intergenetic     <span class=\"token number\">0</span>        NC\nNC.<span class=\"token number\">6</span>      nonCoding Intergenetic     <span class=\"token number\">0</span>        NC</code></pre></div>\n<p>Some key points in this figure:</p>\n<ul>\n<li>Draw patterns on stacks.</li>\n<li>Use <code class=\"language-text\">facet_grid</code> to join barplots.</li>\n<li>How to remove text border/strip after joined facet figure.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span><span class=\"token string\">\"ggplot2\"</span><span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span><span class=\"token string\">\"ggpattern\"</span><span class=\"token punctuation\">)</span>\n\nggplot<span class=\"token punctuation\">(</span>data<span class=\"token operator\">=</span>df<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span>PhenoType<span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span>Count<span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span>PhenoType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     geom_bar<span class=\"token punctuation\">(</span>stat<span class=\"token operator\">=</span><span class=\"token string\">\"identity\"</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     scale_fill_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"#f4bb4a\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#0892a5\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#30475e\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     <span class=\"token comment\"># Below three lines are for patterns.</span>\n     geom_bar_pattern<span class=\"token punctuation\">(</span>aes<span class=\"token punctuation\">(</span>pattern <span class=\"token operator\">=</span> TranscriptType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> stat <span class=\"token operator\">=</span> <span class=\"token string\">\"identity\"</span><span class=\"token punctuation\">,</span>\n                   pattern_color <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     scale_pattern_manual<span class=\"token punctuation\">(</span>values <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span>coding <span class=\"token operator\">=</span> <span class=\"token string\">\"stripe\"</span><span class=\"token punctuation\">,</span> nonCoding <span class=\"token operator\">=</span> <span class=\"token string\">\"circle\"</span><span class=\"token punctuation\">,</span> pseudo<span class=\"token operator\">=</span><span class=\"token string\">\"crosshatch\"</span><span class=\"token punctuation\">,</span> none<span class=\"token operator\">=</span><span class=\"token string\">\"none\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                          labels <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Protein Coding\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Non-Coding\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Pseudo\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"None\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     guides<span class=\"token punctuation\">(</span>pattern <span class=\"token operator\">=</span> guide_legend<span class=\"token punctuation\">(</span>override.aes <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"grey\"</span><span class=\"token punctuation\">,</span>\n                                                       pattern<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"stripe\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"circle\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"crosshatch\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"none\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                                       pattern_spacing<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token comment\"># The \"pattern_spacing\" is vital here, otherwise the legend is wrong.</span>\n     theme_bw<span class=\"token punctuation\">(</span>base_size<span class=\"token operator\">=</span><span class=\"token number\">22</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> xlab<span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> ylab<span class=\"token punctuation\">(</span><span class=\"token string\">\"Count of 5hmC Peaks\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     facet_grid<span class=\"token punctuation\">(</span><span class=\"token operator\">~</span>Feature<span class=\"token punctuation\">,</span> switch<span class=\"token operator\">=</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n     <span class=\"token comment\"># strip parameters in theme function is used to remove box for groups draw by facet.</span>\n     theme<span class=\"token punctuation\">(</span>axis.title.x<span class=\"token operator\">=</span>element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis.text.x<span class=\"token operator\">=</span>element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis.ticks.x<span class=\"token operator\">=</span>element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis.line.x.bottom<span class=\"token operator\">=</span>element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n           strip.text <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> colour<span class=\"token operator\">=</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> strip.background <span class=\"token operator\">=</span> element_rect<span class=\"token punctuation\">(</span>colour<span class=\"token operator\">=</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Below is the nice plot.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/20995544b708e15dc7df9f830de78342/8698d/figure1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.400000000000006%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB60lEQVQoz3WSS2/TUBBG8/cRYsEOduzYABEQFYEACagaNWnSAI7cJmloHk5i14/4+nX9POg6j5YFI9lzPXd09M03blSAu5kQbQakOdh6k1wKolhSliVpmiJlQlVVhGGIiiRJyLKsvlf5YTTCKEWYV0SL78gcvHGLXAZEcXIEKsABqLL6VnV1juMY27axLAvDMGj8mS3J/Dnh4kcNdEfv/w8Mgj0wJq1VgxACTftNt9tF13Uas8UKb60TLU9JlMLRQ4XFbuQ0o6rK2obdyJKsYFeLYubzOaZp7kY21haZWBDsFTrX7/Ye7hRKKRGehfLa24zJE5co9BGrPmUFMonxPQ/HccjzXClcszUG+KMmSQFm/xmF3JLItAZGocAdtchKMK8/Et3pCNfAvXhECaysBRe/Ovhbn6IsaESyJFxfkk5f1yoC7TnCXWHa23qEOBL441Z99kZvKT2NLPYQg6d1bWU7TJbG/ZbVK9ho3F6+5M3nDsv2E16dtPj0rV03bD0H+6rJdO0yPX/BQv9Cr3eO03/M2Lgjkztf1bLU01CqZGAz1M742u6zue3x4azN5OYGzzFxXRdrNaavjzHnQ4bDHr3BT2bTLienHYIguAfWCtXugVT91YcoiuM2VaMyv8zzf/riOKPKsyPskP8CoJ70QjUXEYEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Barplot with both stack and beside\"\n        title=\"Barplot with both stack and beside\"\n        src=\"/static/20995544b708e15dc7df9f830de78342/00d43/figure1.png\"\n        srcset=\"/static/20995544b708e15dc7df9f830de78342/63868/figure1.png 250w,\n/static/20995544b708e15dc7df9f830de78342/0b533/figure1.png 500w,\n/static/20995544b708e15dc7df9f830de78342/00d43/figure1.png 1000w,\n/static/20995544b708e15dc7df9f830de78342/8698d/figure1.png 1239w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Another Example</h3>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> PromoterCompare\n   count  group     method pheno\n<span class=\"token number\">1</span>   <span class=\"token number\">2245</span> Common bin<span class=\"token operator\">-</span>Enrich    NC\n<span class=\"token number\">2</span>   <span class=\"token number\">6764</span> Unique bin<span class=\"token operator\">-</span>Enrich    NC\n<span class=\"token number\">3</span>   <span class=\"token number\">2245</span> Common NarrowPeak    NC\n<span class=\"token number\">4</span>   <span class=\"token number\">1146</span> Unique NarrowPeak    NC\n<span class=\"token number\">5</span>     <span class=\"token number\">52</span> Common bin<span class=\"token operator\">-</span>Enrich    TC\n<span class=\"token number\">6</span>   <span class=\"token number\">1146</span> Unique bin<span class=\"token operator\">-</span>Enrich    TC\n<span class=\"token number\">7</span>     <span class=\"token number\">52</span> Common NarrowPeak    TC\n<span class=\"token number\">8</span>     <span class=\"token number\">56</span> Unique NarrowPeak    TC\n<span class=\"token number\">9</span>    <span class=\"token number\">243</span> Common bin<span class=\"token operator\">-</span>Enrich    LT\n<span class=\"token number\">10</span>  <span class=\"token number\">2859</span> Unique bin<span class=\"token operator\">-</span>Enrich    LT\n<span class=\"token number\">11</span>   <span class=\"token number\">243</span> Common NarrowPeak    LT\n<span class=\"token number\">12</span>   <span class=\"token number\">207</span> Unique NarrowPeak    LT\n<span class=\"token number\">13</span>  <span class=\"token number\">2842</span> Common bin<span class=\"token operator\">-</span>Enrich    NL\n<span class=\"token number\">14</span>  <span class=\"token number\">5287</span> Unique bin<span class=\"token operator\">-</span>Enrich    NL\n<span class=\"token number\">15</span>  <span class=\"token number\">2842</span> Common NarrowPeak    NL\n<span class=\"token number\">16</span>  <span class=\"token number\">1382</span> Unique NarrowPeak    NL\n<span class=\"token operator\">></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>ggplot2<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>ggpattern<span class=\"token punctuation\">)</span>\nlibrary<span class=\"token punctuation\">(</span>ggpubr<span class=\"token punctuation\">)</span>\n\nmyCol <span class=\"token operator\">&lt;-</span> c<span class=\"token punctuation\">(</span>NC<span class=\"token operator\">=</span><span class=\"token string\">\"#f4bb4a\"</span><span class=\"token punctuation\">,</span> TC<span class=\"token operator\">=</span><span class=\"token string\">\"#0892a5\"</span><span class=\"token punctuation\">,</span> LT<span class=\"token operator\">=</span><span class=\"token string\">\"#30475e\"</span><span class=\"token punctuation\">,</span> NL<span class=\"token operator\">=</span><span class=\"token string\">\"#e84855\"</span><span class=\"token punctuation\">)</span>\n\nPromoterCompare<span class=\"token operator\">$</span>group <span class=\"token operator\">&lt;-</span> factor<span class=\"token punctuation\">(</span>PromoterCompare<span class=\"token operator\">$</span>group<span class=\"token punctuation\">,</span> levels <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Unique\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Common\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nPromoterCompare<span class=\"token operator\">$</span>pheno <span class=\"token operator\">&lt;-</span> factor<span class=\"token punctuation\">(</span>PromoterCompare<span class=\"token operator\">$</span>pheno<span class=\"token punctuation\">,</span> levels <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"NC\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"TC\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"LT\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"NL\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\nggplot<span class=\"token punctuation\">(</span>PromoterCompare<span class=\"token punctuation\">,</span> aes<span class=\"token punctuation\">(</span>x <span class=\"token operator\">=</span> method<span class=\"token punctuation\">,</span> y <span class=\"token operator\">=</span> count<span class=\"token punctuation\">,</span> fill <span class=\"token operator\">=</span> pheno<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n  geom_bar<span class=\"token punctuation\">(</span>stat <span class=\"token operator\">=</span> <span class=\"token string\">'identity'</span><span class=\"token punctuation\">,</span> position <span class=\"token operator\">=</span> <span class=\"token string\">'stack'</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n  scale_fill_manual<span class=\"token punctuation\">(</span>values<span class=\"token operator\">=</span>myCol<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n   geom_bar_pattern<span class=\"token punctuation\">(</span>aes<span class=\"token punctuation\">(</span>pattern <span class=\"token operator\">=</span> group<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> stat <span class=\"token operator\">=</span> <span class=\"token string\">\"identity\"</span><span class=\"token punctuation\">,</span>\n                   pattern_color <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n  scale_pattern_manual<span class=\"token punctuation\">(</span>values <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span>Common <span class=\"token operator\">=</span> <span class=\"token string\">\"stripe\"</span><span class=\"token punctuation\">,</span> Unique <span class=\"token operator\">=</span> <span class=\"token string\">\"none\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> labels <span class=\"token operator\">=</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"Common\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Unique\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n  guides<span class=\"token punctuation\">(</span>pattern <span class=\"token operator\">=</span> guide_legend<span class=\"token punctuation\">(</span>override.aes <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span>fill <span class=\"token operator\">=</span> <span class=\"token string\">\"grey\"</span><span class=\"token punctuation\">,</span>\n                                                       pattern<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"stripe\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"none\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                                       pattern_spacing<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token comment\"># The \"pattern_spacing\" is vital here, otherwise the legend is wrong.</span>\n  facet_grid<span class=\"token punctuation\">(</span><span class=\"token operator\">~</span> pheno<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n  ylab<span class=\"token punctuation\">(</span><span class=\"token string\">\"Number of 5hmC enriched Promoters\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> xlab<span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n  theme_bw<span class=\"token punctuation\">(</span>base_size<span class=\"token operator\">=</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n  theme<span class=\"token punctuation\">(</span>axis.text.x <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>angle <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">,</span> vjust <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> hjust<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  theme<span class=\"token punctuation\">(</span>axis.title.x<span class=\"token operator\">=</span>element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis.text.x<span class=\"token operator\">=</span>element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis.ticks.x<span class=\"token operator\">=</span>element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis.line.x.bottom<span class=\"token operator\">=</span>element_blank<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        strip.text <span class=\"token operator\">=</span> element_text<span class=\"token punctuation\">(</span>size<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> colour<span class=\"token operator\">=</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> strip.background <span class=\"token operator\">=</span> element_rect<span class=\"token punctuation\">(</span>colour<span class=\"token operator\">=</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 652px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a3a10e4e8bb3e75ffeef129d3f9bbdd3/dba9a/figure3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.2%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADoUlEQVQ4y4WUy28bRRzHfeBf4saFKwcIEj0g0UOlXoDCqVIlXhIQiihcWgWEeRRCRHNoBAihRAEB4dnYxSRxaseOXTt+7q7Xr/U+Zne99gfN+BG3UDGS5e+MfvPZ+T1j4/EYuRzH4SCdYXc3QalUIpvNkkgkKBQKFItFkskkx8fHSsvzvb09PM9Td2cMuWIzYdsDKsVDGvUqmqajaU10XafZbKJpmtJq32hg6Dr1eh3f9/8NtKy+Eq6lo2+eIewe4YcwDAN1Li/NLkZRhCOE0qMoYjgczoEzaCyTuYPt+vTNCp2tx/FaBzgiQnjuPBSu6zIejZDYxo1v6F9bRTo7DAIWl4TGioUC7U6fVqNAe+tJRCuNK0ZzoITJH1Ng860V7PMv48gXB4H6YLfbPX1h6e5dJTxLo725hDAPcf0RvvDmQBX88XgCfPcj7BffRH5u6AdUq1Xy+Tz9fp8gCIgd5/OM7wGmFVAsACcvnAKvxLEvvK6A8oWyIiqVCplMBtM0ieVyR3R6Fm2tRGdraeLy/wFfeEPFUAI910UIQa/XU0mLlUsl+gOXjl6irYD7uDIpC0DbcRhH0dTlONazr9EJhHJ54Pp0u73TGJbLpWkMddqbTyC6BbwQfHGaZZkQuWTBGCurtB89S/m5VxGGiVm9Qy5ziONM7JXL0Ri8foPW1lMYPz2PnttGhKoQCHyfVDpL6aROBNSufUbt4SWKj53Daxps53Y4KmQJ/HACrFYrmJ0eei3HybdP09x4hOZfcewAhtGkcM9ceIWX3osrXdv8Ee3yCqWrn+B3e6xtfE86k2M8iibAYrGA8AMcy6SW+BAjeRW98CucdhPnLr3N8vtfKK3/tov1+U2aX36FsAbYt1K0TioMp2GJyXQPoxG+26eVXmeQXaNTvsX1/RyZlqmMnrm4zDvxG0prO3/S+3idxupNRK+/0CbTTimXyyrm7qBNM3WdXjpO+3iHh+IbXEnuK9uzF5c5f+kyqWwe/eff6X6wRv3T9TlQtuU8y5MehLZp0Cjexigl0as5VhN7fJe4TUGOq78P+HrzB7Z/+QPtKI+xm6KWSCGmmb1n2sw28n9ge6om/SBkLAS+6+B5gmEYEga+Crzn+9hC0JflNJs03DcP5aFs8Ea9Tts0sSyLeqOBpuvYtk1T09TeGgxoGQb1Wg2xOFzvH7BhGKo+lA0+Go0UXO6lsTxrtVqTWeg4GIahWm3R1Qe6/F/6/gujaXk8yPYf5rzIyLymqhEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Barplot with both stack and beside - Example 2\"\n        title=\"Barplot with both stack and beside - Example 2\"\n        src=\"/static/a3a10e4e8bb3e75ffeef129d3f9bbdd3/dba9a/figure3.png\"\n        srcset=\"/static/a3a10e4e8bb3e75ffeef129d3f9bbdd3/63868/figure3.png 250w,\n/static/a3a10e4e8bb3e75ffeef129d3f9bbdd3/0b533/figure3.png 500w,\n/static/a3a10e4e8bb3e75ffeef129d3f9bbdd3/dba9a/figure3.png 652w\"\n        sizes=\"(max-width: 652px) 100vw, 652px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>","frontmatter":{"date":"April 07, 2022","slug":"/notes/Complex-ggplot2:-Barplot","title":"Complex ggplot2: Barplot","tags":["visualisation","ggplot2"],"abstract":"ggplot2 is nice, but can be quite complex...Here are some nice ggplot2 barplots I have drawn."}}},"pageContext":{"slug":"/notes/Complex-ggplot2:-Barplot"}},
    "staticQueryHashes": ["63159454"]}