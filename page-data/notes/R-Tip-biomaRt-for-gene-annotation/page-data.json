{"componentChunkName":"component---src-templates-note-template-js","path":"/notes/R-Tip-biomaRt-for-gene-annotation","result":{"data":{"markdownRemark":{"html":"<p><strong>I realy don't know, why we have so many various gene name?</strong> Below is an example...</p>\n<p>symbol name:  <code class=\"language-text\">TP53</code>;\nensembl_gene_id: <code class=\"language-text\">ENSG00000141510</code>;\nentrezgene_id: <code class=\"language-text\">7157</code>;</p>\n<p>I am just so tried of mapping between these names again and again. I found <a href=\"https://www.bioconductor.org/packages/devel/bioc/vignettes/biomaRt/inst/doc/biomaRt.html\">biomaRt</a> a really good tool for annotation. Below is a code snippets I used to find human gene annotation, merely I need the start, end, chromosome_name for each gene, to overlap with discovered methylation signals.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\">library<span class=\"token punctuation\">(</span>biomaRt<span class=\"token punctuation\">)</span>\nmart <span class=\"token operator\">&lt;-</span> useMart<span class=\"token punctuation\">(</span><span class=\"token string\">\"ensembl\"</span><span class=\"token punctuation\">,</span> dataset <span class=\"token operator\">=</span> <span class=\"token string\">\"hsapiens_gene_ensembl\"</span><span class=\"token punctuation\">)</span>\ngenes <span class=\"token operator\">&lt;-</span> getBM<span class=\"token punctuation\">(</span>\n  attributes<span class=\"token operator\">=</span>c<span class=\"token punctuation\">(</span><span class=\"token string\">\"chromosome_name\"</span><span class=\"token punctuation\">,</span>\n               <span class=\"token string\">\"start_position\"</span><span class=\"token punctuation\">,</span>\n               <span class=\"token string\">\"end_position\"</span><span class=\"token punctuation\">,</span> \n               <span class=\"token string\">\"ensembl_gene_id\"</span><span class=\"token punctuation\">,</span>\n               <span class=\"token string\">\"entrezgene_id\"</span><span class=\"token punctuation\">,</span> \n               <span class=\"token string\">\"external_gene_name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  mart <span class=\"token operator\">=</span> mart<span class=\"token punctuation\">)</span>\ncolnames<span class=\"token punctuation\">(</span>genes<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;-</span> c<span class=\"token punctuation\">(</span><span class=\"token string\">\"chr\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"end\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ensembl_gene_id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"entrezgene_id\"</span><span class=\"token punctuation\">,</span>  <span class=\"token string\">\"SYMBOL\"</span><span class=\"token punctuation\">)</span>\ngenes<span class=\"token operator\">$</span>chr <span class=\"token operator\">&lt;-</span> paste0<span class=\"token punctuation\">(</span><span class=\"token string\">\"chr\"</span><span class=\"token punctuation\">,</span> genes<span class=\"token operator\">$</span>chr<span class=\"token punctuation\">)</span></code></pre></div>\n<p>The result is exactly what I want:</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>genes<span class=\"token punctuation\">)</span>\n       chr start  end ensembl_gene_id entrezgene_id  SYMBOL\n<span class=\"token number\">1</span> chrchrMT   <span class=\"token number\">577</span>  <span class=\"token number\">647</span> ENSG00000210049            <span class=\"token keyword\">NA</span>   MT<span class=\"token operator\">-</span>TF\n<span class=\"token number\">2</span> chrchrMT   <span class=\"token number\">648</span> <span class=\"token number\">1601</span> ENSG00000211459            <span class=\"token keyword\">NA</span> MT<span class=\"token operator\">-</span>RNR1\n<span class=\"token number\">3</span> chrchrMT  <span class=\"token number\">1602</span> <span class=\"token number\">1670</span> ENSG00000210077            <span class=\"token keyword\">NA</span>   MT<span class=\"token operator\">-</span>TV\n<span class=\"token number\">4</span> chrchrMT  <span class=\"token number\">1671</span> <span class=\"token number\">3229</span> ENSG00000210082            <span class=\"token keyword\">NA</span> MT<span class=\"token operator\">-</span>RNR2\n<span class=\"token number\">5</span> chrchrMT  <span class=\"token number\">3230</span> <span class=\"token number\">3304</span> ENSG00000209082            <span class=\"token keyword\">NA</span>  MT<span class=\"token operator\">-</span>TL1\n<span class=\"token number\">6</span> chrchrMT  <span class=\"token number\">3307</span> <span class=\"token number\">4262</span> ENSG00000198888          <span class=\"token number\">4535</span>  MT<span class=\"token operator\">-</span>ND1</code></pre></div>\n<p>I don't know why in above figure, <strong>Na value exact in entrezgene_id column</strong>...they are not mathced with each other? I need to find out one day...</p>\n<p>More importantly, by using biomaRt, I can extra more columns. The all possible <code class=\"language-text\">attribute</code> (means columns above)</p>\n<p>Below is an example. If I want extra column I can search below list.</p>\n<div class=\"gatsby-highlight\" data-language=\"r\"><pre class=\"language-r\"><code class=\"language-r\"><span class=\"token operator\">></span> head<span class=\"token punctuation\">(</span>listAttributes<span class=\"token punctuation\">(</span>mart<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                           name                  description         page\n<span class=\"token number\">1</span>               ensembl_gene_id               Gene stable ID feature_page\n<span class=\"token number\">2</span>       ensembl_gene_id_version       Gene stable ID version feature_page\n<span class=\"token number\">3</span>         ensembl_transcript_id         Transcript stable ID feature_page\n<span class=\"token number\">4</span> ensembl_transcript_id_version Transcript stable ID version feature_page\n<span class=\"token number\">5</span>            ensembl_peptide_id            Protein stable ID feature_page\n<span class=\"token number\">6</span>    ensembl_peptide_id_version    Protein stable ID version feature_page</code></pre></div>\n<p>Note that if a column like transcript_id is selected, gene names would be duplicated for splicing transcripts. It's a good design.</p>","frontmatter":{"date":"July 15, 2020","slug":"/notes/R-Tip-biomaRt-for-gene-annotation","title":"R package biomaRt for gene annotation","abstract":"I just simply want to find a annotation (for a easy species - human) with various gene name matched. This task wasted me about 1 hour, and I tried various way, some even very outdated. Eventually I think biomaRt work, so I record here a bit."}}},"pageContext":{"slug":"/notes/R-Tip-biomaRt-for-gene-annotation"}}}